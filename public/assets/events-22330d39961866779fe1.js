webpackJsonp([25],{30:function(e,t,n){try{(function(){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t,n){for(var r=!0;r;){var a=e,o=t,i=n;r=!1,null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,o);if(void 0!==l){if("value"in l)return l.value;var s=l.get;if(void 0===s)return;return s.call(i)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,n=i,r=!0,l=u=void 0}},s=n(1),u=r(s),c=n(15),d=function(e){function t(e){a(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={visible:!1},this.timer=null,this.scrollToTop=this.scrollToTop.bind(this)}return o(t,e),i(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.visibilityHeight,n=void 0===t?400:t,r=c(".doc-container");r.unbind("scroll").scroll(function(){var t=r.scrollTop();e.setState({visible:t>n})})}},{key:"componentWillUnmount",value:function(){c(".doc-container").unbind("scroll")}},{key:"scrollToTop",value:function(){var e=this,t=c(".doc-container"),n=50*(parseInt(t.scrollTop()/1e3)+1);cancelAnimationFrame(this.timer),this.timer=requestAnimationFrame(function r(){var a=t.scrollTop();a>0?(t.scrollTop(a-n>0?a-n:0),e.timer=requestAnimationFrame(r)):cancelAnimationFrame(e.timer)})}},{key:"render",value:function(){var e=this.state.visible,t=void 0!==e&&e;return u.default.createElement("div",{id:"backtop",className:"back-top",style:{visibility:t&&"visible"||"hidden"},onClick:this.scrollToTop},u.default.createElement("div",{className:"back-top-content"},u.default.createElement("div",{className:"back-top-icon"})))}}],[{key:"propTypes",value:{visibilityHeight:s.PropTypes.number},enumerable:!0}]),t}(s.Component);t.default=d,e.exports=t.default}).call(this)}finally{}},41:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0}),t.CheckboxGroup=t.Checkbox=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(1),l=r(i);t.Checkbox=l.default.createClass({displayName:"Checkbox",contextTypes:{checkboxGroup:l.default.PropTypes.object.isRequired},componentWillMount:function(){if(!this.context||!this.context.checkboxGroup)throw new Error("The `Checkbox` component must be used as a child of `CheckboxGroup`.")},render:function(){var e=this.context.checkboxGroup,t=e.name,n=e.checkedValues,r=e.onChange,a={};return n&&(a.checked=n.indexOf(this.props.value)>=0),"function"==typeof r&&(a.onChange=r.bind(null,this.props.value)),l.default.createElement("input",o({},this.props,{type:"checkbox",name:t},a))}}),t.CheckboxGroup=l.default.createClass({displayName:"CheckboxGroup",propTypes:{name:i.PropTypes.string,defaultValue:i.PropTypes.array,value:i.PropTypes.array,onChange:i.PropTypes.func,children:i.PropTypes.node.isRequired,Component:i.PropTypes.oneOfType([i.PropTypes.string,i.PropTypes.func,i.PropTypes.object])},getDefaultProps:function(){return{Component:"div"}},childContextTypes:{checkboxGroup:l.default.PropTypes.object},getChildContext:function(){return{checkboxGroup:{name:this.props.name,checkedValues:this.state.value,onChange:this._onCheckboxChange}}},getInitialState:function(){return{value:this.props.value||this.props.defaultValue||[]}},componentWillReceiveProps:function(e){e.value&&this.setState({value:e.value})},render:function(){var e=this.props,t=e.Component,n=(e.name,e.value,e.onChange,e.children),r=a(e,["Component","name","value","onChange","children"]);return l.default.createElement(t,r,n)},getValue:function(){return this.state.value},_isControlledComponent:function(){return!!this.props.value},_onCheckboxChange:function(e,t){var n;n=t.target.checked?this.state.value.concat(e):this.state.value.filter(function(t){return t!==e}),this._isControlledComponent()?this.setState({value:this.props.value}):this.setState({value:n}),"function"==typeof this.props.onChange&&this.props.onChange(n)}})},1827:function(e,t,n){try{(function(){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t,n){for(var r=!0;r;){var a=e,o=t,i=n;r=!1,null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,o);if(void 0!==l){if("value"in l)return l.value;var s=l.get;if(void 0===s)return;return s.call(i)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,n=i,r=!0,l=u=void 0}},s=n(1),u=r(s),c=n(2),d=n(41),f=n(3),p=r(f),h=n(5),m=n(4),y=function(e){function t(e){var n=this;a(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={ecode:0,notifications:[],userParam:"",roleParam:"",singleUserFieldParam:"",multiUserFieldParam:""};var r=e.data.notifications,o=void 0===r?[]:r;p.default.map(o,function(e){"role"==e.key&&e.value?(n.state.notifications.push("role"),n.state.roleParam=e.value):"user"==e.key&&e.value&&e.value.id?(n.state.notifications.push("user"),n.state.userParam=e.value.id):"single_user_field"==e.key&&e.value?(n.state.notifications.push("single_user_field"),n.state.singleUserFieldParam=e.value):"multi_user_field"==e.key&&e.value?(n.state.notifications.push("multi_user_field"),n.state.multiUserFieldParam=e.value):n.state.notifications.push(e)}),this.state.oldNotifications=p.default.clone(this.state.notifications),this.state.oldUserParam=this.state.userParam,this.state.oldRoleParam=this.state.roleParam,this.state.oldSingleUserFieldParam=this.state.singleUserFieldParam,this.state.oldMultiUserFieldParam=this.state.multiUserFieldParam,this.confirm=this.confirm.bind(this),this.cancel=this.cancel.bind(this)}return o(t,e),i(t,[{key:"confirm",value:function(){var e,t,n,r,a,o,i;return regeneratorRuntime.async(function(l){for(var s=this;;)switch(l.prev=l.next){case 0:return e=this.props,t=e.close,n=e.setNotify,r=e.data,a=e.options,o=[],p.default.map(this.state.notifications,function(e){if("user"==e){if(s.state.userParam){var t=p.default.find(a.users,{id:s.state.userParam});o.push({key:e,value:t})}}else"role"==e?s.state.roleParam&&o.push({key:e,value:s.state.roleParam}):"single_user_field"==e?s.state.singleUserFieldParam&&o.push({key:e,value:s.state.singleUserFieldParam}):"multi_user_field"==e?s.state.multiUserFieldParam&&o.push({key:e,value:s.state.multiUserFieldParam}):o.push(e)}),l.next=9,regeneratorRuntime.awrap(n({id:r.id,notifications:o}));case 9:i=l.sent,0===i?(t(),h.notify.show("配置完成。","success",2e3)):this.setState({ecode:i});case 11:case"end":return l.stop()}},null,this)}},{key:"cancel",value:function(){var e=this.props.close;e()}},{key:"notificationsChanged",value:function(e){this.setState({notifications:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.i18n.errMsg,r=t.data,a=t.options,o=t.loading,i=a.roles||[],l=(a.users||[]).sort(function(e,t){return e.name.localeCompare(t.name)}),s=a.single_user_fields||[],f=a.multi_user_fields||[],h={width:"125px",height:"25px",verticalAlign:"middle",marginLeft:"10px",backgroundColor:"#ffffff",borderRadius:"4px"},y={width:"125px",height:"25px",verticalAlign:"middle",marginLeft:"10px",backgroundColor:"#f5f5f5",borderRadius:"4px"},v=!1;if(this.state.userParam!==this.state.oldUserParam||this.state.roleParam!==this.state.oldRoleParam||this.state.singleUserFieldParam!==this.state.oldSingleUserFieldParam||this.state.oldMultiUserFieldParam!==this.state.multiUserFieldParam)v=!0;else{var b=p.default.intersection(this.state.notifications,this.state.oldNotifications);b.length===this.state.notifications.length&&b.length===this.state.oldNotifications.length||(v=!0)}return u.default.createElement(c.Modal,{show:!0,onHide:this.cancel,backdrop:"static","aria-labelledby":"contained-modal-title-sm"},u.default.createElement(c.Modal.Header,{closeButton:!0},u.default.createElement(c.Modal.Title,{id:"contained-modal-title-la"},"通知设置 - ",r.name)),u.default.createElement(c.Modal.Body,{style:{maxHeight:"420px",overflow:"auto"}},u.default.createElement("div",null,u.default.createElement(d.CheckboxGroup,{name:"notifications",value:this.state.notifications,onChange:this.notificationsChanged.bind(this)},u.default.createElement("ui",{className:"list-unstyled clearfix cond-list"},u.default.createElement("li",{style:{height:"40px",marginTop:"5px"}},"请选择以下通知对象："),u.default.createElement("li",{style:{height:"40px"}},u.default.createElement("div",{style:{width:"50%",display:"inline-block"}},u.default.createElement("label",{style:{fontWeight:400}},u.default.createElement(d.Checkbox,{disabled:o,value:"current_user"}),u.default.createElement("span",null,"当前用户"))),u.default.createElement("div",{style:{width:"50%",display:"inline-block"}},u.default.createElement("label",{style:{fontWeight:400}},u.default.createElement(d.Checkbox,{disabled:o,value:"assignee"}),u.default.createElement("span",null,"当前负责人")))),u.default.createElement("li",{style:{height:"40px"}},u.default.createElement("div",{style:{width:"50%",display:"inline-block"}},u.default.createElement("label",{style:{fontWeight:400}},u.default.createElement(d.Checkbox,{disabled:o,value:"reporter"}),u.default.createElement("span",null,"报告者"))),u.default.createElement("div",{style:{width:"50%",display:"inline-block"}},u.default.createElement("label",{style:{fontWeight:400}},u.default.createElement(d.Checkbox,{disabled:o,value:"watchers"}),u.default.createElement("span",null,"所有关注者")))),u.default.createElement("li",{style:{height:"40px"}},u.default.createElement("div",{style:{width:"50%",display:"inline-block"}},u.default.createElement("label",{style:{fontWeight:400}},u.default.createElement(d.Checkbox,{disabled:o,value:"project_principal"}),u.default.createElement("span",null,"项目负责人"))),u.default.createElement("div",{style:{width:"50%",display:"inline-block"}},u.default.createElement("label",{style:{fontWeight:400}},u.default.createElement(d.Checkbox,{disabled:o,value:"module_principal"}),u.default.createElement("span",null,"模块负责人")))),u.default.createElement("li",{style:{height:"40px"}},u.default.createElement("div",{style:{width:"50%",display:"inline-block"}},u.default.createElement("label",{style:{fontWeight:400}},u.default.createElement(d.Checkbox,{disabled:o,value:"user"}),u.default.createElement("span",null,"单一用户")),u.default.createElement("select",{value:this.state.userParam,onChange:function(t){return e.setState({userParam:t.target.value})},disabled:!(p.default.indexOf(this.state.notifications,"user")!==-1&&!o),style:p.default.indexOf(this.state.notifications,"user")!==-1?h:y},u.default.createElement("option",{value:"",key:""},"选择用户"),l.map(function(e){return u.default.createElement("option",{value:e.id,key:e.id},e.name+"("+e.email+")")}))),u.default.createElement("div",{style:{width:"50%",display:"inline-block"}},u.default.createElement("label",{style:{fontWeight:400}},u.default.createElement(d.Checkbox,{disabled:o,value:"role"}),u.default.createElement("span",null,"项目角色")),u.default.createElement("select",{value:this.state.roleParam,onChange:function(t){return e.setState({roleParam:t.target.value})},disabled:!(p.default.indexOf(this.state.notifications,"role")!==-1&&!o),style:p.default.indexOf(this.state.notifications,"role")!==-1?h:y},u.default.createElement("option",{value:"",key:""},"选择角色"),i.map(function(e){return u.default.createElement("option",{value:e.id,key:e.id},e.name)})))),u.default.createElement("li",{style:{height:"40px"}},u.default.createElement("div",{style:{width:"50%",display:"inline-block"}},u.default.createElement("label",{style:{fontWeight:400}},u.default.createElement(d.Checkbox,{disabled:o,value:"single_user_field"}),u.default.createElement("span",null,"单一用户字段")),u.default.createElement("select",{value:this.state.singleUserFieldParam,onChange:function(t){return e.setState({singleUserFieldParam:t.target.value})},disabled:!(p.default.indexOf(this.state.notifications,"single_user_field")!==-1&&!o),style:p.default.indexOf(this.state.notifications,"single_user_field")!==-1?h:y},u.default.createElement("option",{value:"",key:""},"选择用户字段"),s.map(function(e){return u.default.createElement("option",{value:e.id,key:e.id},e.name)}))),u.default.createElement("div",{style:{width:"50%",display:"inline-block"}},u.default.createElement("label",{style:{fontWeight:400}},u.default.createElement(d.Checkbox,{disabled:o,value:"multi_user_field"}),u.default.createElement("span",null,"多用户字段")),u.default.createElement("select",{value:this.state.multiUserFieldParam,onChange:function(t){return e.setState({multiUserFieldParam:t.target.value})},disabled:!(p.default.indexOf(this.state.notifications,"multi_user_field")!==-1&&!o),style:p.default.indexOf(this.state.notifications,"multi_user_field")!==-1?h:y},u.default.createElement("option",{value:"",key:""},"选择用户字段"),f.map(function(e){return u.default.createElement("option",{value:e.id,key:e.id},e.name)})))))))),u.default.createElement(c.Modal.Footer,null,u.default.createElement("span",{className:"ralign"},0!==this.state.ecode&&!o&&n[this.state.ecode]),u.default.createElement("img",{src:m,className:o?"loading":"hide"}),u.default.createElement(c.Button,{onClick:this.confirm,disabled:!v||o},"确定"),u.default.createElement(c.Button,{bsStyle:"link",onClick:this.cancel},"取消")))}}],[{key:"propTypes",value:{i18n:s.PropTypes.object.isRequired,close:s.PropTypes.func.isRequired,setNotify:s.PropTypes.func.isRequired,options:s.PropTypes.object.isRequired,loading:s.PropTypes.bool.isRequired,data:s.PropTypes.object.isRequired},enumerable:!0}]),t}(s.Component);t.default=y,e.exports=t.default}).call(this)}finally{}},1828:function(e,t,n){try{(function(){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e){return{actions:(0,h.bindActionCreators)(y,e)}}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function(e,t,n){for(var r=!0;r;){var a=e,o=t,i=n;r=!1,null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,o);if(void 0!==l){if("value"in l)return l.value;var s=l.get;if(void 0===s)return;return s.call(i)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,n=i,r=!0,l=u=void 0}},d=n(1),f=a(d),p=n(22),h=n(23),m=n(2074),y=r(m),v=n(1832),b=n(1833),g=function(e){function t(e){o(this,n),c(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,e),this.pid=""}i(t,e),u(t,[{key:"index",value:function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this.props.actions.index(this.pid));case 2:return e.abrupt("return",this.props.events.ecode);case 3:case"end":return e.stop()}},null,this)}},{key:"create",value:function(e){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.props.actions.create(this.pid,e));case 2:return t.abrupt("return",this.props.events.ecode);case 3:case"end":return t.stop()}},null,this)}},{key:"update",value:function(e){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.props.actions.update(this.pid,e));case 2:return t.abrupt("return",this.props.events.ecode);case 3:case"end":return t.stop()}},null,this)}},{key:"setNotify",value:function(e){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.props.actions.setNotify(this.pid,e));case 2:return t.abrupt("return",this.props.events.ecode);case 3:case"end":return t.stop()}},null,this)}},{key:"del",value:function(e){var t;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return t=this.props.actions,n.next=3,regeneratorRuntime.awrap(t.del(this.pid,e));case 3:return n.abrupt("return",this.props.events.ecode);case 4:case"end":return n.stop()}},null,this)}},{key:"reset",value:function(e){var t;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return t=this.props.actions,n.next=3,regeneratorRuntime.awrap(t.reset(this.pid,e));case 3:return n.abrupt("return",this.props.events.ecode);case 4:case"end":return n.stop()}},null,this)}},{key:"componentWillMount",value:function(){var e=this.props.location.pathname,t=void 0===e?"":e;if(/^\/admin\/scheme/.test(t))this.pid="$_sys_$";else{var n=this.props.params.key;this.pid=n}}},{key:"render",value:function(){this.props.location.pathname;return f.default.createElement("div",null,f.default.createElement(v,s({create:this.create.bind(this),i18n:this.props.i18n},this.props.events)),f.default.createElement(b,s({pkey:this.pid,index:this.index.bind(this),select:this.props.actions.select,update:this.update.bind(this),setNotify:this.setNotify.bind(this),del:this.del.bind(this),reset:this.reset.bind(this),i18n:this.props.i18n},this.props.events)))}}],[{key:"propTypes",value:{actions:d.PropTypes.object.isRequired,location:d.PropTypes.object.isRequired,params:d.PropTypes.object.isRequired,i18n:d.PropTypes.object.isRequired,events:d.PropTypes.object.isRequired},enumerable:!0}]);var n=t;return t=(0,p.connect)(function(e){var t=e.i18n,n=e.events;return{i18n:t,events:n}},l)(t)||t}(d.Component);t.default=g,e.exports=t.default}).call(this)}finally{}},1829:function(e,t,n){try{(function(){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var a=e,o=t,i=n;r=!1,null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,o);if(void 0!==l){if("value"in l)return l.value;var s=l.get;if(void 0===s)return;return s.call(i)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,n=i,r=!0,l=u=void 0}},u=n(1),c=r(u),d=n(8),f=n(2),p=n(3),h=r(p),m=n(5),y=n(4),v=function(e,t){var n={};return e.name?h.default.findIndex(t.collection||[],{name:e.name})!==-1&&(n.name="该名称已存在"):n.name="必填",n},b=function(e){function t(e){a(this,n),s(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,e),this.state={ecode:0},this.handleSubmit=this.handleSubmit.bind(this),this.handleCancel=this.handleCancel.bind(this)}o(t,e),l(t,[{key:"handleSubmit",value:function(){var e,t,n,r,a;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props,t=e.values,n=e.create,r=e.close,o.next=6,regeneratorRuntime.awrap(n(t));case 6:a=o.sent,0===a?(this.setState({ecode:0}),r(),m.notify.show("新建完成。","success",2e3)):this.setState({ecode:a});case 8:case"end":return o.stop()}},null,this)}},{key:"handleCancel",value:function(){var e=this.props,t=e.close,n=e.submitting;n||(this.setState({ecode:0}),t())}},{key:"render",value:function(){var e=this.props,t=e.i18n.errMsg,n=e.fields,r=n.name,a=n.description,o=e.handleSubmit,l=e.invalid,s=e.submitting;return c.default.createElement(f.Modal,{show:!0,onHide:this.handleCancel,backdrop:"static","aria-labelledby":"contained-modal-title-sm"},c.default.createElement(f.Modal.Header,{closeButton:!0},c.default.createElement(f.Modal.Title,{id:"contained-modal-title-la"},"创建通知事件")),c.default.createElement("form",{onSubmit:o(this.handleSubmit),onKeyDown:function(e){13==e.keyCode&&e.preventDefault()}},c.default.createElement(f.Modal.Body,null,c.default.createElement(f.FormGroup,{controlId:"formControlsText",validationState:r.touched&&r.error?"error":null},c.default.createElement(f.ControlLabel,null,c.default.createElement("span",{className:"txt-impt"},"*"),"名称"),c.default.createElement(f.FormControl,i({disabled:s,type:"text"},r,{placeholder:"事件名称"})),r.touched&&r.error&&c.default.createElement(f.HelpBlock,{style:{"float":"right"}},r.error)),c.default.createElement(f.FormGroup,{controlId:"formControlsText"},c.default.createElement(f.ControlLabel,null,"描述"),c.default.createElement(f.FormControl,i({disabled:s,type:"text"},a,{placeholder:"状态描述"})))),c.default.createElement(f.Modal.Footer,null,c.default.createElement("span",{className:"ralign"},0!==this.state.ecode&&!s&&t[this.state.ecode]),c.default.createElement("img",{src:y,className:s?"loading":"hide"}),c.default.createElement(f.Button,{disabled:s||l,type:"submit"},"确定"),c.default.createElement(f.Button,{bsStyle:"link",disabled:s,onClick:this.handleCancel},"取消"))))}}],[{key:"propTypes",value:{i18n:u.PropTypes.object.isRequired,submitting:u.PropTypes.bool,invalid:u.PropTypes.bool,values:u.PropTypes.object,fields:u.PropTypes.object,handleSubmit:u.PropTypes.func.isRequired,close:u.PropTypes.func.isRequired,create:u.PropTypes.func.isRequired},enumerable:!0}]);var n=t;return t=(0,d.reduxForm)({form:"state",fields:["name","description"],validate:v})(t)||t}(u.Component);t.default=b,e.exports=t.default}).call(this)}finally{}},1830:function(e,t,n){try{(function(){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t,n){for(var r=!0;r;){var a=e,o=t,i=n;r=!1,null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,o);if(void 0!==l){if("value"in l)return l.value;var s=l.get;if(void 0===s)return;return s.call(i)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,n=i,r=!0,l=u=void 0}},s=n(1),u=r(s),c=n(2),d=n(5),f=function(e){function t(e){a(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.confirm=this.confirm.bind(this),this.cancel=this.cancel.bind(this)}return o(t,e),i(t,[{key:"confirm",value:function(){var e,t,n,r,a,o,i,l;return regeneratorRuntime.async(function(s){for(;;)switch(s.prev=s.next){case 0:if(e=this.props,t=e.close,n=e.del,r=void 0===n?null:n,a=e.reset,o=void 0===a?null:a,i=e.data,l=0,t(),!o){s.next=16;break}return s.next=12,regeneratorRuntime.awrap(o(i.id));case 12:l=s.sent,0===l?d.notify.show("重置完成。","success",2e3):d.notify.show("重置失败。","error",2e3),s.next=20;break;case 16:return s.next=18,regeneratorRuntime.awrap(r(i.id));case 18:l=s.sent,0===l?d.notify.show("删除成功。","success",2e3):d.notify.show("删除失败。","success",2e3);case 20:case"end":return s.stop()}},null,this)}},{key:"cancel",value:function(){var e=this.props.close;e()}},{key:"render",value:function(){var e=this.props,t=e.data,n=e.reset,r=void 0===n?null:n;e.del;return u.default.createElement(c.Modal,{show:!0,onHide:this.cancel,backdrop:"static","aria-labelledby":"contained-modal-title-sm"},u.default.createElement(c.Modal.Header,{closeButton:!0},u.default.createElement(c.Modal.Title,{id:"contained-modal-title-la"},r?"重置":"删除","通知事件 - ",t.name)),u.default.createElement(c.Modal.Body,null,r?"确认要重置此事件？":"确认要删除此事件？"),u.default.createElement(c.Modal.Footer,null,u.default.createElement(c.Button,{onClick:this.confirm},"确定"),u.default.createElement(c.Button,{bsStyle:"link",onClick:this.cancel},"取消")))}}],[{key:"propTypes",value:{close:s.PropTypes.func.isRequired,del:s.PropTypes.func,reset:s.PropTypes.func,data:s.PropTypes.object.isRequired},enumerable:!0}]),t}(s.Component);t.default=f,e.exports=t.default}).call(this)}finally{}},1831:function(e,t,n){try{(function(){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var a=e,o=t,i=n;r=!1,null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,o);if(void 0!==l){if("value"in l)return l.value;var s=l.get;if(void 0===s)return;return s.call(i)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,n=i,r=!0,l=u=void 0}},u=n(1),c=r(u),d=n(8),f=n(2),p=n(7),h=(r(p),n(3)),m=r(h),y=n(5),v=n(4),b=function(e,t){var n={};return e.name?t.data.name!==e.name&&m.default.findIndex(t.collection||[],{name:e.name})!==-1&&(n.name="该名称已存在"):n.name="必填",n},g=function(e){function t(e){a(this,n),s(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,e),this.state={ecode:0},this.handleSubmit=this.handleSubmit.bind(this),this.handleCancel=this.handleCancel.bind(this)}o(t,e),l(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.initializeForm,n=e.data;t(n)}},{key:"handleSubmit",value:function(){var e,t,n,r,a;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props,t=e.values,n=e.update,r=e.close,o.next=6,regeneratorRuntime.awrap(n(t));case 6:a=o.sent,0===a?(this.setState({ecode:0}),r(),y.notify.show("更新完成。","success",2e3)):this.setState({ecode:a});case 8:case"end":return o.stop()}},null,this)}},{key:"handleCancel",value:function(){var e=this.props,t=e.close,n=e.submitting;n||(this.setState({ecode:0}),t())}},{key:"render",value:function(){var e=this.props,t=e.i18n.errMsg,n=e.fields,r=n.id,a=n.name,o=n.description,l=e.handleSubmit,s=e.invalid,u=e.dirty,d=e.submitting,p=e.data;return c.default.createElement(f.Modal,{show:!0,onHide:this.handleCancel,backdrop:"static","aria-labelledby":"contained-modal-title-sm"},c.default.createElement(f.Modal.Header,{closeButton:!0},c.default.createElement(f.Modal.Title,{id:"contained-modal-title-la"},"编辑事件 - "+p.name)),c.default.createElement("form",{onSubmit:l(this.handleSubmit),onKeyDown:function(e){13==e.keyCode&&e.preventDefault()}},c.default.createElement(f.Modal.Body,null,c.default.createElement(f.FormGroup,{controlId:"formControlsText",validationState:a.touched&&a.error?"error":null},c.default.createElement(f.ControlLabel,null,c.default.createElement("span",{className:"txt-impt"},"*"),"名称"),c.default.createElement(f.FormControl,i({type:"hidden"},r)),c.default.createElement(f.FormControl,i({disabled:d,type:"text"},a,{placeholder:"事件名称"})),a.touched&&a.error&&c.default.createElement(f.HelpBlock,{style:{"float":"right"}},a.error)),c.default.createElement(f.FormGroup,{controlId:"formControlsText"},c.default.createElement(f.ControlLabel,null,"描述"),c.default.createElement(f.FormControl,i({disabled:d,type:"text"},o,{placeholder:"状态描述"})))),c.default.createElement(f.Modal.Footer,null,c.default.createElement("span",{className:"ralign"},0!==this.state.ecode&&!d&&t[this.state.ecode]),c.default.createElement("img",{src:v,className:d?"loading":"hide"}),c.default.createElement(f.Button,{disabled:!u||d||s,type:"submit"},"确定"),c.default.createElement(f.Button,{bsStyle:"link",disabled:d,onClick:this.handleCancel},"取消"))))}}],[{key:"propTypes",value:{i18n:u.PropTypes.object.isRequired,submitting:u.PropTypes.bool,invalid:u.PropTypes.bool,dirty:u.PropTypes.bool,values:u.PropTypes.object,fields:u.PropTypes.object,handleSubmit:u.PropTypes.func.isRequired,close:u.PropTypes.func.isRequired,data:u.PropTypes.object.isRequired,initializeForm:u.PropTypes.func.isRequired,update:u.PropTypes.func.isRequired},enumerable:!0}]);var n=t;return t=(0,d.reduxForm)({form:"state",fields:["id","name","description"],validate:b})(t)||t}(u.Component);t.default=g,e.exports=t.default}).call(this)}finally{}},1832:function(e,t,n){try{(function(){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){
return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t,n){for(var r=!0;r;){var a=e,o=t,i=n;r=!1,null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,o);if(void 0!==l){if("value"in l)return l.value;var s=l.get;if(void 0===s)return;return s.call(i)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,n=i,r=!0,l=u=void 0}},s=n(1),u=r(s),c=n(2),d=n(3),f=(r(d),n(1829)),p=(n(4),function(e){function t(e){a(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={createModalShow:!1},this.createModalClose=this.createModalClose.bind(this)}return o(t,e),i(t,[{key:"createModalClose",value:function(){this.setState({createModalShow:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.i18n,r=t.create,a=t.indexLoading,o=t.collection;return u.default.createElement("div",null,u.default.createElement("div",{style:{marginTop:"5px"}},u.default.createElement(c.Button,{className:"create-btn",onClick:function(){e.setState({createModalShow:!0})},disabled:a},u.default.createElement("i",{className:"fa fa-plus"})," 新建事件")),this.state.createModalShow&&u.default.createElement(f,{show:!0,close:this.createModalClose,create:r,collection:o,i18n:n}))}}],[{key:"propTypes",value:{i18n:s.PropTypes.object.isRequired,create:s.PropTypes.func.isRequired,indexLoading:s.PropTypes.bool.isRequired,collection:s.PropTypes.array.isRequired},enumerable:!0}]),t}(s.Component));t.default=p,e.exports=t.default}).call(this)}finally{}},1833:function(e,t,n){try{(function(){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t,n){for(var r=!0;r;){var a=e,o=t,i=n;r=!1,null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,o);if(void 0!==l){if("value"in l)return l.value;var s=l.get;if(void 0===s)return;return s.call(i)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,n=i,r=!0,l=u=void 0}},s=n(1),u=r(s),c=n(31),d=n(2),f=n(3),p=r(f),h=n(1831),m=n(1830),y=n(1827),v=n(30),b=n(4),g=["create_issue","edit_issue","del_issue","add_comments","edit_comments","del_comments","add_worklog","edit_worklog","del_worklog","resolve_issue","close_issue","start_progress_issue","stop_progress_issue","assign_issue","move_issue","reopen_issue","normal"],E=function(e){function t(e){a(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={editModalShow:!1,configModalShow:!1,delNotifyShow:!1,resetNotifyShow:!1,operateShow:!1,hoverRowId:""},this.editModalClose=this.editModalClose.bind(this),this.delNotifyClose=this.delNotifyClose.bind(this),this.resetNotifyClose=this.resetNotifyClose.bind(this),this.configModalClose=this.configModalClose.bind(this)}return o(t,e),i(t,[{key:"componentWillMount",value:function(){var e=this.props.index;e()}},{key:"editModalClose",value:function(){this.setState({editModalShow:!1})}},{key:"delNotifyClose",value:function(){this.setState({delNotifyShow:!1})}},{key:"resetNotifyClose",value:function(){this.setState({resetNotifyShow:!1})}},{key:"configModalClose",value:function(){this.setState({configModalShow:!1})}},{key:"edit",value:function(e){this.setState({editModalShow:!0});var t=this.props.select;t(e)}},{key:"delNotify",value:function(e){this.setState({delNotifyShow:!0});var t=this.props.select;t(e)}},{key:"resetNotify",value:function(e){this.setState({resetNotifyShow:!0});var t=this.props.select;t(e)}},{key:"config",value:function(e){this.setState({configModalShow:!0});var t=this.props.select;t(e)}},{key:"operateSelect",value:function(e){var t=this.state.hoverRowId;"1"===e?this.edit(t):"2"===e?this.config(t):"3"===e?this.resetNotify(t):"4"===e&&this.delNotify(t)}},{key:"onRowMouseOver",value:function(e){e.id!==this.state.hoverRowId&&this.setState({operateShow:!0,hoverRowId:e.id})}},{key:"onMouseLeave",value:function(){this.setState({operateShow:!1,hoverRowId:""})}},{key:"render",value:function(){for(var e=this.props,t=e.i18n,n=e.pkey,r=e.collection,a=e.selectedItem,o=e.loading,i=e.indexLoading,l=e.itemLoading,s=e.del,f=e.update,E=e.setNotify,P=e.reset,k=e.options,w=this.state,_=w.hoverRowId,O=w.operateShow,C=u.default.createElement("span",null,u.default.createElement("i",{className:"fa fa-cog"})),T=[],x=r.length,j=0;j<x;j++){var S="$_sys_$"!==n&&"$_sys_$"===r[j].project_key;T.push({id:r[j].id,name:u.default.createElement("div",null,u.default.createElement("span",{className:"table-td-title"},r[j].name,S&&u.default.createElement("span",{style:{fontWeight:"normal"}}," (全局)")),r[j].description&&u.default.createElement("span",{className:"table-td-desc"},r[j].description)),notifications:u.default.createElement("ul",{style:{marginBottom:"0px",paddingLeft:"0px",listStyle:"none"}},p.default.isEmpty(r[j].notifications)?"-":p.default.map(r[j].notifications,function(e,t){var n="";if("assignee"==e)n="当前负责人";else if("reporter"==e)n="报告者";else if("project_principal"==e)n="项目负责人";else if("module_principal"==e)n="模块负责人";else if("current_user"==e)n="当前用户";else if("watchers"==e)n="所有关注者";else if("user"==e.key&&e.value&&e.value.name)n="单一用户: "+e.value.name;else if("role"==e.key&&e.value){var r=p.default.find(k.roles||[],{id:e.value});n=r?"角色: "+r.name:"角色: 不明确"}else if("single_user_field"==e.key&&e.value){var r=p.default.find(k.single_user_fields||[],{id:e.value});n=r?"单一用户字段: "+r.name:"单一用户字段: 不明确"}else if("multi_user_field"==e.key&&e.value){var r=p.default.find(k.multi_user_fields||[],{id:e.value});n=r?"多用户字段: "+r.name:"多用户字段: 不明确"}return u.default.createElement("li",{key:t},n)})),operation:u.default.createElement("div",null,O&&_===r[j].id&&!l&&u.default.createElement(d.DropdownButton,{pullRight:!0,bsStyle:"link",style:{textDecoration:"blink",color:"#000"},key:j,title:C,id:"dropdown-basic-"+j,onSelect:this.operateSelect.bind(this)},!S&&g.indexOf(r[j].key||"")===-1&&u.default.createElement(d.MenuItem,{eventKey:"1"},"编辑"),u.default.createElement(d.MenuItem,{eventKey:"2"},"通知设置"),S&&u.default.createElement(d.MenuItem,{eventKey:"3"},"重置通知"),!S&&g.indexOf(r[j].key||"")===-1&&u.default.createElement(d.MenuItem,{eventKey:"4"},"删除")),u.default.createElement("img",{src:b,className:l&&a.id===r[j].id?"loading":"hide"}))})}var M={};return i?M.noDataText=u.default.createElement("div",null,u.default.createElement("img",{src:b,className:"loading"})):M.noDataText="暂无数据显示。",M.onRowMouseOver=this.onRowMouseOver.bind(this),u.default.createElement("div",{style:{marginBottom:"30px"}},u.default.createElement(v,null),u.default.createElement(c.BootstrapTable,{data:T,bordered:!1,hover:!0,options:M,trClassName:"tr-top"},u.default.createElement(c.TableHeaderColumn,{dataField:"id",isKey:!0,hidden:!0},"ID"),u.default.createElement(c.TableHeaderColumn,{dataField:"name"},"名称"),u.default.createElement(c.TableHeaderColumn,{dataField:"notifications"},"通知设置"),u.default.createElement(c.TableHeaderColumn,{width:"60",dataField:"operation"})),!i&&r.length>0&&u.default.createElement("div",{className:"page-footer"},u.default.createElement("span",null,"共计 ",r.length," 个。")),this.state.editModalShow&&u.default.createElement(h,{show:!0,close:this.editModalClose,update:f,data:a,collection:r,i18n:t}),this.state.delNotifyShow&&u.default.createElement(m,{show:!0,close:this.delNotifyClose,data:a,del:s}),this.state.resetNotifyShow&&u.default.createElement(m,{show:!0,close:this.resetNotifyClose,data:a,reset:P}),this.state.configModalShow&&u.default.createElement(y,{show:!0,loading:o,close:this.configModalClose,data:a,setNotify:E,options:k,i18n:t}))}}],[{key:"propTypes",value:{i18n:s.PropTypes.object.isRequired,pkey:s.PropTypes.string.isRequired,collection:s.PropTypes.array.isRequired,options:s.PropTypes.object.isRequired,selectedItem:s.PropTypes.object.isRequired,loading:s.PropTypes.bool.isRequired,itemLoading:s.PropTypes.bool.isRequired,indexLoading:s.PropTypes.bool.isRequired,index:s.PropTypes.func.isRequired,select:s.PropTypes.func.isRequired,update:s.PropTypes.func.isRequired,setNotify:s.PropTypes.func.isRequired,reset:s.PropTypes.func.isRequired,del:s.PropTypes.func.isRequired},enumerable:!0}]),t}(s.Component);t.default=E,e.exports=t.default}).call(this)}finally{}},2074:function(e,t,n){try{(function(){"use strict";function e(e){return(0,u.asyncFuncCreator)({constant:"EVENTS_INDEX",promise:function(t){return t.request({url:"/project/"+e+"/events"})}})}function r(e,t){return(0,u.asyncFuncCreator)({constant:"EVENTS_CREATE",promise:function(n){return n.request({url:"/project/"+e+"/events",method:"post",data:t})}})}function a(e,t){return(0,u.asyncFuncCreator)({constant:"EVENTS_UPDATE",promise:function(n){return n.request({url:"/project/"+e+"/events/"+t.id,method:"put",data:t})}})}function o(e,t){return(0,u.asyncFuncCreator)({constant:"EVENTS_SET_NOTIFY",promise:function(n){return n.request({url:"/project/"+e+"/events/"+t.id+"/notify",method:"post",data:t})}})}function i(e){return{type:"EVENTS_SELECT",id:e}}function l(e,t){return(0,u.asyncFuncCreator)({constant:"EVENTS_DELETE",id:t,promise:function(n){return n.request({url:"/project/"+e+"/events/"+t,method:"delete"})}})}function s(e,t){return(0,u.asyncFuncCreator)({constant:"EVENTS_RESET",id:t,promise:function(n){return n.request({url:"/project/"+e+"/events/"+t+"/reset"})}})}Object.defineProperty(t,"__esModule",{value:!0}),t.index=e,t.create=r,t.update=a,t.setNotify=o,t.select=i,t.del=l,t.reset=s;var u=n(27)}).call(this)}finally{}}});
//# sourceMappingURL=events-22330d39961866779fe1.js.map