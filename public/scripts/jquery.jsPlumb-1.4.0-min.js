!function(){function e(t,n,e){return e(t=jsPlumbUtil.isArray(t)?t:[t.x,t.y],n=jsPlumbUtil.isArray(n)?n:[n.x,n.y])}jsPlumbUtil={isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},isString:function(t){return"string"==typeof t},isBoolean:function(t){return"boolean"==typeof t},isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},isDate:function(t){return"[object Date]"===Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)},clone:function(t){if(this.isString(t))return""+t;if(this.isBoolean(t))return!!t;if(this.isDate(t))return new Date(t.getTime());if(this.isFunction(t))return t;if(this.isArray(t)){for(var n=[],e=0;e<t.length;e++)n.push(this.clone(t[e]));return n}if(this.isObject(t)){n={};for(var e in t)n[e]=this.clone(t[e]);return n}return t},merge:function(t,n){var e=this.clone(t);for(var o in n)if(null==e[o]||this.isString(n[o])||this.isBoolean(n[o]))e[o]=n[o];else if(this.isArray(n[o])){var i=[];this.isArray(e[o])&&i.push.apply(i,e[o]),i.push.apply(i,n[o]),e[o]=i}else if(this.isObject(n[o]))for(var r in this.isObject(e[o])||(e[o]={}),n[o])e[o][r]=n[o][r];return e},copyValues:function(t,n,e){for(var o=0;o<t.length;o++)e[t[o]]=n[t[o]]},functionChain:function(t,n,e){for(var o=0;o<e.length;o++){var i=e[o][0][e[o][1]].apply(e[o][0],e[o][2]);if(i===n)return i}return t},populate:function(t,i){var o=function(t){if(null!=t){if(jsPlumbUtil.isString(t))return function(t){var n=t.match(/(\${.*?})/g);if(null!=n)for(var e=0;e<n.length;e++){var o=i[n[e].substring(2,n[e].length-1)];o&&(t=t.replace(n[e],o))}return t}(t);if(jsPlumbUtil.isArray(t)){for(var n=[],e=0;e<t.length;e++)n.push(o(t[e]));return n}if(jsPlumbUtil.isObject(t)){n={};for(var e in t)n[e]=o(t[e]);return n}return t}};return o(t)},convertStyle:function(t,n){if("transparent"===t)return t;function e(t){return 1==(n=Number(t).toString(16)).length?"0"+n:n;var n}var o,i=t,r=/(rgb[a]?\()(.*)(\))/;return t.match(r)&&(i="#"+e((o=t.match(r)[2].split(","))[0])+e(o[1])+e(o[2]),n||4!=o.length||(i+=e(o[3]))),i},gradient:function(t,n){return e(t,n,function(t,n){return n[0]==t[0]?n[1]>t[1]?1/0:-1/0:n[1]==t[1]?n[0]>t[0]?0:-0:(n[1]-t[1])/(n[0]-t[0])})},normal:function(t,n){return-1/this.gradient(t,n)},lineLength:function(t,n){return e(t,n,function(t,n){return Math.sqrt(Math.pow(n[1]-t[1],2)+Math.pow(n[0]-t[0],2))})},segment:function(t,n){return e(t,n,function(t,n){return n[0]>t[0]||n[0]==t[0]?n[1]>t[1]?2:1:n[1]>t[1]?3:4})},theta:function(t,n){return e(t,n,function(t,n){var e=jsPlumbUtil.gradient(t,n),o=Math.atan(e),i=jsPlumbUtil.segment(t,n);return 4!=i&&3!=i||(o+=Math.PI),o<0&&(o+=2*Math.PI),o})},intersects:function(t,n){var e=t.x,o=t.x+t.w,i=t.y,r=t.y+t.h,s=n.x,a=n.x+n.w,l=n.y,u=n.y+n.h;return e<=s&&s<=o&&i<=l&&l<=r||e<=a&&a<=o&&i<=l&&l<=r||e<=s&&s<=o&&i<=u&&u<=r||e<=a&&s<=o&&i<=u&&u<=r||s<=e&&e<=a&&l<=i&&i<=u||s<=o&&o<=a&&l<=i&&i<=u||s<=e&&e<=a&&l<=r&&r<=u||s<=o&&e<=a&&l<=r&&r<=u},segmentMultipliers:[null,[1,-1],[1,1],[-1,1],[-1,-1]],inverseSegmentMultipliers:[null,[-1,-1],[-1,1],[1,1],[1,-1]],pointOnLine:function(t,n,e){var o=jsPlumbUtil.gradient(t,n),i=jsPlumbUtil.segment(t,n),r=0<e?jsPlumbUtil.segmentMultipliers[i]:jsPlumbUtil.inverseSegmentMultipliers[i],s=Math.atan(o),a=Math.abs(e*Math.sin(s))*r[1],l=Math.abs(e*Math.cos(s))*r[0];return{x:t.x+l,y:t.y+a}},perpendicularLineTo:function(t,n,e){var o=jsPlumbUtil.gradient(t,n),i=Math.atan(-1/o),r=e/2*Math.sin(i),s=e/2*Math.cos(i);return[{x:n.x+s,y:n.y+r},{x:n.x-s,y:n.y-r}]},findWithFunction:function(t,n){if(t)for(var e=0;e<t.length;e++)if(n(t[e]))return e;return-1},clampToGrid:function(t,n,e,o,i){function r(t,n){var e=t%n;return(Math.floor(t/n)+(n/2<=e?1:0))*n}return[o||null==e?t:r(t,e[0]),i||null==e?n:r(n,e[1])]},indexOf:function(t,n){return jsPlumbUtil.findWithFunction(t,function(t){return t==n})},removeWithFunction:function(t,n){var e=jsPlumbUtil.findWithFunction(t,n);return-1<e&&t.splice(e,1),-1!=e},remove:function(t,n){var e=jsPlumbUtil.indexOf(t,n);return-1<e&&t.splice(e,1),-1!=e},addWithFunction:function(t,n,e){-1==jsPlumbUtil.findWithFunction(t,e)&&t.push(n)},addToList:function(t,n,e){var o=t[n];return null==o&&(o=[],t[n]=o),o.push(e),o},EventGenerator:function(){var i={},r=this,s=!1,a=["ready"];this.bind=function(t,n){return jsPlumbUtil.addToList(i,t,n),r},this.fire=function(n,t,e){if(!s&&i[n])for(var o=0;o<i[n].length;o++)if(-1!=jsPlumbUtil.findWithFunction(a,function(t){return t===n}))i[n][o](t,e);else try{i[n][o](t,e)}catch(t){jsPlumbUtil.log("jsPlumb: fire failed for event "+n+" : "+t)}return r},this.unbind=function(t){return t?delete i[t]:i={},r},this.getListener=function(t){return i[t]},this.setSuspendEvents=function(t){s=t},this.isSuspendEvents=function(){return s}},logEnabled:!0,log:function(){if(jsPlumbUtil.logEnabled&&"undefined"!=typeof console)try{var t=arguments[arguments.length-1];console.log(t)}catch(t){}},group:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.group(t)},groupEnd:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.groupEnd(t)},time:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.time(t)},timeEnd:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.timeEnd(t)},removeElement:function(t){null!=t&&null!=t.parentNode&&t.parentNode.removeChild(t)},removeElements:function(t){for(var n=0;n<t.length;n++)jsPlumbUtil.removeElement(t[n])}}}(),function(){function n(c){var d={},e=[],p={},h={},f={};this.register=function(t){var s=jsPlumb.CurrentLibrary;t=s.getElementObject(t);var a=c.getId(t),n=s.getDOMElement(t),l=s.getOffset(t);d[a]||(d[a]=t,e.push(t),p[a]={});var u=function(t,n){if(t)for(var e,o,i,r=0;r<t.childNodes.length;r++){3!=t.childNodes[r].nodeType&&8!=t.childNodes[r].nodeType&&(e=s.getElementObject(t.childNodes[r]),(o=c.getId(e,null,!0))&&h[o]&&0<h[o]&&(i=s.getOffset(e),p[a][o]={id:o,offset:{left:i.left-l.left,top:i.top-l.top}},f[o]=a),u(t.childNodes[r]))}};u(n)},this.updateOffsets=function(t){var n=jsPlumb.CurrentLibrary,e=n.getElementObject(t),o=c.getId(e),i=p[o],r=n.getOffset(e);if(i)for(var s in i){var a=n.getElementObject(s),l=n.getOffset(a);p[o][s]={id:s,offset:{left:l.left-r.left,top:l.top-r.top}},f[s]=o}},this.endpointAdded=function(t){var n=jsPlumb.CurrentLibrary,e=document.body,o=c.getId(t),i=n.getDOMElement(t).parentNode;for(h[o]=h[o]?h[o]+1:1;null!=i&&i!=e;){var r=c.getId(i,null,!0);if(r&&d[r]){var s,a=n.getElementObject(i),l=n.getOffset(a);null==p[r][o]&&(s=jsPlumb.CurrentLibrary.getOffset(t),p[r][o]={id:o,offset:{left:s.left-l.left,top:s.top-l.top}},f[o]=r);break}i=i.parentNode}},this.endpointDeleted=function(t){if(h[t.elementId]&&(h[t.elementId]--,h[t.elementId]<=0))for(var n in p)p[n]&&(delete p[n][t.elementId],delete f[t.elementId])},this.changeId=function(t,n){p[n]=p[t],p[t]={},f[n]=f[t],f[t]=null},this.getElementsForDraggable=function(t){return p[t]},this.elementRemoved=function(t){var n=f[t];n&&(delete p[n][t],delete f[t])},this.reset=function(){d={},e=[],p={},h={}}}var e=!!document.createElement("canvas").getContext,o=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),i=function(){var t,n;return null==i.vml&&((t=document.body.appendChild(document.createElement("div"))).innerHTML='<v:shape id="vml_flag1" adj="1" />',(n=t.firstChild).style.behavior="url(#default#VML)",i.vml=!n||"object"==typeof n.adj,t.parentNode.removeChild(t)),i.vml};window.console||(window.console={time:function(){},timeEnd:function(){},group:function(){},groupEnd:function(){},log:function(){}}),window.jsPlumbAdapter={headless:!1,appendToRoot:function(t){document.body.appendChild(t)},getRenderModes:function(){return["canvas","svg","vml"]},isRenderModeAvailable:function(t){return{canvas:e,svg:o,vml:i()}[t]},getDragManager:function(t){return new n(t)},setRenderMode:function(t){var n,e,o,i;return t&&(t=t.toLowerCase(),e=this.isRenderModeAvailable("canvas"),o=this.isRenderModeAvailable("svg"),i=this.isRenderModeAvailable("vml"),"svg"===t?o?n="svg":e?n="canvas":i&&(n="vml"):"canvas"===t&&e?n="canvas":i&&(n="vml")),n}}}(),function(){jsPlumbUtil.findWithFunction;function pt(t,n){return It.CurrentLibrary.getAttribute(Et(t),n)}function ht(t,n){It.CurrentLibrary.addClass(Et(t),n)}function ft(t,n){It.CurrentLibrary.removeClass(Et(t),n)}function mt(t,n){var e=It.CurrentLibrary.getOffset(Et(t));if(null==n)return e;var o=n.getZoom();return{left:e.left/o,top:e.top/o}}function gt(t){return It.CurrentLibrary.getSize(Et(t))}function vt(){return""+(new Date).getTime()}function e(t){this.Defaults={Anchor:"BottomCenter",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:8,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},t&&It.extend(this.Defaults,t),this.logEnabled=this.Defaults.LogEnabled;var e={},o={};this.registerConnectionType=function(t,n){e[t]=It.extend({},n)},this.registerConnectionTypes=function(t){for(var n in t)e[n]=It.extend({},t[n])},this.registerEndpointType=function(t,n){o[t]=It.extend({},n)},this.registerEndpointTypes=function(t){for(var n in t)o[n]=It.extend({},t[n])},this.getType=function(t,n){return"connection"===n?e[t]:o[t]},jsPlumbUtil.EventGenerator.apply(this);var n,S=this,l=(n=At+1,At++,n),i=S.bind,r={},s=1;for(var a in this.getInstanceIndex=function(){return l},this.setZoom=function(t,n){s=t,n&&S.repaintEverything()},this.getZoom=function(){return s},this.Defaults)r[a]=this.Defaults[a];function u(){return""+_++}function f(t){return t._nodes?t._nodes:t}function c(t,n,e,o){if(!jsPlumbAdapter.headless&&!ct){var i=pt(t,"id"),r=S.dragManager.getElementsForDraggable(i);if(null==e&&(e=vt()),S.anchorManager.redraw(i,n,e,null,o),r)for(var s in r)S.anchorManager.redraw(r[s].id,n,e,r[s].offset,o)}}function d(t,n){var e=null;if(Ct(t)){e=[];for(var o=0,i=t.length;o<i;o++){var r=Et(t[o]),s=pt(r,"id");e.push(n(r,s))}}else e=n(r=Et(t),s=pt(r,"id"));return e}function p(t){return x[t]}function h(n,t,e){var o,i,r,s,a,l,u;jsPlumbAdapter.headless||(u=null!=t&&t,o=It.CurrentLibrary,u&&o.isDragSupported(n)&&!o.isAlreadyDraggable(n)&&(i=e||S.Defaults.DragOptions||It.Defaults.DragOptions,i=It.extend({},i),r=o.dragEvents.drag,s=o.dragEvents.stop,i[a=o.dragEvents.start]=Y(i[a],function(){S.setHoverSuspended(!0),S.select({source:n}).addClass(S.elementDraggingClass+" "+S.sourceElementDraggingClass,!0),S.select({target:n}).addClass(S.elementDraggingClass+" "+S.targetElementDraggingClass,!0)}),i[r]=Y(i[r],function(){var t=o.getUIPosition(arguments,S.getZoom());c(n,t,null,!0),ht(n,"jsPlumb_dragged")}),i[s]=Y(i[s],function(){var t=o.getUIPosition(arguments,S.getZoom());c(n,t),ft(n,"jsPlumb_dragged"),S.setHoverSuspended(!1),S.select({source:n}).removeClass(S.elementDraggingClass+" "+S.sourceElementDraggingClass,!0),S.select({target:n}).removeClass(S.elementDraggingClass+" "+S.targetElementDraggingClass,!0)}),l=X(n),w[l]=!0,u=w[l],i.disabled=null!=u&&!u,o.initDraggable(n,i,!1,S),S.dragManager.register(n)))}function m(t){if(t.container)return t.container;var n=It.CurrentLibrary.getTagName(t.source),e=It.CurrentLibrary.getParent(t.source);return n&&"td"===n.toLowerCase()?It.CurrentLibrary.getParent(e):e}function g(t,n,e){var o=C[t];if(o&&o.length)for(var i=0,r=o.length;i<r;i++){for(var s=0,a=o[i].connections.length;s<a;s++){if(n(o[i].connections[s]))return}e&&e(o[i])}}function v(t,e,o){e="block"===e;var n=null;o&&(n=e?function(t){t.setVisible(!0,!0,!0)}:function(t){t.setVisible(!1,!0,!0)});var i=pt(t,"id");g(i,function(t){var n;e&&o?(n=t.sourceId===i?1:0,t.endpoints[n].isVisible()&&t.setVisible(!0)):t.setVisible(e)},n)}function D(t){var n,e=t.timestamp,o=t.recalc,i=t.offset,r=t.elId;return ct&&!e&&(e=dt),!o&&e&&e===E[r]||(o||!i?null!=(n=Et(r))&&(O[r]=gt(n),j[r]=mt(n,S),E[r]=e):(j[r]=i,null==O[r]&&null!=(n=Et(r))&&(O[r]=gt(n))),j[r]&&!j[r].right&&(j[r].right=j[r].left+O[r][0],j[r].bottom=j[r].top+O[r][1],j[r].width=O[r][0],j[r].height=O[r][1],j[r].centerx=j[r].left+j[r].width/2,j[r].centery=j[r].top+j[r].height/2)),{o:j[r],s:O[r]}}this.bind=function(t,n){"ready"===t&&b?n():i.apply(S,[t,n])},S.importDefaults=function(t){for(var n in t)S.Defaults[n]=t[n]},S.restoreDefaults=function(){S.Defaults=It.extend({},r)};var y=null,b=!1,P=null,A={},C={},x={},j={},E={},I={},w={},O=[],L=this.Defaults.Scope,M=null,_=1,k=function(t){var n=S.Defaults.ConnectionType||S.getDefaultConnectionType(),e=S.Defaults.EndpointType||It.Endpoint,o=It.CurrentLibrary.getParent;t.container?t.parent=t.container:t.sourceEndpoint?t.parent=t.sourceEndpoint.parent:t.source.constructor==e?t.parent=t.source.parent:t.parent=o(t.source),t._jsPlumb=S,t.newConnection=k,t.newEndpoint=F,t.endpointsByUUID=x,t.endpointsByElement=C,t.finaliseConnection=T;var i=new n(t);return i.id="con_"+u(),U("click","click",i),U("dblclick","dblclick",i),U("contextmenu","contextmenu",i),i},T=function(t,n,e){var o;n=n||{},t.suspendedEndpoint||Pt(A,t.scope,t),S.anchorManager.newConnection(t),c(t.source),n.doNotFireConnectionEvent||!1===n.fireEvent||(o={connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]},S.fire("jsPlumbConnection",o,e),S.fire("connection",o,e))},U=function(t,e,o){o.bind(t,function(t,n){S.fire(e,o,n)})},F=function(t){var n=S.Defaults.EndpointType||It.Endpoint,e=It.extend({},t);e.parent=m(e),e._jsPlumb=S,e.newConnection=k,e.newEndpoint=F,e.endpointsByUUID=x,e.endpointsByElement=C,e.finaliseConnection=T,e.fireDetachEvent=H,e.floatingConnections=I,e.getParentFromParams=m,e.connectionsByScope=A;var o=new n(e);return o.id="ep_"+u(),U("click","endpointClick",o),U("dblclick","endpointDblClick",o),U("contextmenu","contextmenu",o),jsPlumbAdapter.headless||S.dragManager.endpointAdded(t.source),o},X=function(t,n,e){var o,i,r,s=Et(t),a=pt(s,"id");return a&&"undefined"!=a||(2==arguments.length&&null!=n?a=n:1!=arguments.length&&(3!=arguments.length||e)||(a="jsPlumb_"+l+"_"+u()),e||(o=s,i="id",r=a,It.CurrentLibrary.setAttribute(Et(o),i,r))),a},Y=function(n,e,o){return n=n||function(){},e=e||function(){},function(){var t=null;try{t=e.apply(this,arguments)}catch(t){St(S,"jsPlumb function failed : "+t)}if(null==o||t!==o)try{n.apply(this,arguments)}catch(t){St(S,"wrapped function failed : "+t)}return t}};this.isConnectionBeingDragged=function(){return null!=P},this.setConnectionBeingDragged=function(t){P=t},this.connectorClass="_jsPlumb_connector",this.hoverClass="_jsPlumb_hover",this.endpointClass="_jsPlumb_endpoint",this.endpointConnectedClass="_jsPlumb_endpoint_connected",this.endpointFullClass="_jsPlumb_endpoint_full",this.endpointDropAllowedClass="_jsPlumb_endpoint_drop_allowed",this.endpointDropForbiddenClass="_jsPlumb_endpoint_drop_forbidden",this.overlayClass="_jsPlumb_overlay",this.draggingClass="_jsPlumb_dragging",this.elementDraggingClass="_jsPlumb_element_dragging",this.sourceElementDraggingClass="_jsPlumb_source_element_dragging",this.targetElementDraggingClass="_jsPlumb_target_element_dragging",this.endpointAnchorClassPrefix="_jsPlumb_endpoint_anchor",this.Anchors={},this.Connectors={canvas:{},svg:{},vml:{}},this.Endpoints={canvas:{},svg:{},vml:{}},this.Overlays={canvas:{},svg:{},vml:{}},this.ConnectorRenderers={},this.addClass=function(t,n){return It.CurrentLibrary.addClass(t,n)},this.removeClass=function(t,n){return It.CurrentLibrary.removeClass(t,n)},this.hasClass=function(t,n){return It.CurrentLibrary.hasClass(t,n)},this.addEndpoint=function(t,n,e){e=e||{};var o=It.extend({},e);It.extend(o,n),o.endpoint=o.endpoint||S.Defaults.Endpoint||It.Defaults.Endpoint,o.paintStyle=o.paintStyle||S.Defaults.EndpointStyle||It.Defaults.EndpointStyle;for(var i=[],r=(t=f(t)).length&&t.constructor!=String?t:[t],s=0,a=r.length;s<a;s++){var l=Et(r[s]),u=X(l);o.source=l,D({elId:u,timestamp:dt});var c=F(o);o.parentAnchor&&(c.parentAnchor=o.parentAnchor),Pt(C,u,c);var d=j[u],p=O[u],h={anchorLoc:c.anchor.compute({xy:[d.left,d.top],wh:p,element:c,timestamp:dt}),timestamp:dt};ct&&(h.recalc=!1),c.paint(h),i.push(c)}return 1==i.length?i[0]:i},this.addEndpoints=function(t,n,e){for(var o=[],i=0,r=n.length;i<r;i++){var s=S.addEndpoint(t,n[i],e);Ct(s)?Array.prototype.push.apply(o,s):o.push(s)}return o},this.animate=function(t,n,e){var o=Et(t),i=pt(t,"id");e=e||{};var r=It.CurrentLibrary.dragEvents.step,s=It.CurrentLibrary.dragEvents.complete;e[r]=Y(e[r],function(){S.repaint(i)}),e[s]=Y(e[s],function(){S.repaint(i)}),It.CurrentLibrary.animate(o,n,e)},this.checkCondition=function(n,t){var e=S.getListener(n),o=!0;if(e&&0<e.length)try{for(var i=0,r=e.length;i<r;i++)o=o&&e[i](t)}catch(t){St(S,"cannot check condition ["+n+"]"+t)}return o},this.checkASyncCondition=function(n,t,e,o){var i=S.getListener(n);if(i&&0<i.length)try{i[0](t,e,o)}catch(t){St(S,"cannot asynchronously check condition ["+n+"]"+t)}},this.connect=function(t,n){var e,o=function(t,n){var e=It.extend({sourceIsNew:!0,targetIsNew:!0},t);if(n&&It.extend(e,n),e.source&&e.source.endpoint&&(e.sourceEndpoint=e.source),e.target&&e.target.endpoint&&(e.targetEndpoint=e.target),t.uuids&&(e.sourceEndpoint=p(t.uuids[0]),e.targetEndpoint=p(t.uuids[1])),e.sourceEndpoint&&e.sourceEndpoint.isFull())St(S,"could not add connection; source endpoint is full");else{if(!e.targetEndpoint||!e.targetEndpoint.isFull()){if(e.sourceEndpoint&&(e.sourceIsNew=!1),e.targetEndpoint&&(e.targetIsNew=!1),!e.type&&e.sourceEndpoint&&(e.type=e.sourceEndpoint.connectionType),e.sourceEndpoint&&e.sourceEndpoint.connectorOverlays){e.overlays=e.overlays||[];for(var o=0,i=e.sourceEndpoint.connectorOverlays.length;o<i;o++)e.overlays.push(e.sourceEndpoint.connectorOverlays[o])}if(!e["pointer-events"]&&e.sourceEndpoint&&e.sourceEndpoint.connectorPointerEvents&&(e["pointer-events"]=e.sourceEndpoint.connectorPointerEvents),e.target&&!e.target.endpoint&&!e.targetEndpoint&&!e.newConnection){var r=X(e.target),s=K[r],a=Q[r];if(s){if(!at[r])return;var l=null!=a?a:S.addEndpoint(e.target,s);$[r]&&(Q[r]=l),(e.targetEndpoint=l)._makeTargetCreator=!0,e.targetIsNew=!0}}if(e.source&&!e.source.endpoint&&!e.sourceEndpoint&&!e.newConnection){r=X(e.source),s=nt[r],a=et[r];if(s){if(!it[r])return;l=null!=a?a:S.addEndpoint(e.source,s);ot[r]&&(et[r]=l),e.sourceEndpoint=l,e.sourceIsNew=!0}}return e}St(S,"could not add connection; target endpoint is full")}}(t,n);return o&&(null==o.deleteEndpointsOnDetach&&(o.deleteEndpointsOnDetach=!0),e=k(o),T(e,o)),e},this.deleteEndpoint=function(t){var n="string"==typeof t?x[t]:t;if(n){var e=n.getUuid();for(var o in e&&(x[e]=null),n.detachAll(),n.cleanup(),n.endpoint.cleanup&&n.endpoint.cleanup(),jsPlumbUtil.removeElements(n.endpoint.getDisplayElements()),S.anchorManager.deleteEndpoint(n),C){var i=C[o];if(i){for(var r=[],s=0,a=i.length;s<a;s++)i[s]!=n&&r.push(i[s]);C[o]=r}C[o].length<1&&delete C[o]}jsPlumbAdapter.headless||S.dragManager.endpointDeleted(n)}return S},this.deleteEveryEndpoint=function(){for(var t in S.setSuspendDrawing(!0),C){var n=C[t];if(n&&n.length)for(var e=0,o=n.length;e<o;e++)S.deleteEndpoint(n[e])}return C={},x={},S.anchorManager.reset(),S.dragManager.reset(),S.setSuspendDrawing(!1,!0),S};var H=function(t,n,e){var o=S.Defaults.ConnectionType||S.getDefaultConnectionType(),i=t.constructor==o?{connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]}:t;n&&(S.fire("jsPlumbConnectionDetached",i,e),S.fire("connectionDetached",i,e)),S.anchorManager.connectionDetached(i)};function W(t,n,e){return function(){return function(t,n,e,o){for(var i=0,r=t.length;i<r;i++)t[i][n].apply(t[i],e);return o(t)}(t,n,arguments,e)}}function N(t,n){return function(){return function(t,n,e){for(var o=[],i=0,r=t.length;i<r;i++)o.push([t[i][n].apply(t[i],e),t[i]]);return o}(t,n,arguments)}}function R(t,n){var e=[];if(t)if("string"==typeof t){if("*"===t)return t;e.push(t)}else if(n)e=t;else for(var o=0,i=t.length;o<i;o++)e.push(X(Et(t[o])));return e}function B(t,n,e){return"*"===t||(0<t.length?-1!=yt(t,n):!e)}function V(t,n){for(var e,o,i,r={length:t.length,each:(i=n,function(t){for(var n=0,e=o.length;n<e;n++)t(o[n]);return i(o)}),get:(e=o=t,function(t){return e[t]})},s=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],a=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],l=0,u=s.length;l<u;l++)r[s[l]]=W(t,s[l],n);for(l=0,u=a.length;l<u;l++)r[a[l]]=N(t,a[l]);return r}this.detach=function(){var t,n,e,o,i,r,s,a,l;0!=arguments.length&&(t=S.Defaults.ConnectionType||S.getDefaultConnectionType(),n=arguments[0].constructor==t,o=!1!==(e=2==arguments.length&&n?arguments[1]||{}:arguments[0]).fireEvent,i=e.forceDetach,(r=n?arguments[0]:e.connection)?(i||jsPlumbUtil.functionChain(!0,!1,[[r.endpoints[0],"isDetachAllowed",[r]],[r.endpoints[1],"isDetachAllowed",[r]],[r,"isDetachAllowed",[r]],[S,"checkCondition",["beforeDetach",r]]]))&&r.endpoints[0].detach(r,!1,!0,o):(s=It.extend({},e)).uuids?p(s.uuids[0]).detachFrom(p(s.uuids[1]),o):s.sourceEndpoint&&s.targetEndpoint?s.sourceEndpoint.detachFrom(s.targetEndpoint):(a=X(s.source),l=X(s.target),g(a,function(t){(t.sourceId==a&&t.targetId==l||t.targetId==a&&t.sourceId==l)&&S.checkCondition("beforeDetach",t)&&t.endpoints[0].detach(t,!1,!0,o)})))},this.detachAllConnections=function(t,n){n=n||{},t=Et(t);var e=pt(t,"id"),o=C[e];if(o&&o.length)for(var i=0,r=o.length;i<r;i++)o[i].detachAll(n.fireEvent);return S},this.detachEveryConnection=function(t){for(var n in t=t||{},C){var e=C[n];if(e&&e.length)for(var o=0,i=e.length;o<i;o++)e[o].detachAll(t.fireEvent)}return A={},S},this.draggable=function(t,n){if("object"==typeof t&&t.length)for(var e=0,o=t.length;e<o;e++){(i=Et(t[e]))&&h(i,!0,n)}else if(t._nodes)for(e=0,o=t._nodes.length;e<o;e++){(i=Et(t._nodes[e]))&&h(i,!0,n)}else{var i;(i=Et(t))&&h(i,!0,n)}return S},this.extend=function(t,n){return It.CurrentLibrary.extend(t,n)},this.getDefaultEndpointType=function(){return It.Endpoint},this.getDefaultConnectionType=function(){return It.Connection},this.getConnections=function(t,n){t?t.constructor==String&&(t={scope:t}):t={};var e,o,i,r=t.scope||S.getDefaultScope(),s=R(r,!0),a=R(t.source),l=R(t.target),u=!n&&1<s.length?{}:[];for(var c in A)if(B(s,c))for(var d=0,p=A[c].length;d<p;d++){var h=A[c][d];B(a,h.sourceId)&&B(l,h.targetId)&&(e=c,o=h,i=void 0,!n&&1<s.length?(null==(i=u[e])&&(i=[],u[e]=i),i.push(o)):u.push(o))}return u};var z=function(e){var t=V(e,z);return It.CurrentLibrary.extend(t,{setDetachable:W(e,"setDetachable",z),setReattach:W(e,"setReattach",z),setConnector:W(e,"setConnector",z),detach:function(){for(var t=0,n=e.length;t<n;t++)S.detach(e[t])},isDetachable:N(e,"isDetachable"),isReattach:N(e,"isReattach")})},G=function(e){var t=V(e,G);return It.CurrentLibrary.extend(t,{setEnabled:W(e,"setEnabled",G),setAnchor:W(e,"setAnchor",G),isEnabled:N(e,"isEnabled"),detachAll:function(){for(var t=0,n=e.length;t<n;t++)e[t].detachAll()},delete:function(){for(var t=0,n=e.length;t<n;t++)S.deleteEndpoint(e[t])}})};this.select=function(t){(t=t||{}).scope=t.scope||"*";var n=t.connections||S.getConnections(t,!0);return z(n)},this.selectEndpoints=function(t){(t=t||{}).scope=t.scope||"*";var n=!t.element&&!t.source&&!t.target,e=n?"*":R(t.element),o=n?"*":R(t.source),i=n?"*":R(t.target),r=R(t.scope,!0),s=[];for(var a in C){var l=B(e,a,!0),u=B(o,a,!0),c="*"!=o,d=B(i,a,!0),p="*"!=i;if(l||u||d)t:for(var h=0,f=C[a].length;h<f;h++){var m=C[a][h];if(B(r,m.scope,!0)){var g=c&&0<o.length&&!m.isSource,v=p&&0<i.length&&!m.isTarget;if(g||v)continue t;s.push(m)}}}return G(s)},this.getAllConnections=function(){return A},this.getDefaultScope=function(){return L},this.getEndpoint=p,this.getEndpoints=function(t){return C[X(t)]},this.getId=X,this.getOffset=function(t){j[t];return D({elId:t})},this.getSelector=function(){return It.CurrentLibrary.getSelector.apply(null,arguments)},this.getSize=function(t){return O[t]||D({elId:t}),O[t]};var q=!(this.appendElement=function(t,n){S.Defaults.Container?It.CurrentLibrary.appendElement(t,S.Defaults.Container):n?It.CurrentLibrary.appendElement(t,n):jsPlumbAdapter.appendToRoot(t)});function Z(t){return function(){return jsPlumbAdapter.isRenderModeAvailable(t)}}function J(t,n){t.paintStyle=t.paintStyle||S.Defaults.EndpointStyles[n]||S.Defaults.EndpointStyle||It.Defaults.EndpointStyles[n]||It.Defaults.EndpointStyle,t.hoverPaintStyle=t.hoverPaintStyle||S.Defaults.EndpointHoverStyles[n]||S.Defaults.EndpointHoverStyle||It.Defaults.EndpointHoverStyles[n]||It.Defaults.EndpointHoverStyle,t.anchor=t.anchor||S.Defaults.Anchors[n]||S.Defaults.Anchor||It.Defaults.Anchors[n]||It.Defaults.Anchor,t.endpoint=t.endpoint||S.Defaults.Endpoints[n]||S.Defaults.Endpoint||It.Defaults.Endpoints[n]||It.Defaults.Endpoint}this.isHoverSuspended=function(){return q},this.setHoverSuspended=function(t){q=t},this.isCanvasAvailable=Z("canvas"),this.isSVGAvailable=Z("svg"),this.isVMLAvailable=Z("vml"),this.hide=function(t,n){return v(t,"none",n),S},this.idstamp=u,this.init=function(){b||(S.anchorManager=new It.AnchorManager({jsPlumbInstance:S}),S.setRenderMode(S.Defaults.RenderMode),b=!0,S.fire("ready",S))},this.log=y,this.jsPlumbUIComponent=Dt,this.makeAnchor=function(){function t(t,n){if(It.Anchors[t])return new It.Anchors[t](n);if(!S.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+t+"'"}}if(0==arguments.length)return null;var n,e,o=arguments[0],i=arguments[1],r=arguments[2],s=null;return o.compute&&o.getOrientation?o:("string"==typeof o?s=t(arguments[0],{elementId:i,jsPlumbInstance:S}):Ct(o)&&(Ct(o[0])||xt(o[0])?s=2==o.length&&xt(o[0])&&jt(o[1])?(n=It.extend({elementId:i,jsPlumbInstance:S},o[1]),t(o[0],n)):new It.DynamicAnchor({anchors:o,selector:null,elementId:i,jsPlumbInstance:r}):(e={x:o[0],y:o[1],orientation:4<=o.length?[o[2],o[3]]:[0,0],offsets:6<=o.length?[o[4],o[5]]:[0,0],elementId:i,jsPlumbInstance:r,cssClass:7==o.length?o[6]:null},(s=new It.Anchor(e)).clone=function(){return new It.Anchor(e)})),s.id||(s.id="anchor_"+u()),s)},this.makeAnchors=function(t,n,e){for(var o=[],i=0,r=t.length;i<r;i++)"string"==typeof t[i]?o.push(It.Anchors[t[i]]({elementId:n,jsPlumbInstance:e})):Ct(t[i])&&o.push(S.makeAnchor(t[i],n,e));return o},this.makeDynamicAnchor=function(t,n){return new It.DynamicAnchor({anchors:t,selector:n,elementId:null,jsPlumbInstance:S})};var K={},Q={},$={},tt={};this.makeTarget=function(t,n,e){var g=It.extend({_jsPlumb:S},e);It.extend(g,n),J(g,1);var v=It.CurrentLibrary,o=g.scope||S.Defaults.Scope,y=!(!1===g.deleteEndpointsOnDetach),i=g.maxConnections||-1,b=g.onMaxConnections;_doOne=function(f){var m=X(f);K[m]=g,$[m]=g.uniqueEndpoint,tt[m]=i,at[m]=!0,proxyComponent=new Dt(g);var t=It.extend({},g.dropOptions||{}),n=v.dragEvents.drop;t.scope=t.scope||o,t[n]=Y(t[n],function(){var t=It.CurrentLibrary.getDropEvent(arguments),n=S.select({target:m}).length;S.currentlyDragging=!1;var e=Et(v.getDragObject(arguments)),o=pt(e,"dragId"),i=pt(e,"originalScope"),r=I[o],s=r.endpoints[0];g.endpoint&&It.extend({},g.endpoint);if(!at[m]||0<tt[m]&&n>=tt[m])return b&&b({element:f,connection:r},t),!1;s.anchor.locked=!1,i&&v.setDragScope(e,i);var a,l,u,c,d,p,h=proxyComponent.isDropAllowed(r.sourceId,X(f),r.scope,r,null);r.endpointsToDeleteOnDetach&&(s===r.endpointsToDeleteOnDetach[0]?r.endpointsToDeleteOnDetach[0]=null:s===r.endpointsToDeleteOnDetach[1]&&(r.endpointsToDeleteOnDetach[1]=null)),r.suspendedEndpoint&&(r.targetId=r.suspendedEndpoint.elementId,r.target=v.getElementObject(r.suspendedEndpoint.elementId),r.endpoints[1]=r.suspendedEndpoint),h?(s.detach(r,!1,!0,!1),a=Q[m]||S.addEndpoint(f,g),g.uniqueEndpoint&&(Q[m]=a),a._makeTargetCreator=!0,null!=a.anchor.positionFinder&&(l=v.getUIPosition(arguments,S.getZoom()),u=mt(f,S),c=gt(f),d=a.anchor.positionFinder(l,u,c,a.anchor.constructorParams),a.anchor.x=d[0],a.anchor.y=d[1]),p=S.connect({source:s,target:a,scope:i,previousConnection:r,container:r.parent,deleteEndpointsOnDetach:y,endpointsToDeleteOnDetach:y?[s,a]:null,doNotFireConnectionEvent:s.endpointWillMoveAfterConnection}),r.endpoints[1]._makeTargetCreator&&r.endpoints[1].connections.length<2&&S.deleteEndpoint(r.endpoints[1]),p.repaint()):r.suspendedEndpoint&&(r.isReattach()?(r.setHover(!1),r.floatingAnchorIndex=null,r.suspendedEndpoint.addConnection(r),S.repaint(s.elementId)):s.detach(r,!1,!0,!0,t))}),v.initDroppable(f,t,!0)};for(var r=(t=f(t)).length&&t.constructor!=String?t:[t],s=0,a=r.length;s<a;s++)_doOne(Et(r[s]));return S},this.unmakeTarget=function(t,n){t=It.CurrentLibrary.getElementObject(t);var e=X(t);return n||(delete K[e],delete $[e],delete tt[e],delete at[e]),S},this.makeTargets=function(t,n,e){for(var o=0,i=t.length;o<i;o++)S.makeTarget(t[o],n,e)};var nt={},et={},ot={},it={},rt={},st={},at={};function lt(t,n,e,o){var i="source"==t?it:at;if(xt(n))i[n]=o?!i[n]:e;else if(n.length)for(var r=0,s=(n=f(n)).length;r<s;r++){var a=_el=It.CurrentLibrary.getElementObject(n[r]);i[a=X(_el)]=o?!i[a]:e}return S}this.makeSource=function(t,n,e){var C=It.extend({},e);It.extend(C,n),J(C,0);function o(f){function m(){return null==C.parent?C.parent:"parent"===C.parent?x.getElementObject(x.getDOMElement(f).parentNode):x.getElementObject(C.parent)}var g=X(f),v=null!=C.parent?S.getId(m()):g;nt[v]=C,ot[v]=C.uniqueEndpoint,it[v]=!0;var t=x.dragEvents.stop,n=x.dragEvents.drag,y=It.extend({},C.dragOptions||{}),e=y.drag,r=y.stop,b=null,P=!1;function o(t){if(it[v]){if(C.filter){var n=x.getOriginalEvent(t);if(!1===(jsPlumbUtil.isString(C.filter)?function(t,n,e){for(var o=t.target||t.srcElement,i=!1,r=S.getSelector(n,e),s=0;s<r.length;s++)if(r[s]==o){i=!0;break}return i}(n,f,C.filter):C.filter(n,f)))return}var e=S.select({source:v}).length;if(0<=st[v]&&e>=st[v])return E&&E({element:f,maxConnections:j},t),!1;var o,i,r=D({elId:g}).o,s=S.getZoom(),a=((t.pageX||t.page.x)/s-r.left)/r.width,l=((t.pageY||t.page.y)/s-r.top)/r.height,u=a,c=l;C.parent&&(o=m(),i=X(o),r=D({elId:i}).o,u=((t.pageX||t.page.x)-r.left)/r.width,c=((t.pageY||t.page.y)-r.top)/r.height);var d,p={};It.extend(p,C),p.isSource=!0,p.anchor=[a,l,0,0],p.parentAnchor=[u,c,0,0],p.dragOptions=y,C.parent&&(d=p.container||S.Defaults.Container||It.Defaults.Container,p.container=d||It.CurrentLibrary.getParent(m())),b=S.addEndpoint(g,p),P=!0,b.endpointWillMoveAfterConnection=null!=C.parent,b.endpointWillMoveTo=C.parent?m():null;function h(){P&&S.deleteEndpoint(b)}S.registerListener(b.canvas,"mouseup",h),S.registerListener(f,"mouseup",h),x.trigger(b.canvas,"mousedown",t)}}st[v]=j,y.scope=y.scope||C.scope,y[n]=Y(y[n],function(){e&&e.apply(this,arguments),P=!1}),y[t]=Y(y[t],function(){var t,n,e,o,i;r&&r.apply(this,arguments),S.currentlyDragging=!1,0==b.connections.length?S.deleteEndpoint(b):(x.unbind(b.canvas,"mousedown"),t=C.anchor||S.Defaults.Anchor,b.anchor,n=b.connections[0],b.setAnchor(S.makeAnchor(t,g,S)),!C.parent||(e=m())&&(o=b.elementId,i=C.container||S.Defaults.Container||It.Defaults.Container,b.setElement(e,i),b.endpointWillMoveAfterConnection=!1,S.anchorManager.rehomeEndpoint(o,e),n.previousConnection=null,bt(A[n.scope],function(t){return t.id===n.id}),S.anchorManager.connectionDetached({sourceId:n.sourceId,targetId:n.targetId,connection:n}),T(n)),b.repaint(),S.repaint(b.elementId),S.repaint(n.targetId))}),S.registerListener(f,"mousedown",o),rt[g]=o,C.filter&&jsPlumbUtil.isString(C.filter)&&x.setDragFilter(f,C.filter)}for(var x=It.CurrentLibrary,j=C.maxConnections||-1,E=C.onMaxConnections,i=(t=f(t)).length&&t.constructor!=String?t:[t],r=0,s=i.length;r<s;r++)o(Et(i[r]));return S},this.unmakeSource=function(t,n){t=It.CurrentLibrary.getElementObject(t);var e=X(t),o=rt[e];return o&&S.unregisterListener(t,"mousedown",o),n||(delete nt[e],delete ot[e],delete it[e],delete rt[e],delete st[e]),S},this.unmakeEverySource=function(){for(var t in it)S.unmakeSource(t,!0);nt={},ot={},it={},rt={}},this.unmakeEveryTarget=function(){for(var t in at)S.unmakeTarget(t,!0);return K={},$={},tt={},at={},S},this.makeSources=function(t,n,e){for(var o=0,i=t.length;o<i;o++)S.makeSource(t[o],n,e);return S},this.setSourceEnabled=function(t,n){return lt("source",t,n)},this.toggleSourceEnabled=function(t){return lt("source",t,null,!0),S.isSourceEnabled(t)},this.isSource=function(t){return t=It.CurrentLibrary.getElementObject(t),null!=it[X(t)]},this.isSourceEnabled=function(t){return t=It.CurrentLibrary.getElementObject(t),!0===it[X(t)]},this.setTargetEnabled=function(t,n){return lt("target",t,n)},this.toggleTargetEnabled=function(t){return lt("target",t,null,!0),S.isTargetEnabled(t)},this.isTarget=function(t){return t=It.CurrentLibrary.getElementObject(t),null!=at[X(t)]},this.isTargetEnabled=function(t){return t=It.CurrentLibrary.getElementObject(t),!0===at[X(t)]},this.ready=function(t){S.bind("ready",t)},this.repaint=function(t,n,e){if("object"==typeof t&&t.length)for(var o=0,i=t.length;o<i;o++)c(Et(t[o]),n,e);else c(Et(t),n,e);return S},this.repaintEverything=function(){var t=vt();for(var n in C)c(Et(n),null,t);return S},this.removeAllEndpoints=function(t,s){var a=function(t){var n=jsPlumbUtil.isString(t)?t:X(Et(t)),e=C[n];if(e)for(var o=0,i=e.length;o<i;o++)S.deleteEndpoint(e[o]);if(delete C[n],s){var r=It.CurrentLibrary.getDOMElement(Et(t));if(r&&3!=r.nodeType&&8!=r.nodeType)for(o=0,i=r.childNodes.length;o<i;o++)a(r.childNodes[o])}};return a(t),S},this.remove=function(t,n){t=Et(t),S.removeAllEndpoints(t,!0),It.CurrentLibrary.removeElement(t)};var ut={};this.registerListener=function(t,n,e){It.CurrentLibrary.bind(t,n,e),Pt(ut,n,{el:t,event:n,listener:e})},this.unregisterListener=function(t,n,e){It.CurrentLibrary.unbind(t,n,e),bt(ut,function(t){return t.type==n&&t.listener==e})},this.reset=function(){S.deleteEveryEndpoint(),S.unbind(),K={},Q={},$={},tt={},nt={},et={},ot={},st={},function(){for(var t in ut)for(var n=0,e=ut[t].length;n<e;n++){var o=ut[t][n];It.CurrentLibrary.unbind(o.el,o.event,o.listener)}ut={}}(),S.anchorManager.reset(),jsPlumbAdapter.headless||S.dragManager.reset()},this.setDefaultScope=function(t){return L=t,S},this.setDraggable=function(t,e){return d(t,function(t,n){w[n]=e,It.CurrentLibrary.isDragSupported(t)&&It.CurrentLibrary.setDraggable(t,e)})},this.setId=function(r,s,t){var n=r.constructor==String?r:S.getId(r),e=S.getConnections({source:n,scope:"*"},!0),o=S.getConnections({target:n,scope:"*"},!0);s=""+s,t||(r=It.CurrentLibrary.getElementObject(n),It.CurrentLibrary.setAttribute(r,"id",s)),r=It.CurrentLibrary.getElementObject(s),C[s]=C[n]||[];for(var i=0,a=C[s].length;i<a;i++)C[s][i].setElementId(s),C[s][i].setReferenceElement(r);delete C[n],S.anchorManager.changeId(n,s),jsPlumbAdapter.headless||S.dragManager.changeId(n,s);function l(t,n,e){for(var o=0,i=t.length;o<i;o++)t[o].endpoints[n].setElementId(s),t[o].endpoints[n].setReferenceElement(r),t[o][e+"Id"]=s,t[o][e]=r}l(e,0,"source"),l(o,1,"target"),S.repaint(s)},this.setIdChanged=function(t,n){S.setId(t,n,!0)};var ct=!(this.setDebugLog=function(t){y=t}),dt=null;this.setSuspendDrawing=function(t,n){dt=(ct=t)?(new Date).getTime():null,n&&S.repaintEverything()},this.isSuspendDrawing=function(){return ct},this.getSuspendedAt=function(){return dt},this.updateOffset=D,this.getOffset=function(t){return j[t]},this.getSize=function(t){return O[t]},this.getCachedData=function(t){var n=j[t];return n?{o:n,s:O[t]}:D({elId:t})},this.timestamp=vt,this.SVG="svg",this.VML="vml",this.setRenderMode=function(t){return M=jsPlumbAdapter.setRenderMode(t)},this.getRenderMode=function(){return M},this.show=function(t,n){return v(t,"block",n),S},this.sizeCanvas=function(t,n,e,o,i){return t&&(t.style.height=i+"px",t.height=i,t.style.width=o+"px",t.width=o,t.style.left=n+"px",t.style.top=e+"px"),S},this.getTestHarness=function(){return{endpointsByElement:C,endpointCount:function(t){var n=C[t];return n?n.length:0},connectionCount:function(t){var n=A[t=t||L];return n?n.length:0},getId:X,makeAnchor:self.makeAnchor,makeDynamicAnchor:self.makeDynamicAnchor}},this.toggleVisible=function(t,n){g(t,function(t){var n=t.isVisible();t.setVisible(!n)},n?function(t){var n=t.isVisible();t.setVisible(!n)}:null)},this.toggleDraggable=function(t){return d(t,function(t,n){var e=!(e=null!=w[n]&&w[n]);return w[n]=e,It.CurrentLibrary.setDraggable(t,e),e})},this.wrap=Y,this.addListener=this.bind,this.adjustForParentOffsetAndScroll=function(t,n){var e,o,i=null,r=t;return"svg"===n.tagName.toLowerCase()&&n.parentNode?i=n.parentNode:n.offsetParent&&(i=n.offsetParent),null!=i&&(e="body"===i.tagName.toLowerCase()?{left:0,top:0}:mt(i,S),o="body"===i.tagName.toLowerCase()?{left:0,top:0}:{left:i.scrollLeft,top:i.scrollTop},r[0]=t[0]-e.left+o.left,r[1]=t[1]-e.top+o.top),r},jsPlumbAdapter.headless||(S.dragManager=jsPlumbAdapter.getDragManager(S),S.recalculateOffsets=S.dragManager.updateOffsets)}var yt=jsPlumbUtil.indexOf,bt=jsPlumbUtil.removeWithFunction,Pt=(jsPlumbUtil.remove,jsPlumbUtil.addWithFunction,jsPlumbUtil.addToList),Ct=jsPlumbUtil.isArray,xt=jsPlumbUtil.isString,jt=jsPlumbUtil.isObject,Et=function(t){return It.CurrentLibrary.getElementObject(t)},St=jsPlumbUtil.log,Dt=(jsPlumbUtil.group,jsPlumbUtil.groupEnd,jsPlumbUtil.time,jsPlumbUtil.timeEnd,window.jsPlumbUIComponent=function(t){var a=this,n=arguments,o=!1,e=t.parameters||{},i=a.idPrefix+(new Date).getTime(),r=null,s=null;if(a._jsPlumb=t._jsPlumb,a.getId=function(){return i},a.hoverClass=t.hoverClass||a._jsPlumb.Defaults.HoverClass||It.Defaults.HoverClass,jsPlumbUtil.EventGenerator.apply(this),t.events)for(var l in t.events)a.bind(l,t.events[l]);this.clone=function(){var t=new Object;return a.constructor.apply(t,n),t},this.getParameter=function(t){return e[t]},this.getParameters=function(){return e},this.setParameter=function(t,n){e[t]=n},this.setParameters=function(t){e=t},this.overlayPlacements=[];var u=t.beforeDetach;this.isDetachAllowed=function(t){var n=!0;if(u)try{n=u(t)}catch(t){St("jsPlumb: beforeDetach callback failed",t)}return n};var c=t.beforeDrop;this.isDropAllowed=function(t,n,e,o,i){var r=a._jsPlumb.checkCondition("beforeDrop",{sourceId:t,targetId:n,scope:e,connection:o,dropEndpoint:i});if(c)try{r=c({sourceId:t,targetId:n,scope:e,connection:o,dropEndpoint:i})}catch(t){St("jsPlumb: beforeDrop callback failed",t)}return r};function d(){var t;r&&s&&(t={},It.extend(t,r),It.extend(t,s),delete a.hoverPaintStyle,t.gradient&&r.fillStyle&&delete t.gradient,s=t)}this.setPaintStyle=function(t,n){r=t,a.paintStyleInUse=r,d(),n||a.repaint()},this.getPaintStyle=function(){return r},this.setHoverPaintStyle=function(t,n){s=t,d(),n||a.repaint()},this.getHoverPaintStyle=function(){return s},this.setHover=function(t,n,e){a._jsPlumb.currentlyDragging||a._jsPlumb.isHoverSuspended()||(o=t,null!=a.canvas&&(null!=a.hoverClass&&(t?p.addClass(a.canvas,a.hoverClass):p.removeClass(a.canvas,a.hoverClass)),t?p.addClass(a.canvas,a._jsPlumb.hoverClass):p.removeClass(a.canvas,a._jsPlumb.hoverClass)),null!=s&&(a.paintStyleInUse=t?s:r,e=e||vt(),a.repaint({timestamp:e,recalc:!1})),a.getAttachedElements&&!n&&m(t,vt(),a))},this.isHover=function(){return o},this.bindListeners=function(t,e,o){t.bind("click",function(t,n){e.fire("click",e,n)}),t.bind("dblclick",function(t,n){e.fire("dblclick",e,n)}),t.bind("contextmenu",function(t,n){e.fire("contextmenu",e,n)}),t.bind("mouseenter",function(t,n){e.isHover()||(o(!0),e.fire("mouseenter",e,n))}),t.bind("mouseexit",function(t,n){e.isHover()&&(o(!1),e.fire("mouseexit",e,n))}),t.bind("mousedown",function(t,n){e.fire("mousedown",e,n)}),t.bind("mouseup",function(t,n){e.fire("mouseup",e,n)})};var p=It.CurrentLibrary,h=["click","dblclick","mouseenter","mouseout","mousemove","mousedown","mouseup","contextmenu"],f={mouseout:"mouseexit"};this.attachListeners=function(t,n){for(var e=0,o=h.length;e<o;e++)!function(t,n,e){var o=f[e]||e;p.bind(t,e,function(t){n.fire(o,n,t)})}(t,n,h[e])};var m=function(t,n,e){var o=a.getAttachedElements();if(o)for(var i=0,r=o.length;i<r;i++)e&&e==o[i]||o[i].setHover(t,!0,n)};this.reattachListenersForElement=function(t){if(1<arguments.length){for(var n=0,e=h.length;n<e;n++)o=t,i=h[n],p.unbind(o,i);for(n=1,e=arguments.length;n<e;n++)a.attachListeners(t,arguments[n])}var o,i};function g(t){return null==t?null:t.split(" ")}function v(t,n){if(a.getDefaultType){for(var e=a.getTypeDescriptor(),o=jsPlumbUtil.merge({},a.getDefaultType()),i=0,r=y.length;i<r;i++)o=jsPlumbUtil.merge(o,a._jsPlumb.getType(y[i],e));t&&(o=jsPlumbUtil.populate(o,t)),a.applyType(o,n),n||a.repaint()}}var y=[];a.setType=function(t,n,e){y=g(t)||[],v(n,e)},a.getType=function(){return y},a.reapplyTypes=function(t,n){v(t,n)},a.hasType=function(t){return-1!=jsPlumbUtil.indexOf(y,t)},a.addType=function(t,n,e){var o=g(t),i=!1;if(null!=o){for(var r=0,s=o.length;r<s;r++)a.hasType(o[r])||(y.push(o[r]),i=!0);i&&v(n,e)}},a.removeType=function(t,n){var e,o,i=g(t),r=!1;if(null!=i){for(var s=0,a=i.length;s<a;s++)e=i[s],r=-1!=(o=jsPlumbUtil.indexOf(y,e))?(y.splice(o,1),!0):r;r&&v(null,n)}},a.toggleType=function(t,n,e){var o=g(t);if(null!=o){for(var i=0,r=o.length;i<r;i++){var s=jsPlumbUtil.indexOf(y,o[i]);-1!=s?y.splice(s,1):y.push(o[i])}v(n,e)}},this.applyType=function(t,n){if(a.setPaintStyle(t.paintStyle,n),a.setHoverPaintStyle(t.hoverPaintStyle,n),t.parameters)for(var e in t.parameters)a.setParameter(e,t.parameters[e])},this.addClass=function(t){null!=a.canvas&&ht(a.canvas,t)},this.removeClass=function(t){null!=a.canvas&&ft(a.canvas,t)}}),At=(window.overlayCapableJsPlumbUIComponent=function(t){Dt.apply(this,arguments);var s=this;this.overlays=[];function e(t){var n,e,o=null,o=Ct(t)?(n=t[0],e=It.extend({component:s,_jsPlumb:s._jsPlumb},t[1]),3==t.length&&It.extend(e,t[2]),new(It.Overlays[s._jsPlumb.getRenderMode()][n])(e)):t.constructor==String?new(It.Overlays[s._jsPlumb.getRenderMode()][t])({component:s,_jsPlumb:s._jsPlumb}):t;s.overlays.push(o)}var n=function(t){for(var n,e=s.defaultOverlayKeys||[],o=(o=t.overlays)||[],i=0,r=e.length;i<r;i++)o.unshift.apply(o,(n=e[i],s._jsPlumb.Defaults[n]||It.Defaults[n]||[]));return o}(t);if(n)for(var o=0,i=n.length;o<i;o++)e(n[o]);function r(t){for(var n=-1,e=0,o=s.overlays.length;e<o;e++)if(t===s.overlays[e].id){n=e;break}return n}this.addOverlay=function(t,n){e(t),n||s.repaint()},this.getOverlay=function(t){var n=r(t);return 0<=n?s.overlays[n]:null},this.getOverlays=function(){return s.overlays},this.hideOverlay=function(t){var n=s.getOverlay(t);n&&n.hide()},this.hideOverlays=function(){for(var t=0,n=s.overlays.length;t<n;t++)s.overlays[t].hide()},this.showOverlay=function(t){var n=s.getOverlay(t);n&&n.show()},this.showOverlays=function(){for(var t=0,n=s.overlays.length;t<n;t++)s.overlays[t].show()},this.removeAllOverlays=function(){for(var t=0,n=s.overlays.length;t<n;t++)s.overlays[t].cleanup&&s.overlays[t].cleanup();s.overlays.splice(0,s.overlays.length),s.repaint()},this.removeOverlay=function(t){var n,e=r(t);-1!=e&&((n=s.overlays[e]).cleanup&&n.cleanup(),s.overlays.splice(e,1))},this.removeOverlays=function(){for(var t=0,n=arguments.length;t<n;t++)s.removeOverlay(arguments[t])};function a(t){var n={cssClass:t.cssClass,labelStyle:this.labelStyle,id:c,component:s,_jsPlumb:s._jsPlumb},e=It.extend(n,t);return new(It.Overlays[s._jsPlumb.getRenderMode()].Label)(e)}var l,u,c="__label";t.label&&(l=t.labelLocation||s.defaultLabelLocation||.5,u=t.labelStyle||s._jsPlumb.Defaults.LabelStyle||It.Defaults.LabelStyle,this.overlays.push(a({label:t.label,location:l,labelStyle:u}))),this.setLabel=function(t){var n,e=s.getOverlay(c);e?t.constructor==String||t.constructor==Function?e.setLabel(t):(t.label&&e.setLabel(t.label),t.location&&e.setLocation(t.location)):(n=t.constructor==String||t.constructor==Function?{label:t}:t,e=a(n),this.overlays.push(e)),s._jsPlumb.isSuspendDrawing()||s.repaint()},this.getLabel=function(){var t=s.getOverlay(c);return null!=t?t.getLabel():null},this.getLabelOverlay=function(){return s.getOverlay(c)};var d=this.applyType;this.applyType=function(t,n){if(d(t,n),s.removeAllOverlays(),t.overlays)for(var e=0,o=t.overlays.length;e<o;e++)s.addOverlay(t.overlays[e],!0)};var p=this.setHover;this.setHover=function(t,n,e){p.apply(s,arguments);for(var o=0,i=s.overlays.length;o<i;o++)s.overlays[o][t?"addClass":"removeClass"](s._jsPlumb.hoverClass)}},0),It=new e;"undefined"!=typeof window&&(window.jsPlumb=It),It.getInstance=function(t){var n=new e(t);return n.init(),n},"function"==typeof define&&(define("jsplumb",[],function(){return It}),define("jsplumbinstance",[],function(){return It.getInstance()})),"undefined"!=typeof exports&&(exports.jsPlumb=It)}(),function(){jsPlumb.AnchorManager=function(C){function t(e){return function(t,n){return!1===(e?t[0][0]<n[0][0]||t[0][1]>n[0][1]:t[0][0]>n[0][0]||t[0][1]>n[0][1])?-1:1}}function I(f,t){function n(t,n,e,o,i,r,s){if(0<o.length){function a(t,n){var e=U.adjustForParentOffsetAndScroll([n[0],n[1]],t.canvas);m[t.id]=[e[0],e[1],n[2],n[3]],g[t.id]=s}for(var l=function(t,n,e,o,i,r){for(var s=[],a=t[o?0:1]/(e.length+1),l=0;l<e.length;l++){var u=(l+1)*a,c=i*t[o?1:0];r&&(u=t[o?0:1]-u);var d=o?u:c,p=n[0]+d,h=d/t[0],f=o?c:u,m=n[1]+f,g=f/t[1];s.push([p,m,h,g,e[l][1],e[l][2]])}return s}(n,e,(h=v[t],o.sort(h)),i,r,"right"===t||"top"===t),u=0;u<l.length;u++){var c=l[u][4],d=c.endpoints[0].elementId===f,p=c.endpoints[1].elementId===f;d?a(c.endpoints[0],l[u]):p&&a(c.endpoints[1],l[u])}}var h}var e=U.getCachedData(f),o=e.s,i=e.o;n("bottom",o,[i.left,i.top],t.bottom,!0,1,[0,1]),n("top",o,[i.left,i.top],t.top,!0,0,[0,-1]),n("left",o,[i.left,i.top],t.left,!1,0,[-1,0]),n("right",o,[i.left,i.top],t.right,!1,1,[1,0])}var w={},e={},m={},d={},g={},O="horizontal",L="vertical",M="diagonal",_="identity",k={},s=this,T={},U=C.jsPlumbInstance,u=jsPlumb.CurrentLibrary,F={},v={top:function(t,n){return t[0]>n[0]?1:-1},right:t(!0),bottom:t(!0),left:function(t,n){var e=t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0];return(n[0][0]<0?-Math.PI-n[0][0]:Math.PI-n[0][0])<e||t[0][1]>n[0][1]?1:-1}};this.reset=function(){w={},k={},T={}},this.addFloatingConnection=function(t,n){F[t]=n},this.removeFloatingConnection=function(t){delete F[t]},this.newConnection=function(t){function n(t,n,e,o,i){r==s&&e.isContinuous&&(u.removeElement(a[1].canvas),l=!1),jsPlumbUtil.addToList(k,o,[i,n,e.constructor==jsPlumb.DynamicAnchor])}var r=t.sourceId,s=t.targetId,a=t.endpoints,l=!0;n(0,a[0],a[0].anchor,s,t),l&&n(0,a[1],a[1].anchor,r,t)};function a(t){var n,e,o;n=T[t.elementId],e=t.id,n&&(o=function(t){return t[4]==e},jsPlumbUtil.removeWithFunction(n.top,o),jsPlumbUtil.removeWithFunction(n.left,o),jsPlumbUtil.removeWithFunction(n.bottom,o),jsPlumbUtil.removeWithFunction(n.right,o))}this.connectionDetached=function(t){function n(t,n,e,o,i){e.constructor==jsPlumb.FloatingAnchor||jsPlumbUtil.removeWithFunction(k[o],function(t){return t[0].id==i.id})}var e=t.connection||t,o=e.sourceId,i=e.targetId,r=e.endpoints;n(0,r[1],r[1].anchor,o,e),n(0,r[0],r[0].anchor,i,e),a(e.endpoints[0]),a(e.endpoints[1]),s.redraw(e.sourceId),s.redraw(e.targetId)},this.add=function(t,n){jsPlumbUtil.addToList(w,n,t)},this.changeId=function(t,n){k[n]=k[t],w[n]=w[t],delete k[t],delete w[t]},this.getConnectionsFor=function(t){return k[t]||[]},this.getEndpointsFor=function(t){return w[t]||[]},this.deleteEndpoint=function(n){jsPlumbUtil.removeWithFunction(w[n.elementId],function(t){return t.id==n.id}),a(n)},this.clearFor=function(t){delete w[t],w[t]=[]};function X(t,n,e,o,i,r,s,a,l,u,c,d){var p=-1,h=o.endpoints[s],f=h.id,m=[[n,e],o,i,r,f],g=t[l],v=h._continuousAnchorEdge?t[h._continuousAnchorEdge]:null;if(v){var y=jsPlumbUtil.findWithFunction(v,function(t){return t[4]==f});if(-1!=y){v.splice(y,1);for(var b=0;b<v.length;b++)jsPlumbUtil.addWithFunction(c,v[b][1],function(t){return t.id==v[b][1].id}),jsPlumbUtil.addWithFunction(d,v[b][1].endpoints[s],function(t){return t.id==v[b][1].endpoints[s].id})}}for(b=0;b<g.length;b++)1==C.idx&&g[b][3]===r&&-1==p&&(p=b),jsPlumbUtil.addWithFunction(c,g[b][1],function(t){return t.id==g[b][1].id}),jsPlumbUtil.addWithFunction(d,g[b][1].endpoints[s],function(t){return t.id==g[b][1].endpoints[s].id});var P=a?-1!=p?p:0:g.length;g.splice(P,0,m),h._continuousAnchorEdge=l}this.redraw=function(n,t,e,o,i){if(!U.isSuspendDrawing()){var r=w[n]||[],s=k[n]||[],a=[],l=[],u=[];e=e||U.timestamp(),o=o||{left:0,top:0},t=t&&{left:t.left+o.left,top:t.top+o.top};for(var c=U.updateOffset({elId:n,offset:t,recalc:!1,timestamp:e}),d=U.getSize(n),p={},h=0;h<s.length;h++){var f,m,g,v,y,b=s[h][0],P=b.sourceId,C=b.targetId,x=b.endpoints[0].anchor.isContinuous,j=b.endpoints[1].anchor.isContinuous;(x||j)&&(m=p[f=P+"_"+C],g=b.sourceId==n?1:0,x&&!T[P]&&(T[P]={top:[],right:[],bottom:[],left:[]}),j&&!T[C]&&(T[C]={top:[],right:[],bottom:[],left:[]}),n!=C&&U.updateOffset({elId:C,timestamp:e}),n!=P&&U.updateOffset({elId:P,timestamp:e}),v=U.getCachedData(C),y=U.getCachedData(P),C==P&&(x||j)?X(T[P],-Math.PI/2,0,b,!1,C,0,!1,"top",0,a,l):(m||(m=function(t,n,e,o,i,r){if(t===n)return{orientation:_,a:["top","top"]};var s,a=Math.atan2(o.centery-e.centery,o.centerx-e.centerx),l=Math.atan2(e.centery-o.centery,e.centerx-o.centerx),u=e.left<=o.left&&e.right>=o.left||e.left<=o.right&&e.right>=o.right||e.left<=o.left&&e.right>=o.right||o.left<=e.left&&o.right>=e.right,c=e.top<=o.top&&e.bottom>=o.top||e.top<=o.bottom&&e.bottom>=o.bottom||e.top<=o.top&&e.bottom>=o.bottom||o.top<=e.top&&o.bottom>=e.bottom,d={orientation:M,theta:a,theta2:l};return u||c?u?(d.orientation=O,d.a=e.top<o.top?["bottom","top"]:["top","bottom"]):(d.orientation=L,d.a=e.left<o.left?["right","left"]:["left","right"]):o.left>e.left&&o.top>e.top?d.a=["right","top"]:o.left>e.left&&e.top>o.top?d.a=["top","left"]:o.left<e.left&&o.top<e.top?d.a=["top","right"]:o.left<e.left&&o.top>e.top&&(d.a=["left","top"]),d.a=(s=d.a,[i.isContinuous?i.verifyEdge(s[0]):s[0],r.isContinuous?r.verifyEdge(s[1]):s[1]]),d}(P,C,y.o,v.o,b.endpoints[0].anchor,b.endpoints[1].anchor),p[f]=m),x&&X(T[P],m.theta,0,b,!1,C,0,!1,m.a[0],0,a,l),j&&X(T[C],m.theta2,-1,b,!0,P,1,!0,m.a[1],0,a,l)),x&&jsPlumbUtil.addWithFunction(u,P,function(t){return t===P}),j&&jsPlumbUtil.addWithFunction(u,C,function(t){return t===C}),jsPlumbUtil.addWithFunction(a,b,function(t){return t.id==b.id}),(x&&0==g||j&&1==g)&&jsPlumbUtil.addWithFunction(l,b.endpoints[g],function(t){return t.id==b.endpoints[g].id}))}for(h=0;h<r.length;h++)0==r[h].connections.length&&r[h].anchor.isContinuous&&(T[n]||(T[n]={top:[],right:[],bottom:[],left:[]}),X(T[n],-Math.PI/2,0,{endpoints:[r[h],r[h]],paint:function(){}},!1,n,0,!1,"top",0,a,l),jsPlumbUtil.addWithFunction(u,n,function(t){return t===n}));for(h=0;h<u.length;h++)I(u[h],T[u[h]]);for(h=0;h<r.length;h++)r[h].paint({timestamp:e,offset:c,dimensions:d});for(h=0;h<l.length;h++){var E=U.getCachedData(l[h].elementId);l[h].paint({timestamp:e,offset:E,dimensions:E.s})}for(h=0;h<s.length;h++){var S=s[h][1];if(S.anchor.constructor==jsPlumb.DynamicAnchor){S.paint({elementWithPrecedence:n}),jsPlumbUtil.addWithFunction(a,s[h][0],function(t){return t.id==s[h][0].id});for(var D=0;D<S.connections.length;D++)S.connections[D]!==s[h][0]&&jsPlumbUtil.addWithFunction(a,S.connections[D],function(t){return t.id==S.connections[D].id})}else S.anchor.constructor==jsPlumb.Anchor&&jsPlumbUtil.addWithFunction(a,s[h][0],function(t){return t.id==s[h][0].id})}var A=F[n];A&&A.paint({timestamp:e,recalc:!1,elId:n});for(h=0;h<a.length;h++)a[h].paint({elId:n,timestamp:e,recalc:!1,clearEdits:i})}},this.rehomeEndpoint=function(t,n){var e=w[t]||[],o=U.getId(n);if(o!==t){for(var i=0;i<e.length;i++)s.add(e[i],o);e.splice(0,e.length)}};function o(n){jsPlumbUtil.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var t=n.faces||["top","right","bottom","left"],e=!(!1===n.clockwise),o={},i={top:"bottom",right:"left",left:"right",bottom:"top"},r={top:"right",right:"bottom",left:"top",bottom:"left"},s={top:"left",right:"top",left:"bottom",bottom:"right"},a=e?r:s,l=e?s:r,u=n.cssClass||"",c=0;c<t.length;c++)o[t[c]]=!0;this.verifyEdge=function(t){return o[t]?t:o[i[t]]?i[t]:o[a[t]]?a[t]:o[l[t]]?l[t]:t},this.compute=function(t){return d[t.element.id]||m[t.element.id]||[0,0]},this.getCurrentLocation=function(t){return d[t.id]||m[t.id]||[0,0]},this.getOrientation=function(t){return g[t.id]||[0,0]},this.clearUserDefinedLocation=function(){delete d[n.elementId]},this.setUserDefinedLocation=function(t){d[n.elementId]=t},this.getCssClass=function(){return u},this.setCssClass=function(t){u=t}}U.continuousAnchorFactory={get:function(t){var n=e[t.elementId];return n||(n=new o(t),e[t.elementId]=n),n}}},jsPlumb.Anchor=function(t){var r=this;this.x=t.x||0,this.y=t.y||0,this.elementId=t.elementId,jsPlumbUtil.EventGenerator.apply(this);var n=t.orientation||[0,0],s=t.jsPlumbInstance,a=null,l=null,e=t.cssClass||"";this.getCssClass=function(){return e},this.offsets=t.offsets||[0,0],r.timestamp=null,this.compute=function(t){var n=t.xy,e=t.wh,o=t.element,i=t.timestamp;return t.clearUserDefinedLocation&&(l=null),i&&i===r.timestamp||(a=null!=l?l:(a=[n[0]+r.x*e[0]+r.offsets[0],n[1]+r.y*e[1]+r.offsets[1]],s.adjustForParentOffsetAndScroll(a,o.canvas)),r.timestamp=i),a},this.getOrientation=function(t){return n},this.equals=function(t){if(!t)return!1;var n=t.getOrientation(),e=this.getOrientation();return this.x==t.x&&this.y==t.y&&this.offsets[0]==t.offsets[0]&&this.offsets[1]==t.offsets[1]&&e[0]==n[0]&&e[1]==n[1]},this.getCurrentLocation=function(){return a},this.getUserDefinedLocation=function(){return l},this.setUserDefinedLocation=function(t){l=t},this.clearUserDefinedLocation=function(){l=null}},jsPlumb.FloatingAnchor=function(t){jsPlumb.Anchor.apply(this,arguments);var e=t.reference,n=jsPlumb.CurrentLibrary,i=t.jsPlumbInstance,o=t.referenceCanvas,r=n.getSize(n.getElementObject(o)),s=null,a=null;this.x=0,this.y=0,this.isFloating=!0,this.compute=function(t){var n=t.xy,e=t.element,o=[n[0]+r[0]/2,n[1]+r[1]/2],o=i.adjustForParentOffsetAndScroll(o,e.canvas);return a=o},this.getOrientation=function(t){if(s)return s;var n=e.getOrientation(t);return[0*Math.abs(n[0])*-1,0*Math.abs(n[1])*-1]},this.over=function(t){s=t.getOrientation()},this.out=function(){s=null},this.getCurrentLocation=function(){return a}},jsPlumb.DynamicAnchor=function(n){jsPlumb.Anchor.apply(this,arguments),this.isSelective=!0,this.isDynamic=!0;function e(t){return t.constructor==jsPlumb.Anchor?t:n.jsPlumbInstance.makeAnchor(t,n.elementId,n.jsPlumbInstance)}for(var s=[],t=0;t<n.anchors.length;t++)s[t]=e(n.anchors[t]);this.addAnchor=function(t){s.push(e(t))},this.getAnchors=function(){return s},this.locked=!1;var a=0<s.length?s[0]:null,l=(s.length,a),u=this,c=n.selector||function(t,n,e,o,i){for(var r,s,a,l,u,c,d,p,h,f=e[0]+o[0]/2,m=e[1]+o[1]/2,g=-1,v=1/0,y=0;y<i.length;y++){var b=(r=i[y],s=f,a=m,u=n,0,c=(l=t)[0]+r.x*u[0],d=l[1]+r.y*u[1],p=l[0]+u[0]/2,h=l[1]+u[1]/2,Math.sqrt(Math.pow(s-c,2)+Math.pow(a-d,2))+Math.sqrt(Math.pow(p-c,2)+Math.pow(h-d,2)));b<v&&(g=y+0,v=b)}return i[g]};this.compute=function(t){var n=t.xy,e=t.wh,o=(t.timestamp,t.txy),i=t.twh;t.clearUserDefinedLocation&&(userDefinedLocation=null);var r=u.getUserDefinedLocation();return null!=r?r:u.locked||null==o||null==i?a.compute(t):(t.timestamp=null,a=c(n,e,o,i,s),u.x=a.x,u.y=a.y,a!=l&&u.fire("anchorChanged",a),(l=a).compute(t))},this.getCurrentLocation=function(){return u.getUserDefinedLocation()||(null!=a?a.getCurrentLocation():null)},this.getOrientation=function(t){return null!=a?a.getOrientation(t):[0,0]},this.over=function(t){null!=a&&a.over(t)},this.out=function(){null!=a&&a.out()},this.getCssClass=function(){return a&&a.getCssClass()||""}};function t(e,o,i,r,s,a){jsPlumb.Anchors[s]=function(t){var n=t.jsPlumbInstance.makeAnchor([e,o,i,r,0,0],t.elementId,t.jsPlumbInstance);return n.type=s,a&&a(n,t),n}}t(.5,0,0,-1,"TopCenter"),t(.5,1,0,1,"BottomCenter"),t(0,.5,-1,0,"LeftMiddle"),t(1,.5,1,0,"RightMiddle"),t(.5,0,0,-1,"Top"),t(.5,1,0,1,"Bottom"),t(0,.5,-1,0,"Left"),t(1,.5,1,0,"Right"),t(.5,.5,0,0,"Center"),t(1,0,0,-1,"TopRight"),t(1,1,0,1,"BottomRight"),t(0,0,0,-1,"TopLeft"),t(0,1,0,1,"BottomLeft"),jsPlumb.Defaults.DynamicAnchors=function(t){return t.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],t.elementId,t.jsPlumbInstance)},jsPlumb.Anchors.AutoDefault=function(t){var n=t.jsPlumbInstance.makeDynamicAnchor(jsPlumb.Defaults.DynamicAnchors(t));return n.type="AutoDefault",n};function n(e,o){jsPlumb.Anchors[e]=function(t){var n=t.jsPlumbInstance.makeAnchor(["Continuous",{faces:o}],t.elementId,t.jsPlumbInstance);return n.type=e,n}}jsPlumb.Anchors.Continuous=function(t){return t.jsPlumbInstance.continuousAnchorFactory.get(t)},n("ContinuousLeft",["left"]),n("ContinuousTop",["top"]),n("ContinuousBottom",["bottom"]),n("ContinuousRight",["right"]),jsPlumb.Anchors.Assign=t(0,0,0,0,"Assign",function(t,n){var e=n.position||"Fixed";t.positionFinder=e.constructor==String?n.jsPlumbInstance.AnchorPositionFinders[e]:e,t.constructorParams=n}),jsPlumb.AnchorPositionFinders={Fixed:function(t,n,e,o){return[(t.left-n.left)/e[0],(t.top-n.top)/e[1]]},Grid:function(t,n,e,o){var i=t.left-n.left,r=t.top-n.top,s=e[0]/o.grid[0],a=e[1]/o.grid[1],l=Math.floor(i/s),u=Math.floor(r/a);return[(l*s+s/2)/e[0],(u*a+a/2)/e[1]]}},jsPlumb.Anchors.Perimeter=function(t){var c=(t=t||{}).anchorCount||60,n=t.shape;if(!n)throw new Error("no shape supplied to Perimeter Anchor type");function e(){for(var t=2*Math.PI/c,n=0,e=[],o=0;o<c;o++){var i=.5+.5*Math.sin(n),r=.5+.5*Math.cos(n);e.push([i,r,0,0]),n+=t}return e}function s(t){function n(t,n,e,o,i){for(var r=(e-t)/(l=c*i),s=(o-n)/l,a=0;a<l;a++)u.push([t+r*a,n+s*a,0,0])}for(var l=c/t.length,u=[],e=0;e<t.length;e++)n.apply(null,t[e]);return u}function o(t){for(var n=[],e=0;e<t.length;e++)n.push([t[e][0],t[e][1],t[e][2],t[e][3],1/t.length]);return s(n)}function i(){return o([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])}var r={Circle:e,Ellipse:e,Diamond:function(){return o([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:i,Square:i,Triangle:function(){return o([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(t){for(var n=t.points,e=[],o=0,i=0;i<n.length-1;i++){var r=Math.sqrt(Math.pow(n[i][2]-n[i][0])+Math.pow(n[i][3]-n[i][1]));o+=r,e.push([n[i][0],n[i][1],n[i+1][0],n[i+1][1],r])}for(i=0;i<e.length;i++)e[i][4]=e[i][4]/o;return s(e)}};if(!r[n])throw new Error("Shape ["+n+"] is unknown by Perimeter Anchor type");var a=r[n](t);t.rotation&&(a=function(t,n){for(var e=[],o=n/180*Math.PI,i=0;i<t.length;i++){var r=t[i][0]-.5,s=t[i][1]-.5;e.push([r*Math.cos(o)-s*Math.sin(o)+.5,r*Math.sin(o)+s*Math.cos(o)+.5,t[i][2],t[i][3]])}return e}(a,t.rotation));var l=t.jsPlumbInstance.makeDynamicAnchor(a);return l.type="Perimeter",l}}(),function(){var V=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"];jsPlumb.Endpoint=function(f){var v=this,y=f._jsPlumb,m=jsPlumb.CurrentLibrary,c=m.getAttribute,g=m.getElementObject,b=jsPlumbUtil,P=m.getOffset,C=f.newConnection,x=f.newEndpoint,d=f.finaliseConnection,p=f.fireDetachEvent,j=f.floatingConnections;v.idPrefix="_jsplumb_e_",v.defaultLabelLocation=[.5,.5],v.defaultOverlayKeys=["Overlays","EndpointOverlays"],this.parent=f.parent,overlayCapableJsPlumbUIComponent.apply(this,arguments),f=f||{},this.getTypeDescriptor=function(){return"endpoint"},this.getDefaultType=function(){return{parameters:{},scope:null,maxConnections:v._jsPlumb.Defaults.MaxConnections,paintStyle:v._jsPlumb.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,endpoint:v._jsPlumb.Defaults.Endpoint||jsPlumb.Defaults.Endpoint,hoverPaintStyle:v._jsPlumb.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,overlays:v._jsPlumb.Defaults.EndpointOverlays||jsPlumb.Defaults.EndpointOverlays,connectorStyle:f.connectorStyle,connectorHoverStyle:f.connectorHoverStyle,connectorClass:f.connectorClass,connectorHoverClass:f.connectorHoverClass,connectorOverlays:f.connectorOverlays,connector:f.connector,connectorTooltip:f.connectorTooltip}};var e=this.applyType;this.applyType=function(t,n){e(t,n),null!=t.maxConnections&&(h=t.maxConnections),t.scope&&(v.scope=t.scope),b.copyValues(V,t,v)};var r=!0,n=!(!1===f.enabled);this.isVisible=function(){return r},this.setVisible=function(t,n,e){if(r=t,v.canvas&&(v.canvas.style.display=t?"block":"none"),v[t?"showOverlays":"hideOverlays"](),!n)for(var o,i=0;i<v.connections.length;i++){v.connections[i].setVisible(t),e||(o=v===v.connections[i].endpoints[0]?1:0,1==v.connections[i].endpoints[o].connections.length&&v.connections[i].endpoints[o].setVisible(t,!0,!0))}},this.isEnabled=function(){return n},this.setEnabled=function(t){n=t};var E=f.source,t=f.uuid,S=null,D=null;t&&(f.endpointsByUUID[t]=v);var A=c(E,"id");this.elementId=A,this.element=E,v.setElementId=function(t){A=t,v.elementId=t,v.anchor.elementId=t},v.setReferenceElement=function(t){E=t,v.element=t};var o=f.connectionCost;this.getConnectionCost=function(){return o},this.setConnectionCost=function(t){o=t};var i=f.connectionsDirected;this.areConnectionsDirected=function(){return i},this.setConnectionsDirected=function(t){i=t};function s(){m.removeClass(E,y.endpointAnchorClassPrefix+"_"+a),v.removeClass(y.endpointAnchorClassPrefix+"_"+a),a=v.anchor.getCssClass(),v.addClass(y.endpointAnchorClassPrefix+"_"+a),m.addClass(E,y.endpointAnchorClassPrefix+"_"+a)}var a="";this.setAnchor=function(t,n){v.anchor=y.makeAnchor(t,A,y),s(),v.anchor.bind("anchorChanged",function(t){v.fire("anchorChanged",{endpoint:v,anchor:t}),s()}),n||y.repaint(A)},this.cleanup=function(){m.removeClass(E,y.endpointAnchorClassPrefix+"_"+a)};var l=f.anchor?f.anchor:f.anchors?f.anchors:y.Defaults.Anchor||"Top";v.setAnchor(l,!0),f._transient||y.anchorManager.add(v,A);var I=null;this.setEndpoint=function(t){var n={_jsPlumb:v._jsPlumb,cssClass:f.cssClass,parent:f.parent,container:f.container,tooltip:f.tooltip,connectorTooltip:f.connectorTooltip,endpoint:v};I=b.isString(t)?new(jsPlumb.Endpoints[y.getRenderMode()][t])(n):b.isArray(t)?(n=b.merge(t[1],n),new(jsPlumb.Endpoints[y.getRenderMode()][t[0]])(n)):t.clone();var e=jsPlumb.extend({},n);I.clone=function(){var t=new Object;return I.constructor.apply(t,[e]),t},v.endpoint=I,v.type=v.endpoint.type},this.setEndpoint(f.endpoint||y.Defaults.Endpoint||jsPlumb.Defaults.Endpoint||"Dot");var u=v.setHover;v.setHover=function(){v.endpoint.setHover.apply(v.endpoint,arguments),u.apply(v,arguments)};v.bindListeners(v.endpoint,v,function(t){0<v.connections.length?v.connections[0].setHover(t,!1):v.setHover(t)}),this.setPaintStyle(f.paintStyle||f.style||y.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,!0),this.setHoverPaintStyle(f.hoverPaintStyle||y.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,!0),this.paintStyleInUse=this.getPaintStyle();this.getPaintStyle();b.copyValues(V,f,this),this.isSource=f.isSource||!1,this.isTarget=f.isTarget||!1;var h=f.maxConnections||y.Defaults.MaxConnections;this.getAttachedElements=function(){return v.connections},this.canvas=this.endpoint.canvas,v.addClass(y.endpointAnchorClassPrefix+"_"+a),m.addClass(E,y.endpointAnchorClassPrefix+"_"+a),this.connections=f.connections||[],this.connectorPointerEvents=f["connector-pointer-events"],this.scope=f.scope||y.getDefaultScope(),this.timestamp=null,v.reattachConnections=f.reattach||y.Defaults.ReattachConnections,v.connectionsDetachable=y.Defaults.ConnectionsDetachable,!1!==f.connectionsDetachable&&!1!==f.detachable||(v.connectionsDetachable=!1);var w=f.dragAllowedWhenFull||!0;f.onMaxConnections&&v.bind("maxConnections",f.onMaxConnections),this.computeAnchor=function(t){return v.anchor.compute(t)},this.addConnection=function(t){v.connections.push(t),v[(0<v.connections.length?"add":"remove")+"Class"](y.endpointConnectedClass),v[(v.isFull()?"add":"remove")+"Class"](y.endpointFullClass)},this.detach=function(n,t,e,o,i){var r=b.findWithFunction(v.connections,function(t){return t.id==n.id}),s=!1;if(o=!1!==o,0<=r&&(e||n._forceDetach||n.isDetachable()||n.isDetachAllowed(n))){var a=n.endpoints[0]==v?n.endpoints[1]:n.endpoints[0];if(e||n._forceDetach||v.isDetachAllowed(n)){if(v.connections.splice(r,1),!t&&(a.detach(n,!0,e),n.endpointsToDeleteOnDetach))for(var l=0;l<n.endpointsToDeleteOnDetach.length;l++){var u=n.endpointsToDeleteOnDetach[l];u&&0==u.connections.length&&y.deleteEndpoint(u)}b.removeElements(n.getConnector().getDisplayElements(),n.parent),b.removeWithFunction(f.connectionsByScope[n.scope],function(t){return t.id==n.id}),v[(0<v.connections.length?"add":"remove")+"Class"](y.endpointConnectedClass),v[(v.isFull()?"add":"remove")+"Class"](y.endpointFullClass),s=!0,p(n,!t&&o,i)}}return s},this.detachAll=function(t,n){for(;0<v.connections.length;)v.detach(v.connections[0],!1,!0,t,n)},this.detachFrom=function(t,n,e){for(var o=[],i=0;i<v.connections.length;i++)v.connections[i].endpoints[1]!=t&&v.connections[i].endpoints[0]!=t||o.push(v.connections[i]);for(i=0;i<o.length;i++)v.detach(o[i],!1,!0,n,e)&&o[i].setHover(!1,!1)},this.detachFromConnection=function(n){var t=b.findWithFunction(v.connections,function(t){return t.id==n.id});0<=t&&(v.connections.splice(t,1),v[(0<v.connections.length?"add":"remove")+"Class"](y.endpointConnectedClass),v[(v.isFull()?"add":"remove")+"Class"](y.endpointFullClass))},this.getElement=function(){return E},this.setElement=function(t,n){var e=y.getId(t);b.removeWithFunction(f.endpointsByElement[v.elementId],function(t){return t.id==v.id}),E=g(t),A=y.getId(E),v.elementId=A;var o=f.getParentFromParams({source:e,container:n}),i=m.getParent(v.canvas);m.removeElement(v.canvas,i),m.appendElement(v.canvas,o);for(var r=0;r<v.connections.length;r++)v.connections[r].moveParent(o),v.connections[r].sourceId=A,v.connections[r].source=E;b.addToList(f.endpointsByElement,e,v)},this.getUuid=function(){return t},v.makeInPlaceCopy=function(){var t=v.anchor.getCurrentLocation(v),n=v.anchor.getOrientation(v),e=v.anchor.getCssClass();return x({anchor:{bind:function(){},compute:function(){return[t[0],t[1]]},getCurrentLocation:function(){return[t[0],t[1]]},getOrientation:function(){return n},getCssClass:function(){return e}},source:E,paintStyle:this.getPaintStyle(),endpoint:f.hideOnDrag?"Blank":I,_transient:!0,scope:v.scope})},this.isConnectedTo=function(t){var n=!1;if(t)for(var e=0;e<v.connections.length;e++)if(v.connections[e].endpoints[1]==t){n=!0;break}return n},this.isFloating=function(){return null!=S},this.connectorSelector=function(){var t=v.connections[0];return(!v.isTarget||!t)&&(v.connections.length<h||-1==h)?null:t},this.isFull=function(){return!(v.isFloating()||h<1||v.connections.length<h)},this.setDragAllowedWhenFull=function(t){w=t},this.setStyle=v.setPaintStyle,this.equals=function(t){return this.anchor.equals(t.anchor)};var O,L,M,_,k,T,U,F,X,Y,H,W,N,R;this.paint=function(t){var n=(t=t||{}).timestamp,e=!(!1===t.recalc);if(!n||v.timestamp!==n){var o=y.updateOffset({elId:A,timestamp:n,recalc:e}),i=t.offset?t.offset.o:o.o;if(i){var r,s,a,l,u,c,d,p,h=t.anchorPoint,f=t.connectorPaintStyle;null==h&&(r=t.dimensions||o.s,null!=i&&null!=r||(i=(o=y.updateOffset({elId:A,timestamp:n})).o,r=o.s),s={xy:[i.left,i.top],wh:r,element:v,timestamp:n},e&&v.anchor.isDynamic&&0<v.connections.length&&(u=0==(l=(a=function(t){var n=0;if(null!=t)for(var e=0;e<v.connections.length;e++)if(v.connections[e].sourceId==t||v.connections[e].targetId==t){n=e;break}return v.connections[n]}(t.elementWithPrecedence)).endpoints[0]==v?1:0)?a.sourceId:a.targetId,d=(c=y.getCachedData(u)).o,p=c.s,s.txy=[d.left,d.top],s.twh=p,s.tElement=a.endpoints[l]),h=v.anchor.compute(s)),I.compute(h,v.anchor.getOrientation(v),v.paintStyleInUse,f||v.paintStyleInUse),I.paint(v.paintStyleInUse,v.anchor),v.timestamp=n;for(var m=0;m<v.overlays.length;m++){var g=v.overlays[m];g.isVisible()&&(v.overlayPlacements[m]=g.draw(v.endpoint,v.paintStyleInUse),g.paint(v.overlayPlacements[m]))}}}},this.repaint=this.paint,m.isDragSupported(E)&&(_=L=null,W=O={id:null,element:null},N=y,R=M=!1,k={drag:function(){if(R)return!(R=!1);var t=jsPlumb.CurrentLibrary.getUIPosition(arguments,N.getZoom());W.element&&(jsPlumb.CurrentLibrary.setOffset(W.element,t),N.repaint(W.element,t))},stopDrag:function(){R=!0}},Y=f.dragOptions||{},T=jsPlumb.extend({},m.defaultDragOptions),U=m.dragEvents.start,F=m.dragEvents.stop,X=m.dragEvents.drag,(Y=jsPlumb.extend(T,Y)).scope=Y.scope||v.scope,Y[U]=y.wrap(Y[U],function(){L=v.connectorSelector();var t=!0;if(v.isEnabled()||(t=!1),null!=L||f.isSource||(t=!1),f.isSource&&v.isFull()&&!w&&(t=!1),null==L||L.isDetachable()||(t=!1),!1===t)return m.stopDrag&&m.stopDrag(),k.stopDrag(),!1;v.addClass("endpointDrag"),L&&!v.isFull()&&f.isSource&&(L=null),y.updateOffset({elId:A}),(D=v.makeInPlaceCopy()).referenceEndpoint=v,D.paint(),function(t,n,e){var o=document.createElement("div");o.style.position="absolute";var i=jsPlumb.CurrentLibrary.getElementObject(o);jsPlumb.CurrentLibrary.appendElement(o,n);var r=e.getId(i);e.updateOffset({elId:r}),t.id=r,t.element=i}(O,v.parent,y);var n,e,o,i,r,s,a,l,u,c=g(D.canvas),d=P(c,y),p=y.adjustForParentOffsetAndScroll([d.left,d.top],D.canvas),h=g(v.canvas);m.setOffset(O.element,{left:p[0],top:p[1]}),v.parentAnchor&&(v.anchor=y.makeAnchor(v.parentAnchor,v.elementId,y)),m.setAttribute(h,"dragId",O.id),m.setAttribute(h,"elId",A),n=v.getPaintStyle(),e=v.anchor,o=I,i=v.canvas,r=O.element,s=y,S=x({paintStyle:n,endpoint:o,anchor:new jsPlumb.FloatingAnchor({reference:e,referenceCanvas:i,jsPlumbInstance:s}),source:r,scope:"__floating"}),v.canvas.style.visibility="hidden",null==L?(v.anchor.locked=!0,v.setHover(!1,!1),(L=C({sourceEndpoint:v,targetEndpoint:S,source:v.endpointWillMoveTo||E,target:O.element,anchors:[v.anchor,S.anchor],paintStyle:f.connectorStyle,hoverPaintStyle:f.connectorHoverStyle,connector:f.connector,overlays:f.connectorOverlays,type:v.connectionType,cssClass:v.connectorClass,hoverClass:v.connectorHoverClass})).addClass(y.draggingClass)):(M=!0,L.setHover(!1),B(c,!1,!0),a=L.endpoints[0].id==v.id?0:1,L.floatingAnchorIndex=a,v.detachFromConnection(L),l=jsPlumb.CurrentLibrary.getDragScope(h),m.setAttribute(h,"originalScope",l),u=m.getDropScope(h),m.setDragScope(h,u),0==a?(_=[L.source,L.sourceId,H,l],L.source=O.element,L.sourceId=O.id):(_=[L.target,L.targetId,H,l],L.target=O.element,L.targetId=O.id),L.endpoints[0==a?1:0].anchor.locked=!0,L.suspendedEndpoint=L.endpoints[a],L.suspendedEndpoint.setHover(!1),S.referenceEndpoint=L.suspendedEndpoint,L.endpoints[a]=S,L.addClass(y.draggingClass)),S.addClass(y.draggingClass),y.fire("connectionDrag",L),j[O.id]=L,y.anchorManager.addFloatingConnection(O.id,L),S.addConnection(L),b.addToList(f.endpointsByElement,O.id,S),y.currentlyDragging=!0}),Y[X]=y.wrap(Y[X],k.drag),Y[F]=y.wrap(Y[F],function(){var t=m.getDropEvent(arguments);b.removeWithFunction(f.endpointsByElement[O.id],function(t){return t.id==S.id}),b.removeElement(D.canvas,E),y.anchorManager.clearFor(O.id);var n=null==L.floatingAnchorIndex?1:L.floatingAnchorIndex;L.endpoints[0==n?1:0].anchor.locked=!1,L.endpoints[n]==S&&(M&&L.suspendedEndpoint?(0==n?(L.source=_[0],L.sourceId=_[1]):(L.target=_[0],L.targetId=_[1]),m.setDragScope(_[2],_[3]),L.endpoints[n]=L.suspendedEndpoint,(L.isReattach()||L._forceReattach||L._forceDetach||!L.endpoints[0==n?1:0].detach(L,!1,!1,!0,t))&&(L.setHover(!1),L.floatingAnchorIndex=null,L.suspendedEndpoint.addConnection(L),y.repaint(_[1])),L._forceDetach=null,L._forceReattach=null):(b.removeElements(L.getConnector().getDisplayElements(),v.parent),v.detachFromConnection(L))),b.removeElements([O.element[0],S.canvas],E),y.dragManager.elementRemoved(S.elementId),v.canvas.style.visibility="visible",v.anchor.locked=!1,v.paint({recalc:!1}),L.removeClass(y.draggingClass),S.removeClass(y.draggingClass),y.fire("connectionDragStop",L),D=L=null,delete f.endpointsByElement[S.elementId],S.anchor=null,S=null,y.currentlyDragging=!1}),H=g(v.canvas),m.initDraggable(H,Y,!0,y));var B=function(t,n,e,u){var o,i,r,s;(f.isTarget||n)&&m.isDropSupported(E)&&(o=f.dropOptions||y.Defaults.DropOptions||jsPlumb.Defaults.DropOptions,(o=jsPlumb.extend({},o)).scope=o.scope||v.scope,i=m.dragEvents.drop,r=m.dragEvents.over,s=m.dragEvents.out,o[i]=y.wrap(o[i],function(){v.removeClass(y.endpointDropAllowedClass),v.removeClass(y.endpointDropForbiddenClass);var i,t,r,n,s=m.getDropEvent(arguments),e=g(m.getDragObject(arguments)),o=c(e,"dragId"),a=(c(e,"elId"),c(e,"originalScope")),l=j[o];l.suspendedEndpoint&&(l.suspendedEndpoint.id==v.id||v.referenceEndpoint&&l.suspendedEndpoint.id==v.referenceEndpoint.id)?l._forceReattach=!0:null!=l&&(i=null==l.floatingAnchorIndex?1:l.floatingAnchorIndex,a&&jsPlumb.CurrentLibrary.setDragScope(e,a),t=null==u||u.isEnabled(),v.isFull()&&v.fire("maxConnections",{endpoint:v,connection:l,maxConnections:h},s),v.isFull()||0==i&&!v.isSource||1==i&&!v.isTarget||!t||(n=!0,l.suspendedEndpoint&&l.suspendedEndpoint.id!=v.id&&(0==i?(l.source=l.suspendedEndpoint.element,l.sourceId=l.suspendedEndpoint.elementId):(l.target=l.suspendedEndpoint.element,l.targetId=l.suspendedEndpoint.elementId),l.isDetachAllowed(l)&&l.endpoints[i].isDetachAllowed(l)&&l.suspendedEndpoint.isDetachAllowed(l)&&y.checkCondition("beforeDetach",l)||(n=!1)),0==i?(l.source=v.element,l.sourceId=v.elementId):(l.target=v.element,l.targetId=v.elementId),r=function(){l.floatingAnchorIndex=null},(n=n&&v.isDropAllowed(l.sourceId,l.targetId,l.scope,l,v))?function(){l.endpoints[i].detachFromConnection(l),l.suspendedEndpoint&&l.suspendedEndpoint.detachFromConnection(l),(l.endpoints[i]=v).addConnection(l);var t,n,e=v.getParameters();for(var o in e)l.setParameter(o,e[o]);l.suspendedEndpoint?(t=l.suspendedEndpoint.getElement(),n=l.suspendedEndpoint.elementId,p({source:0==i?t:l.source,target:1==i?t:l.target,sourceId:0==i?n:l.sourceId,targetId:1==i?n:l.targetId,sourceEndpoint:0==i?l.suspendedEndpoint:l.endpoints[0],targetEndpoint:1==i?l.suspendedEndpoint:l.endpoints[1],connection:l},!0,s)):e.draggable&&jsPlumb.CurrentLibrary.initDraggable(v.element,Y,!0,y),d(l,null,s),r()}():(l.suspendedEndpoint&&(l.endpoints[i]=l.suspendedEndpoint,l.setHover(!1),l._forceDetach=!0,0==i?(l.source=l.suspendedEndpoint.element,l.sourceId=l.suspendedEndpoint.elementId):(l.target=l.suspendedEndpoint.element,l.targetId=l.suspendedEndpoint.elementId),l.suspendedEndpoint.addConnection(l),l.endpoints[0].repaint(),l.repaint(),y.repaint(l.sourceId),l._forceDetach=!1),r())),y.currentlyDragging=!1,delete j[o],y.anchorManager.removeFloatingConnection(o))}),o[r]=y.wrap(o[r],function(){var t,n,e=m.getDragObject(arguments),o=c(g(e),"dragId"),i=j[o];null!=i&&(t=null==i.floatingAnchorIndex?1:i.floatingAnchorIndex,(v.isTarget&&0!=i.floatingAnchorIndex||i.suspendedEndpoint&&v.referenceEndpoint&&v.referenceEndpoint.id==i.suspendedEndpoint.id)&&(n=y.checkCondition("checkDropAllowed",{sourceEndpoint:i.endpoints[t],targetEndpoint:v,connection:i}),v[(n?"add":"remove")+"Class"](y.endpointDropAllowedClass),v[(n?"remove":"add")+"Class"](y.endpointDropForbiddenClass),i.endpoints[t].anchor.over(v.anchor)))}),o[s]=y.wrap(o[s],function(){var t,n=m.getDragObject(arguments),e=c(g(n),"dragId"),o=j[e];null!=o&&(t=null==o.floatingAnchorIndex?1:o.floatingAnchorIndex,(v.isTarget&&0!=o.floatingAnchorIndex||o.suspendedEndpoint&&v.referenceEndpoint&&v.referenceEndpoint.id==o.suspendedEndpoint.id)&&(v.removeClass(y.endpointDropAllowedClass),v.removeClass(y.endpointDropForbiddenClass),o.endpoints[t].anchor.out()))}),m.initDroppable(t,o,!0,e))};return B(g(v.canvas),!0,!(f._transient||v.anchor.isFloating),v),f.type&&v.addType(f.type,f.data,y.isSuspendDrawing()),v}}(),jsPlumb.Connection=function(i){var r,n,y=this,b=!0,P=i._jsPlumb,t=jsPlumb.CurrentLibrary,e=t.getAttribute,o=t.getElementObject,s=jsPlumbUtil,h=(t.getOffset,i.newConnection,i.newEndpoint),C=null;y.idPrefix="_jsplumb_c_",y.defaultLabelLocation=.5,y.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.parent=i.parent,overlayCapableJsPlumbUIComponent.apply(this,arguments),this.isVisible=function(){return b},this.setVisible=function(t){y[(b=t)?"showOverlays":"hideOverlays"](),C&&C.canvas&&(C.canvas.style.display=t?"block":"none"),y.repaint()};var a=!0===i.editable;this.setEditable=function(t){return C&&C.isEditable()&&(a=t),a},this.isEditable=function(){return a},this.editStarted=function(){y.fire("editStarted",{path:C.getPath()}),P.setHoverSuspended(!0)},this.editCompleted=function(){y.fire("editCompleted",{path:C.getPath()}),y.setHover(!1),P.setHoverSuspended(!1)},this.editCanceled=function(){y.fire("editCanceled",{path:C.getPath()}),y.setHover(!1),P.setHoverSuspended(!1)};var l=this.addClass,u=this.removeClass;this.addClass=function(t,n){l(t),n&&(y.endpoints[0].addClass(t),y.endpoints[1].addClass(t))},this.removeClass=function(t,n){u(t),n&&(y.endpoints[0].removeClass(t),y.endpoints[1].removeClass(t))},this.getTypeDescriptor=function(){return"connection"},this.getDefaultType=function(){return{parameters:{},scope:null,detachable:y._jsPlumb.Defaults.ConnectionsDetachable,rettach:y._jsPlumb.Defaults.ReattachConnections,paintStyle:y._jsPlumb.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,connector:y._jsPlumb.Defaults.Connector||jsPlumb.Defaults.Connector,hoverPaintStyle:y._jsPlumb.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,overlays:y._jsPlumb.Defaults.ConnectorOverlays||jsPlumb.Defaults.ConnectorOverlays}};var c=this.applyType;this.applyType=function(t,n){c(t,n),null!=t.detachable&&y.setDetachable(t.detachable),null!=t.reattach&&y.setReattach(t.reattach),t.scope&&(y.scope=t.scope),a=t.editable,y.setConnector(t.connector,n)},n=y.setHover,y.setHover=function(t){C.setHover.apply(C,arguments),n.apply(y,arguments)},r=function(t){P.isConnectionBeingDragged()||y.setHover(t,!1)};function d(t,n,e){var o=new Object;return jsPlumb.Connectors[n].apply(o,[e]),jsPlumb.ConnectorRenderers[t].apply(o,[e]),o}this.setConnector=function(t,n){null!=C&&s.removeElements(C.getDisplayElements());var e={_jsPlumb:y._jsPlumb,parent:i.parent,cssClass:i.cssClass,container:i.container,tooltip:y.tooltip,"pointer-events":i["pointer-events"]},o=P.getRenderMode();s.isString(t)?C=d(o,t,e):s.isArray(t)&&(C=1==t.length?d(o,t[0],e):d(o,t[0],s.merge(t[1],e))),y.bindListeners(C,y,r),y.canvas=C.canvas,a&&null!=jsPlumb.ConnectorEditors&&jsPlumb.ConnectorEditors[C.type]&&C.isEditable()?new jsPlumb.ConnectorEditors[C.type]({connector:C,connection:y,params:i.editorParams||{}}):a=!1,n||y.repaint()},this.getConnector=function(){return C},this.source=o(i.source),this.target=o(i.target),i.sourceEndpoint&&(this.source=i.sourceEndpoint.endpointWillMoveTo||i.sourceEndpoint.getElement()),i.targetEndpoint&&(this.target=i.targetEndpoint.getElement()),y.previousConnection=i.previousConnection,this.sourceId=e(this.source,"id"),this.targetId=e(this.target,"id"),this.scope=i.scope,this.endpoints=[],this.endpointStyles=[];function f(t,n){return t?P.makeAnchor(t,n,P):null}function p(t,n,e,o,i,r,s){var a,l,u,c,d,p;return t?(y.endpoints[n]=t).addConnection(y):(e.endpoints||(e.endpoints=[null,null]),a=e.endpoints[n]||e.endpoint||P.Defaults.Endpoints[n]||jsPlumb.Defaults.Endpoints[n]||P.Defaults.Endpoint||jsPlumb.Defaults.Endpoint,e.endpointStyles||(e.endpointStyles=[null,null]),e.endpointHoverStyles||(e.endpointHoverStyles=[null,null]),null==(l=e.endpointStyles[n]||e.endpointStyle||P.Defaults.EndpointStyles[n]||jsPlumb.Defaults.EndpointStyles[n]||P.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle).fillStyle&&null!=r&&(l.fillStyle=r.strokeStyle),null==l.outlineColor&&null!=r&&(l.outlineColor=r.outlineColor),null==l.outlineWidth&&null!=r&&(l.outlineWidth=r.outlineWidth),u=e.endpointHoverStyles[n]||e.endpointHoverStyle||P.Defaults.EndpointHoverStyles[n]||jsPlumb.Defaults.EndpointHoverStyles[n]||P.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,null!=s&&(null==u&&(u={}),null==u.fillStyle&&(u.fillStyle=s.strokeStyle)),c=e.anchors?e.anchors[n]:e.anchor?e.anchor:f(P.Defaults.Anchors[n],i)||f(jsPlumb.Defaults.Anchors[n],i)||f(P.Defaults.Anchor,i)||f(jsPlumb.Defaults.Anchor,i),d=e.uuids?e.uuids[n]:null,p=h({paintStyle:l,hoverPaintStyle:u,endpoint:a,connections:[y],uuid:d,anchor:c,source:o,scope:e.scope,container:e.container,reattach:e.reattach||P.Defaults.ReattachConnections,detachable:e.detachable||P.Defaults.ConnectionsDetachable}),y.endpoints[n]=p,!1===e.drawEndpoints&&p.setVisible(!1,!0,!0)),p}var m=p(i.sourceEndpoint,0,i,y.source,y.sourceId,i.paintStyle,i.hoverPaintStyle);m&&s.addToList(i.endpointsByElement,this.sourceId,m);var g=p(i.targetEndpoint,1,i,y.target,y.targetId,i.paintStyle,i.hoverPaintStyle);g&&s.addToList(i.endpointsByElement,this.targetId,g),this.scope||(this.scope=this.endpoints[0].scope),y.endpointsToDeleteOnDetach=[null,null],i.deleteEndpointsOnDetach&&(i.sourceIsNew&&(y.endpointsToDeleteOnDetach[0]=y.endpoints[0]),i.targetIsNew&&(y.endpointsToDeleteOnDetach[1]=y.endpoints[1])),i.endpointsToDeleteOnDetach&&(y.endpointsToDeleteOnDetach=i.endpointsToDeleteOnDetach),y.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||i.connector||P.Defaults.Connector||jsPlumb.Defaults.Connector,!0),i.path&&C.setPath(i.path),this.setPaintStyle(this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||i.paintStyle||P.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,!0),this.setHoverPaintStyle(this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||i.hoverPaintStyle||P.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,!0),this.paintStyleInUse=this.getPaintStyle();var v=P.getSuspendedAt();P.updateOffset({elId:this.sourceId,timestamp:v}),P.updateOffset({elId:this.targetId,timestamp:v});var x=P.getCachedData(this.sourceId),j=x.o,E=x.s,S=P.getCachedData(this.targetId),D=S.o,A=S.s,I=v||P.timestamp(),w=this.endpoints[0].anchor.compute({xy:[j.left,j.top],wh:E,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[D.left,D.top],twh:A,tElement:this.endpoints[1],timestamp:I});this.endpoints[0].paint({anchorLoc:w,timestamp:I}),w=this.endpoints[1].anchor.compute({xy:[D.left,D.top],wh:A,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[j.left,j.top],twh:E,tElement:this.endpoints[0],timestamp:I}),this.endpoints[1].paint({anchorLoc:w,timestamp:I});var O=P.Defaults.ConnectionsDetachable;!1===i.detachable&&(O=!1),!1===y.endpoints[0].connectionsDetachable&&(O=!1),!1===y.endpoints[1].connectionsDetachable&&(O=!1),this.isDetachable=function(){return!0===O},this.setDetachable=function(t){O=!0===t};var L=i.reattach||y.endpoints[0].reattachConnections||y.endpoints[1].reattachConnections||P.Defaults.ReattachConnections;this.isReattach=function(){return!0===L},this.setReattach=function(t){L=!0===t};var M=i.cost||y.endpoints[0].getConnectionCost();y.getCost=function(){return M},y.setCost=function(t){M=t};var _=i.directed;null==i.directed&&(_=y.endpoints[0].areConnectionsDirected()),y.isDirected=function(){return!0===_};var k=jsPlumb.extend({},this.endpoints[0].getParameters());jsPlumb.extend(k,this.endpoints[1].getParameters()),jsPlumb.extend(k,y.getParameters()),y.setParameters(k),this.getAttachedElements=function(){return y.endpoints},this.moveParent=function(t){var n=jsPlumb.CurrentLibrary;n.getParent(C.canvas);C.bgCanvas&&(n.removeElement(C.bgCanvas),n.appendElement(C.bgCanvas,t)),n.removeElement(C.canvas),n.appendElement(C.canvas,t);for(var e=0;e<y.overlays.length;e++)y.overlays[e].isAppendedAtTopLevel&&(n.removeElement(y.overlays[e].canvas),n.appendElement(y.overlays[e].canvas,t),y.overlays[e].reattachListeners&&y.overlays[e].reattachListeners(C));C.reattachListeners&&C.reattachListeners()};var T=null;this.paint=function(t){if(b){var n=(t=t||{}).elId,e=t.ui,o=t.recalc,i=t.timestamp,r=this.targetId;this.sourceId;if(null==i||i!=T){var s=P.updateOffset({elId:n,offset:e,recalc:o,timestamp:i}).o,a=P.updateOffset({elId:r,timestamp:i}).o,l=this.endpoints[0],u=this.endpoints[1];t.clearEdits&&(l.anchor.clearUserDefinedLocation(),u.anchor.clearUserDefinedLocation(),C.setEdited(!1));var c=l.anchor.getCurrentLocation(l),d=u.anchor.getCurrentLocation(u);C.resetBounds(),C.compute({sourcePos:c,targetPos:d,sourceEndpoint:this.endpoints[0],targetEndpoint:this.endpoints[1],lineWidth:y.paintStyleInUse.lineWidth,sourceInfo:s,targetInfo:a,clearEdits:!0===t.clearEdits});for(var p={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},h=0;h<y.overlays.length;h++){(v=y.overlays[h]).isVisible()&&(y.overlayPlacements[h]=v.draw(C,y.paintStyleInUse),p.minX=Math.min(p.minX,y.overlayPlacements[h].minX),p.maxX=Math.max(p.maxX,y.overlayPlacements[h].maxX),p.minY=Math.min(p.minY,y.overlayPlacements[h].minY),p.maxY=Math.max(p.maxY,y.overlayPlacements[h].maxY))}var f=(y.paintStyleInUse.lineWidth||1)/2,m=y.paintStyleInUse.lineWidth||0,g={xmin:Math.min(C.bounds.minX-(f+m),p.minX),ymin:Math.min(C.bounds.minY-(f+m),p.minY),xmax:Math.max(C.bounds.maxX+(f+m),p.maxX),ymax:Math.max(C.bounds.maxY+(f+m),p.maxY)};C.paint(y.paintStyleInUse,null,g);for(var v,h=0;h<y.overlays.length;h++){(v=y.overlays[h]).isVisible()&&v.paint(y.overlayPlacements[h],g)}}T=i}},this.repaint=function(t){var n=!(!1===(t=t||{}).recalc);this.paint({elId:this.sourceId,recalc:n,timestamp:t.timestamp,clearEdits:t.clearEdits})};var U=i.type||y.endpoints[0].connectionType||y.endpoints[1].connectionType;U&&y.addType(U,i.data,P.isSuspendDrawing())},function(){jsPlumb.DOMElementComponent=function(t){jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.mousemove=this.dblclick=this.click=this.mousedown=this.mouseup=function(t){}},jsPlumb.Segments={AbstractSegment:function(t){this.params=t,this.findClosestPointOnPath=function(t,n){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(t.x1,t.x2),minY:Math.min(t.y1,t.y2),maxX:Math.max(t.x1,t.x2),maxY:Math.max(t.y1,t.y2)}}},Straight:function(t){var r,s,a,l,u,c,d,p=this;jsPlumb.Segments.AbstractSegment.apply(this,arguments);this.type="Straight",p.getLength=function(){return r},p.getGradient=function(){return s},this.getCoordinates=function(){return{x1:l,y1:c,x2:u,y2:d}},this.setCoordinates=function(t){l=t.x1,c=t.y1,u=t.x2,d=t.y2,r=Math.sqrt(Math.pow(u-l,2)+Math.pow(d-c,2)),s=jsPlumbUtil.gradient({x:l,y:c},{x:u,y:d}),a=-1/s},this.setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),this.getBounds=function(){return{minX:Math.min(l,u),minY:Math.min(c,d),maxX:Math.max(l,u),maxY:Math.max(c,d)}},this.pointOnPath=function(t,n){if(0!=t||n){if(1!=t||n){var e=n?0<t?t:r+t:t*r;return jsPlumbUtil.pointOnLine({x:l,y:c},{x:u,y:d},e)}return{x:u,y:d}}return{x:l,y:c}},this.gradientAtPoint=function(t){return s},this.pointAlongPathFrom=function(t,n,e){var o=p.pointOnPath(t,e),i=1==t?{x:l+10*(u-l),y:c+10*(c-d)}:n<=0?{x:l,y:c}:{x:u,y:d};return n<=0&&1<Math.abs(n)&&(n*=-1),jsPlumbUtil.pointOnLine(o,i,n)},this.findClosestPointOnPath=function(t,n){if(0==s)return{x:t,y:c,d:Math.abs(n-c)};if(s==1/0||s==-1/0)return{x:l,y:n,d:Math.abs(t-1)};var e=c-s*l,o=(n-a*t-e)/(s-a),i=s*o+e;return{d:jsPlumbUtil.lineLength([t,n],[o,i]),x:o,y:i,l:jsPlumbUtil.lineLength([o,i],[l,c])/r}}},Arc:function(a){function t(t,n){return jsPlumbUtil.theta([a.cx,a.cy],[t,n])}var l=this,r=(jsPlumb.Segments.AbstractSegment.apply(this,arguments),2*Math.PI);this.radius=a.r,this.anticlockwise=a.ac,this.type="Arc",a.startAngle&&a.endAngle?(this.startAngle=a.startAngle,this.endAngle=a.endAngle,this.x1=a.cx+l.radius*Math.cos(a.startAngle),this.y1=a.cy+l.radius*Math.sin(a.startAngle),this.x2=a.cx+l.radius*Math.cos(a.endAngle),this.y2=a.cy+l.radius*Math.sin(a.endAngle)):(this.startAngle=t(a.x1,a.y1),this.endAngle=t(a.x2,a.y2),this.x1=a.x1,this.y1=a.y1,this.x2=a.x2,this.y2=a.y2),this.endAngle<0&&(this.endAngle+=r),this.startAngle<0&&(this.startAngle+=r),this.segment=jsPlumbUtil.segment([this.x1,this.y1],[this.x2,this.y2]);var n=l.endAngle<l.startAngle?l.endAngle+r:l.endAngle;l.sweep=Math.abs(n-l.startAngle),l.anticlockwise&&(l.sweep=r-l.sweep);var u=2*Math.PI*l.radius,e=l.sweep/r,s=u*e;this.getLength=function(){return s},this.getBounds=function(){return{minX:a.cx-a.r,maxX:a.cx+a.r,minY:a.cy-a.r,maxY:a.cy+a.r}};function c(t){var n=Math.floor(t),e=Math.ceil(t);return t-n<1e-10?n:e-t<1e-10?e:t}this.pointOnPath=function(t,n){if(0==t)return{x:l.x1,y:l.y1,theta:l.startAngle};if(1==t)return{x:l.x2,y:l.y2,theta:l.endAngle};n&&(t/=s);var e=function(t){if(l.anticlockwise){var n=l.startAngle<l.endAngle?l.startAngle+r:l.startAngle;return n-(o=Math.abs(n-l.endAngle))*t}var e=l.endAngle<l.startAngle?l.endAngle+r:l.endAngle,o=Math.abs(e-l.startAngle);return l.startAngle+o*t}(t),o=a.cx+a.r*Math.cos(e),i=a.cy+a.r*Math.sin(e);return{x:c(o),y:c(i),theta:e}},this.gradientAtPoint=function(t,n){var e=l.pointOnPath(t,n),o=jsPlumbUtil.normal([a.cx,a.cy],[e.x,e.y]);return l.anticlockwise||o!=1/0&&o!=-1/0||(o*=-1),o},this.pointAlongPathFrom=function(t,n,e){var o=l.pointOnPath(t,e),i=n/u*2*Math.PI,r=l.anticlockwise?-1:1,s=o.theta+r*i;return{x:a.cx+l.radius*Math.cos(s),y:a.cy+l.radius*Math.sin(s)}}},Bezier:function(t){jsPlumb.Segments.AbstractSegment.apply(this,arguments);var o=[{x:t.x1,y:t.y1},{x:t.cp1x,y:t.cp1y},{x:t.cp2x,y:t.cp2y},{x:t.x2,y:t.y2}],n={minX:Math.min(t.x1,t.x2,t.cp1x,t.cp2x),minY:Math.min(t.y1,t.y2,t.cp1y,t.cp2y),maxX:Math.max(t.x1,t.x2,t.cp1x,t.cp2x),maxY:Math.max(t.y1,t.y2,t.cp1y,t.cp2y)};this.type="Bezier";function i(t,n,e){return e&&(n=jsBezier.locationAlongCurveFrom(t,0<n?0:1,n)),n}this.pointOnPath=function(t,n){return t=i(o,t,n),jsBezier.pointOnCurve(o,t)},this.gradientAtPoint=function(t,n){return t=i(o,t,n),jsBezier.gradientAtPoint(o,t)},this.pointAlongPathFrom=function(t,n,e){return t=i(o,t,e),jsBezier.pointAlongCurveFrom(o,t,n)},this.getLength=function(){return jsBezier.getLength(o)},this.getBounds=function(){return n}}};function p(){var t=this;t.resetBounds=function(){t.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},t.resetBounds()}jsPlumb.Connectors.AbstractConnector=function(t){p.apply(this,arguments);var b=this,r=[],s=0,a=[],l=[],n=t.stub||0,P=jsPlumbUtil.isArray(n)?n[0]:n,C=jsPlumbUtil.isArray(n)?n[1]:n,e=t.gap||0,x=jsPlumbUtil.isArray(e)?e[0]:e,j=jsPlumbUtil.isArray(e)?e[1]:e,o=null,i=!1,u=null;this.isEditable=function(){return!1},this.setEdited=function(t){i=t},this.getPath=function(){},this.setPath=function(t){},this.findSegmentForPoint=function(t,n){for(var e={d:1/0,s:null,x:null,y:null,l:null},o=0;o<r.length;o++){var i=r[o].findClosestPointOnPath(t,n);i.d<e.d&&(e.d=i.d,e.l=i.l,e.x=i.x,e.y=i.y,e.s=r[o])}return e};function c(t,n){n&&(t=0<t?t/s:(s+t)/s);for(var e=a.length-1,o=1,i=0;i<a.length;i++)if(a[i][1]>=t){e=i,o=1==t?1:0==t?0:(t-a[i][0])/l[i];break}return{segment:r[e],proportion:o,index:e}}this.setSegments=function(t){o=[];for(var n=s=0;n<t.length;n++)o.push(t[n]),s+=t[n].getLength()};function d(t){b.lineWidth=t.lineWidth;var n,e,o=jsPlumbUtil.segment(t.sourcePos,t.targetPos),i=t.targetPos[0]<t.sourcePos[0],r=t.targetPos[1]<t.sourcePos[1],s=t.lineWidth||1,a=t.sourceEndpoint.anchor.orientation||t.sourceEndpoint.anchor.getOrientation(t.sourceEndpoint),l=t.targetEndpoint.anchor.orientation||t.targetEndpoint.anchor.getOrientation(t.targetEndpoint),u=i?t.targetPos[0]:t.sourcePos[0],c=r?t.targetPos[1]:t.sourcePos[1],d=Math.abs(t.targetPos[0]-t.sourcePos[0]),p=Math.abs(t.targetPos[1]-t.sourcePos[1]);(0==a[0]&&0==a[1]||0==l[0]&&0==l[1])&&(e=[1,0][n=p<d?0:1],l=[],(a=[])[n]=t.sourcePos[n]>t.targetPos[n]?-1:1,l[n]=t.sourcePos[n]>t.targetPos[n]?1:-1,a[e]=0,l[e]=0);var h=i?d+x*a[0]:x*a[0],f=r?p+x*a[1]:x*a[1],m=i?j*l[0]:d+j*l[0],g=r?j*l[1]:p+j*l[1],v=a[0]*l[0]+a[1]*l[1],y={sx:h,sy:f,tx:m,ty:g,lw:s,xSpan:Math.abs(m-h),ySpan:Math.abs(g-f),mx:(h+m)/2,my:(f+g)/2,so:a,to:l,x:u,y:c,w:d,h:p,segment:o,startStubX:h+a[0]*P,startStubY:f+a[1]*P,endStubX:m+l[0]*C,endStubY:g+l[1]*C,isXGreaterThanStubTimes2:Math.abs(h-m)>P+C,isYGreaterThanStubTimes2:Math.abs(f-g)>P+C,opposite:-1==v,perpendicular:0==v,orthogonal:1==v,sourceAxis:0==a[0]?"y":"x",points:[u,c,d,p,h,f,m,g]};return y.anchorOrientation=y.opposite?"opposite":y.orthogonal?"orthogonal":"perpendicular",y}this.getSegments=function(){return r},b.updateBounds=function(t){var n=t.getBounds();b.bounds.minX=Math.min(b.bounds.minX,n.minX),b.bounds.maxX=Math.max(b.bounds.maxX,n.maxX),b.bounds.minY=Math.min(b.bounds.minY,n.minY),b.bounds.maxY=Math.max(b.bounds.maxY,n.maxY)};return this.pointOnPath=function(t,n){var e=c(t,n);return e.segment.pointOnPath(e.proportion,n)},this.gradientAtPoint=function(t){var n=c(t,absolute);return n.segment.gradientAtPoint(n.proportion,absolute)},this.pointAlongPathFrom=function(t,n,e){var o=c(t,e);return o.segment.pointAlongPathFrom(o.proportion,n,e)},this.compute=function(t){i||(u=d(t)),s=0,r.splice(0,r.length),a.splice(0,a.length),l.splice(0,l.length),this._compute(u,t),b.x=u.points[0],b.y=u.points[1],b.w=u.points[2],b.h=u.points[3],b.segment=u.segment,function(){for(var t=0,n=0;n<r.length;n++){var e=r[n].getLength();l[n]=e/s,a[n]=[t,t+=e/s]}}()},{addSegment:function(t,n){var e=new jsPlumb.Segments[t](n);r.push(e),s+=e.getLength(),b.updateBounds(e)},prepareCompute:d,sourceStub:P,targetStub:C,maxStub:Math.max(P,C),sourceGap:x,targetGap:j,maxGap:Math.max(x,j)}},jsPlumb.Connectors.Straight=function(){this.type="Straight";var e=jsPlumb.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(t,n){e.addSegment("Straight",{x1:t.sx,y1:t.sy,x2:t.startStubX,y2:t.startStubY}),e.addSegment("Straight",{x1:t.startStubX,y1:t.startStubY,x2:t.endStubX,y2:t.endStubY}),e.addSegment("Straight",{x1:t.endStubX,y1:t.endStubY,x2:t.tx,y2:t.ty})}},jsPlumb.Connectors.Bezier=function(t){t=t||{};var p=this,h=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),l=(t.stub,t.curviness||150);this.type="Bezier",this.getCurviness=function(){return l},this._findControlPoint=function(t,n,e,o,i){var r=o.anchor.getOrientation(o),s=i.anchor.getOrientation(i),a=[];return r[0]!=s[0]||r[1]==s[1]?(0==s[0]?a.push(e[0]<n[0]?t[0]+10:t[0]-10):a.push(t[0]+l*s[0]),0==s[1]?a.push(e[1]<n[1]?t[1]+10:t[1]-10):a.push(t[1]+l*r[1])):(0==r[0]?a.push(n[0]<e[0]?t[0]+10:t[0]-10):a.push(t[0]-l*r[0]),0==r[1]?a.push(n[1]<e[1]?t[1]+10:t[1]-10):a.push(t[1]+l*s[1])),a},this._compute=function(t,n){var e=n.sourcePos,o=n.targetPos,i=Math.abs(e[0]-o[0]),r=Math.abs(e[1]-o[1]),s=e[0]<o[0]?i:0,a=e[1]<o[1]?r:0,l=e[0]<o[0]?0:i,u=e[1]<o[1]?0:r,c=p._findControlPoint([s,a],e,o,n.sourceEndpoint,n.targetEndpoint),d=p._findControlPoint([l,u],o,e,n.targetEndpoint,n.sourceEndpoint);h.addSegment("Bezier",{x1:s,y1:a,x2:l,y2:u,cp1x:c[0],cp1y:c[1],cp2x:d[0],cp2y:d[1]})}},jsPlumb.Endpoints.AbstractEndpoint=function(t){p.apply(this,arguments);var r=this;return this.compute=function(t,n,e,o){var i=r._compute.apply(r,arguments);return r.x=i[0],r.y=i[1],r.w=i[2],r.h=i[3],r.bounds.minX=r.x,r.bounds.minY=r.y,r.bounds.maxX=r.x+r.w,r.bounds.maxY=r.y+r.h,i},{compute:r.compute,cssClass:t.cssClass}},jsPlumb.Endpoints.Dot=function(t){this.type="Dot";var u=this;jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{},this.radius=t.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(t,n,e,o){u.radius=e.radius||u.radius;var i,r=t[0]-u.radius,s=t[1]-u.radius,a=2*u.radius,l=2*u.radius;return e.strokeStyle&&(r-=i=e.lineWidth||1,s-=i,a+=2*i,l+=2*i),[r,s,a,l,u.radius]}},jsPlumb.Endpoints.Rectangle=function(t){this.type="Rectangle";var s=this;jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{},this.width=t.width||20,this.height=t.height||20,this._compute=function(t,n,e,o){var i=e.width||s.width,r=e.height||s.height;return[t[0]-i/2,t[1]-r/2,i,r]}};function u(t){jsPlumb.DOMElementComponent.apply(this,arguments);var n=[];this.getDisplayElements=function(){return n},this.appendDisplayElement=function(t){n.push(t)}}jsPlumb.Endpoints.Image=function(t){this.type="Image",u.apply(this,arguments);var i=this,r=(jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments),!1),s=!1,a=t.width,l=t.height,e=null,n=t.endpoint;this.img=new Image,i.ready=!1,this.img.onload=function(){i.ready=!0,a=a||i.img.width,l=l||i.img.height,e&&e(i)},n.setImage=function(t,n){t.constructor==String||t.src;e=n,i.img.src=t,null!=i.canvas&&i.canvas.setAttribute("src",t)},n.setImage(t.src||t.url,t.onload),this._compute=function(t,n,e,o){return i.anchorPoint=t,i.ready?[t[0]-a/2,t[1]-l/2,a,l]:[0,0,0,0]},i.canvas=document.createElement("img"),r=!1,i.canvas.style.margin=0,i.canvas.style.padding=0,i.canvas.style.outline=0,i.canvas.style.position="absolute";var o=t.cssClass?" "+t.cssClass:"";i.canvas.className=jsPlumb.endpointClass+o,a&&i.canvas.setAttribute("width",a),l&&i.canvas.setAttribute("height",l),jsPlumb.appendElement(i.canvas,t.parent),i.attachListeners(i.canvas,i),i.cleanup=function(){s=!0};this.paint=function(t,n){var e,o;i.ready?s||(r||(i.canvas.setAttribute("src",i.img.src),i.appendDisplayElement(i.canvas),r=!0),e=i.anchorPoint[0]-a/2,o=i.anchorPoint[1]-l/2,jsPlumb.sizeCanvas(i.canvas,e,o,a,l)):window.setTimeout(function(){i.paint(t,n)},200)}},jsPlumb.Endpoints.Blank=function(t){var e=this;jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);this.type="Blank",u.apply(this,arguments),this._compute=function(t,n,e,o){return[t[0],t[1],10,0]},e.canvas=document.createElement("div"),e.canvas.style.display="block",e.canvas.style.width="1px",e.canvas.style.height="1px",e.canvas.style.background="transparent",e.canvas.style.position="absolute",e.canvas.className=e._jsPlumb.endpointClass,jsPlumb.appendElement(e.canvas,t.parent),this.paint=function(t,n){jsPlumb.sizeCanvas(e.canvas,e.x,e.y,e.w,e.h)}},jsPlumb.Endpoints.Triangle=function(t){this.type="Triangle";var s=this;jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);(t=t||{}).width=t.width||55,t.height=t.height||55,this.width=t.width,this.height=t.height,this._compute=function(t,n,e,o){var i=e.width||s.width,r=e.height||s.height;return[t[0]-i/2,t[1]-r/2,i,r]}};var l=jsPlumb.Overlays.AbstractOverlay=function(t){var n=!0,e=this;this.isAppendedAtTopLevel=!0,this.component=t.component,this.loc=null==t.location?.5:t.location,this.endpointLoc=null==t.endpointLocation?[.5,.5]:t.endpointLocation,this.setVisible=function(t){n=t,e.component.repaint()},this.isVisible=function(){return n},this.hide=function(){e.setVisible(!1)},this.show=function(){e.setVisible(!0)},this.incrementLocation=function(t){e.loc+=t,e.component.repaint()},this.setLocation=function(t){e.loc=t,e.component.repaint()},this.getLocation=function(){return e.loc}};jsPlumb.Overlays.Arrow=function(t){this.type="Arrow",l.apply(this,arguments),this.isAppendedAtTopLevel=!1,t=t||{};var d=this,p=jsPlumbUtil;this.length=t.length||20,this.width=t.width||20,this.id=t.id;var h=(t.direction||1)<0?-1:1,f=t.paintStyle||{lineWidth:1},m=t.foldback||.623;this.computeMaxSize=function(){return 1.5*d.width},this.cleanup=function(){},this.draw=function(t,n){var e,o,i,r,s,a;if(t.pointAlongPathFrom){p.isString(d.loc)||1<d.loc||d.loc<0?(o=parseInt(d.loc),i=t.pointAlongPathFrom(o,h*d.length/2,!0),r=t.pointOnPath(o,!0),s=p.pointOnLine(i,r,d.length)):1==d.loc?(i=t.pointOnPath(d.loc),r=t.pointAlongPathFrom(d.loc,-1),s=p.pointOnLine(i,r,d.length),-1==h&&(a=s,s=i,i=a)):0==d.loc?(s=t.pointOnPath(d.loc),r=t.pointAlongPathFrom(d.loc,1),i=p.pointOnLine(s,r,d.length),-1==h&&(a=s,s=i,i=a)):(i=t.pointAlongPathFrom(d.loc,h*d.length/2),r=t.pointOnPath(d.loc),s=p.pointOnLine(i,r,d.length));var l={hxy:i,tail:e=p.perpendicularLineTo(i,s,d.width),cxy:p.pointOnLine(i,s,m*d.length)},u=f.strokeStyle||n.strokeStyle,c=f.fillStyle||n.strokeStyle;return{component:t,d:l,lineWidth:f.lineWidth||n.lineWidth,strokeStyle:u,fillStyle:c,minX:Math.min(i.x,e[0].x,e[1].x),maxX:Math.max(i.x,e[0].x,e[1].x),minY:Math.min(i.y,e[0].y,e[1].y),maxY:Math.max(i.y,e[0].y,e[1].y)}}return{component:t,minX:0,maxX:0,minY:0,maxY:0}}},jsPlumb.Overlays.PlainArrow=function(t){t=t||{};var n=jsPlumb.extend(t,{foldback:1});jsPlumb.Overlays.Arrow.call(this,n),this.type="PlainArrow"},jsPlumb.Overlays.Diamond=function(t){var n=(t=t||{}).length||40,e=jsPlumb.extend(t,{length:n/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,e),this.type="Diamond"};function n(n){jsPlumb.DOMElementComponent.apply(this,arguments),l.apply(this,arguments);var e,u=this,o=!1,i=jsPlumb.CurrentLibrary;function c(t){return null==r&&(r=u.getDimensions()),r}n=n||{},this.id=n.id,this.getElement=function(){return null==e&&function(){e=n.create(n.component),(e=i.getDOMElement(e)).style.position="absolute";var t=n._jsPlumb.overlayClass+" "+(u.cssClass?u.cssClass:n.cssClass?n.cssClass:"");e.className=t,n._jsPlumb.appendElement(e,n.component.parent),n._jsPlumb.getId(e),u.attachListeners(e,u),u.canvas=e}(),e},this.getDimensions=function(){return i.getSize(i.getElementObject(u.getElement()))};var r=null;this.clearCachedDimensions=function(){r=null},this.computeMaxSize=function(){var t=c();return Math.max(t[0],t[1])};var s=u.setVisible;u.setVisible=function(t){s(t),e.style.display=t?"block":"none"},this.cleanup=function(){null!=e&&i.removeElement(e)},this.paint=function(t,n){o||(u.getElement(),t.component.appendDisplayElement(e),u.attachListeners(e,t.component),o=!0),e.style.left=t.component.x+t.d.minx+"px",e.style.top=t.component.y+t.d.miny+"px"},this.draw=function(t,n){var e=c();if(null==e||2!=e.length)return{minX:0,maxX:0,minY:0,maxY:0};var o,i,r,s={x:0,y:0},a=(s=t.pointOnPath?(o=u.loc,i=!1,(jsPlumbUtil.isString(u.loc)||u.loc<0||1<u.loc)&&(o=parseInt(u.loc),i=!0),t.pointOnPath(o,i)):{x:(r=u.loc.constructor==Array?u.loc:u.endpointLoc)[0]*t.w,y:r[1]*t.h}).x-e[0]/2,l=s.y-e[1]/2;return{component:t,d:{minx:a,miny:l,td:e,cxy:s},minX:a,maxX:a+e[0],minY:l,maxY:l+e[1]}},this.reattachListeners=function(t){e&&u.reattachListenersForElement(e,u,t)}}jsPlumb.Overlays.Custom=function(t){this.type="Custom",n.apply(this,arguments)},jsPlumb.Overlays.GuideLines=function(){var a=this;a.length=50,a.lineWidth=5,this.type="GuideLines",l.apply(this,arguments),jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.draw=function(t,n){var e=t.pointAlongPathFrom(a.loc,a.length/2),o=t.pointOnPath(a.loc),i=jsPlumbUtil.pointOnLine(e,o,a.length),r=jsPlumbUtil.perpendicularLineTo(e,i,40),s=jsPlumbUtil.perpendicularLineTo(i,e,20);return{connector:t,head:e,tail:i,headLine:s,tailLine:r,minX:Math.min(e.x,i.x,s[0].x,s[1].x),minY:Math.min(e.y,i.y,s[0].y,s[1].y),maxX:Math.max(e.x,i.x,s[0].x,s[1].x),maxY:Math.max(e.y,i.y,s[0].y,s[1].y)}},this.cleanup=function(){}},jsPlumb.Overlays.Label=function(t){this.labelStyle=t.labelStyle||jsPlumb.Defaults.LabelStyle,this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null,t.create=function(){return document.createElement("div")},jsPlumb.Overlays.Custom.apply(this,arguments),this.type="Label";var n=t.label||"",e=this,o=null;this.setLabel=function(t){n=t,o=null,e.clearCachedDimensions(),i(),e.component.repaint()};var i=function(){var t;"function"==typeof n?(t=n(e),e.getElement().innerHTML=t.replace(/\r\n/g,"<br/>")):null==o&&(o=n,e.getElement().innerHTML=o.replace(/\r\n/g,"<br/>"))};this.getLabel=function(){return n};var r=this.getDimensions;this.getDimensions=function(){return i(),r()}}}(),jsPlumb.Connectors.StateMachine=function(t){t=t||{},this.type="StateMachine";var M=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),_=t.curviness||10,k=t.margin||5,T=t.proximityLimit||80,U=t.orientation&&"clockwise"===t.orientation,F=t.loopbackRadius||25,X=!1!==t.showLoopback;this._compute=function(t,n){var e,o,i,r,s,a,l,u,c,d,p,h,f,m,g,v,y,b,P,C,x,j,E,S,D,A,I=Math.abs(n.sourcePos[0]-n.targetPos[0]),w=Math.abs(n.sourcePos[1]-n.targetPos[1]),O=Math.min(n.sourcePos[0],n.targetPos[0]),L=Math.min(n.sourcePos[1],n.targetPos[1]);X&&n.sourceEndpoint.elementId===n.targetEndpoint.elementId?(e=n.sourcePos[0],n.sourcePos[0],o=n.sourcePos[1]-k,n.sourcePos[1],w=I=2*F,O=(i=e)-F,L=(r=o-F)-F,t.points[0]=O,t.points[1]=L,t.points[2]=I,t.points[3]=w,M.addSegment("Arc",{x1:e-O+4,y1:o-L,startAngle:0,endAngle:2*Math.PI,r:F,ac:!U,x2:e-O-4,y2:o-L,cx:i-O,cy:r-L})):(s=n.sourcePos[0]<n.targetPos[0]?0:I,a=n.sourcePos[1]<n.targetPos[1]?0:w,l=n.sourcePos[0]<n.targetPos[0]?I:0,u=n.sourcePos[1]<n.targetPos[1]?w:0,0===n.sourcePos[2]&&(s-=k),1===n.sourcePos[2]&&(s+=k),0===n.sourcePos[3]&&(a-=k),1===n.sourcePos[3]&&(a+=k),0===n.targetPos[2]&&(l-=k),1===n.targetPos[2]&&(l+=k),0===n.targetPos[3]&&(u-=k),1===n.targetPos[3]&&(u+=k),p=-1*(c=(s+l)/2)/(d=(a+u)/2),h=Math.atan(p),p==1/0||p==-1/0||Math.abs(_/2*Math.sin(h)),p==1/0||p==-1/0||Math.abs(_/2*Math.cos(h)),S=a,A=u,f=(E=s)<=(D=l)&&A<=S?1:E<=D&&S<=A?2:D<=E&&S<=A?3:4,m=Math.sqrt(Math.pow(l-s,2)+Math.pow(u-a,2)),v=c,y=d,b=f,P=n.sourcePos,C=n.targetPos,j=x=_,g=m<=T?[v,y]:1===b?P[3]<=0&&1<=C[3]?[v+(P[2]<.5?-1*x:x),y]:1<=P[2]&&C[2]<=0?[v,y+(P[3]<.5?-1*j:j)]:[v+-1*x,y+-1*j]:2===b?1<=P[3]&&C[3]<=0?[v+(P[2]<.5?-1*x:x),y]:1<=P[2]&&C[2]<=0?[v,y+(P[3]<.5?-1*j:j)]:[v+ +x,y+-1*j]:3===b?1<=P[3]&&C[3]<=0?[v+(P[2]<.5?-1*x:x),y]:P[2]<=0&&1<=C[2]?[v,y+(P[3]<.5?-1*j:j)]:[v+-1*x,y+-1*j]:4===b?P[3]<=0&&1<=C[3]?[v+(P[2]<.5?-1*x:x),y]:P[2]<=0&&1<=C[2]?[v,y+(P[3]<.5?-1*j:j)]:[v+ +x,y+-1*j]:void 0,M.addSegment("Bezier",{x1:l,y1:u,x2:s,y2:a,cp1x:g[0],cp1y:g[1],cp2x:g[0],cp2y:g[1]}))}},function(){jsPlumb.Connectors.Flowchart=function(params){this.type="Flowchart",params=params||{},params.stub=params.stub||30;var self=this,_super=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),midpoint=params.midpoint||.5,points=[],segments=[],grid=params.grid,userSuppliedSegments=null,lastx=null,lasty=null,lastOrientation,cornerRadius=null!=params.cornerRadius?params.cornerRadius:10,sgn=function(t){return t<0?-1:0==t?0:1},addSegment=function(t,n,e,o,i){var r,s,a,l,u;o==lastx&&i==lasty||n==lastx&&e==lasty||(s=null==lasty?i:lasty,a=(r=null==lastx?o:lastx)==n?"v":"h",l=sgn(n-r),u=sgn(e-s),lastx=n,lasty=e,t.push([r,s,n,e,a,l,u]))},segLength=function(t){return Math.sqrt(Math.pow(t[0]-t[2],2)+Math.pow(t[1]-t[3],2))},_cloneArray=function(t){var n=[];return n.push.apply(n,t),n},updateMinMax=function(t){self.bounds.minX=Math.min(self.bounds.minX,t[2]),self.bounds.maxX=Math.max(self.bounds.maxX,t[2]),self.bounds.minY=Math.min(self.bounds.minY,t[3]),self.bounds.maxY=Math.max(self.bounds.maxY,t[3])},writeSegments=function(t,n){for(var e=0;e<t.length-1;e++){var o,i,r,s,a,l=l||_cloneArray(t[e]),u=_cloneArray(t[e+1]);0<cornerRadius&&l[4]!=u[4]?(o=Math.min(cornerRadius,segLength(l),segLength(u)),l[2]-=l[5]*o,l[3]-=l[6]*o,u[0]+=u[5]*o,u[1]+=u[6]*o,i=l[6]==u[5]&&1==u[5]||l[6]==u[5]&&0==u[5]&&l[5]!=u[6]||l[6]==u[5]&&-1==u[5],s=(r=(u[1]>l[3]?1:-1)==(u[0]>l[2]?1:-1))&&i||!r&&!i?u[0]:l[2],a=r&&i||!r&&!i?l[3]:u[1],_super.addSegment("Straight",{x1:l[0],y1:l[1],x2:l[2],y2:l[3]}),_super.addSegment("Arc",{r:o,x1:l[2],y1:l[3],x2:u[0],y2:u[1],cx:s,cy:a,ac:i})):_super.addSegment("Straight",{x1:l[0],y1:l[1],x2:l[2],y2:l[3]}),l=u}_super.addSegment("Straight",{x1:u[0],y1:u[1],x2:u[2],y2:u[3]})};this.setSegments=function(t){userSuppliedSegments=t},this.isEditable=function(){return!0},this.getOriginalSegments=function(){return userSuppliedSegments||segments},this._compute=function(paintInfo,params){if(params.clearEdits&&(userSuppliedSegments=null),null==userSuppliedSegments){segments=[],lastx=null,lasty=null,lastOrientation=null;var midx=paintInfo.startStubX+(paintInfo.endStubX-paintInfo.startStubX)*midpoint,midy=paintInfo.startStubY+(paintInfo.endStubY-paintInfo.startStubY)*midpoint;addSegment(segments,paintInfo.startStubX,paintInfo.startStubY,paintInfo.sx,paintInfo.sy);var findClearedLine=function(t,n,e,o){return t+(n*((1-e)*o)+_super.maxStub)},orientations={x:[0,1],y:[1,0]},lineCalculators={perpendicular:function(axis){with(paintInfo){var sis={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},stubs={x:[[startStubX,endStubX],null,[endStubX,startStubX]],y:[[startStubY,endStubY],null,[endStubY,startStubY]]},midLines={x:[[midx,startStubY],[midx,endStubY]],y:[[startStubX,midy],[endStubX,midy]]},linesToEnd={x:[[endStubX,startStubY]],y:[[startStubX,endStubY]]},startToEnd={x:[[startStubX,endStubY],[endStubX,endStubY]],y:[[endStubX,startStubY],[endStubX,endStubY]]},startToMidToEnd={x:[[startStubX,midy],[endStubX,midy],[endStubX,endStubY]],y:[[midx,startStubY],[midx,endStubY],[endStubX,endStubY]]},otherStubs={x:[startStubY,endStubY],y:[startStubX,endStubX]},soIdx=orientations[axis][0],toIdx=orientations[axis][1],_so=so[soIdx]+1,_to=to[toIdx]+1,otherFlipped=-1==to[toIdx]&&otherStubs[axis][1]<otherStubs[axis][0]||1==to[toIdx]&&otherStubs[axis][1]>otherStubs[axis][0],stub1=stubs[axis][_so][0],stub2=stubs[axis][_so][1],segmentIndexes=sis[axis][_so][_to];if(segment==segmentIndexes[3]||segment==segmentIndexes[2]&&otherFlipped)return midLines[axis];if(segment==segmentIndexes[2]&&stub2<stub1)return linesToEnd[axis];if(segment==segmentIndexes[2]&&stub1<=stub2||segment==segmentIndexes[1]&&!otherFlipped)return startToMidToEnd[axis];if(segment==segmentIndexes[0]||segment==segmentIndexes[1]&&otherFlipped)return startToEnd[axis]}},orthogonal:function(t){var n=paintInfo,e={x:-1==n.so[0]?Math.min(n.startStubX,n.endStubX):Math.max(n.startStubX,n.endStubX),y:-1==n.so[1]?Math.min(n.startStubY,n.endStubY):Math.max(n.startStubY,n.endStubY)}[t];return{x:[[e,n.startStubY],[e,n.endStubY],[n.endStubX,n.endStubY]],y:[[n.startStubX,e],[n.endStubX,e],[n.endStubX,n.endStubY]]}[t]},opposite:function(t){var n=paintInfo,e={x:"y",y:"x"}[t],o="Stub"+t.toUpperCase(),i="Stub"+e.toUpperCase(),r=n["start"+i],s=n["start"+o],a=(n["end"+i],n["end"+o]),l={x:"height",y:"width"}[t],u=n["is"+t.toUpperCase()+"GreaterThanStubTimes2"],c="x"==t?0:1;if(params.sourceEndpoint.elementId!=params.targetEndpoint.elementId)return!u||1==n.so[c]&&a<s||-1==n.so[c]&&s<a?{x:[[s,midy],[a,midy]],y:[[midx,s],[midx,a]]}[t]:1==n.so[c]&&s<a||-1==n.so[c]&&a<s?{x:[[midx,n.sy],[midx,n.ty]],y:[[n.sx,midy],[n.tx,midy]]}[t]:void 0;var d=r+(1-params.sourceAnchor[e])*params.sourceInfo[l]+_super.maxStub;return{x:[[s,d],[a,d]],y:[[d,s],[d,a]]}[t]}},p=lineCalculators[paintInfo.anchorOrientation](paintInfo.sourceAxis);if(p)for(var i=0;i<p.length;i++)addSegment(segments,p[i][0],p[i][1]);addSegment(segments,paintInfo.endStubX,paintInfo.endStubY),addSegment(segments,paintInfo.tx,paintInfo.ty),writeSegments(segments,paintInfo)}else writeSegments(userSuppliedSegments,paintInfo)},this.getPath=function(){for(var t=null,n=null,e=[],o=userSuppliedSegments||segments,i=0;i<o.length;i++){var r=o[i],s=r[4],a="v"==s?3:2;null!=t&&n===s?t[a]=r[a]:r[0]==r[2]&&r[1]==r[3]||(e.push({start:[r[0],r[1]],end:[r[2],r[3]]}),n=(t=r)[4])}return e},this.setPath=function(t){userSuppliedSegments=[];for(var n=0;n<t.length;n++){var e=t[n].start[0],o=t[n].start[1],i=t[n].end[0],r=t[n].end[1],s=e==i?"v":"h",a=sgn(i-e),l=sgn(r-o);userSuppliedSegments.push([e,o,i,r,s,a,l])}}}}(),function(){var p={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},t=null;if(document.createStyleSheet&&document.namespaces){for(var n=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"],t=document.createStyleSheet(),e=0;e<n.length;e++)t.addRule(n[e],"behavior:url(#default#VML);position:absolute;");document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}jsPlumb.vml={};function m(t,n){for(var e in n)t[e]=n[e]}function d(t,n,e,o){"transparent"===n?o.setOpacity(e,"0.0"):o.setOpacity(e,"1.0")}function h(t,n,e,o){var i,r,s={};if(n.strokeStyle?(s.stroked="true",i=jsPlumbUtil.convertStyle(n.strokeStyle,!0),s.strokecolor=i,d(0,i,"stroke",e),s.strokeweight=n.lineWidth+"px"):s.stroked="false",n.fillStyle?(s.filled="true",r=jsPlumbUtil.convertStyle(n.fillStyle,!0),s.fillcolor=r,d(0,r,"fill",e)):s.filled="false",n.dashstyle)null==e.strokeNode?e.strokeNode=v("stroke",[0,0,0,0],{dashstyle:n.dashstyle},t,o):e.strokeNode.dashstyle=n.dashstyle;else if(n["stroke-dasharray"]&&n.lineWidth){for(var a=-1==n["stroke-dasharray"].indexOf(",")?" ":",",l=n["stroke-dasharray"].split(a),u="",c=0;c<l.length;c++)u+=Math.floor(l[c]/n.lineWidth)+a;null==e.strokeNode?e.strokeNode=v("stroke",[0,0,0,0],{dashstyle:u},t,o):e.strokeNode.dashstyle=u}m(t,s)}function s(){var o=this;jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.opacityNodes={stroke:null,fill:null},this.initOpacityNodes=function(t){o.opacityNodes.stroke=v("stroke",[0,0,1,1],{opacity:"0.0"},t,o._jsPlumb),o.opacityNodes.fill=v("fill",[0,0,1,1],{opacity:"0.0"},t,o._jsPlumb)},this.setOpacity=function(t,n){var e=o.opacityNodes[t];e&&(e.opacity=""+n)};var e=[];this.getDisplayElements=function(){return e},this.appendDisplayElement=function(t,n){n||o.canvas.parentNode.appendChild(t),e.push(t)}}var g=1e3,v=function(t,n,e,o,i,r){e=e||{};var s=document.createElement("jsplumb:"+t);return r?i.appendElement(s,o):jsPlumb.CurrentLibrary.appendElement(s,o),s.className=(e.class?e.class+" ":"")+"jsplumb_vml",y(s,n),m(s,e),s},y=function(t,n,e){t.style.left=n[0]+"px",t.style.top=n[1]+"px",t.style.width=n[2]+"px",t.style.height=n[3]+"px",t.style.position="absolute",e&&(t.style.zIndex=e)},b=jsPlumb.vml.convertValue=function(t){return Math.floor(t*g)},o=(jsPlumb.ConnectorRenderers.vml=function(u){var c=this;c.strokeNode=null,c.canvas=null;s.apply(this,arguments);var d=c._jsPlumb.connectorClass+(u.cssClass?" "+u.cssClass:"");this.paint=function(t){if(null!==t){for(var n=c.getSegments(),e={path:""},o=[c.x,c.y,c.w,c.h],i=0;i<n.length;i++)e.path+=jsPlumb.Segments.vml.SegmentRenderer.getPath(n[i]),e.path+=" ";if(t.outlineColor){var r=t.outlineWidth||1,s=t.lineWidth+2*r,a={strokeStyle:jsPlumbUtil.convertStyle(t.outlineColor),lineWidth:s};for(var l in p)a[l]=t[l];null==c.bgCanvas?(e.class=d,e.coordsize=o[2]*g+","+o[3]*g,c.bgCanvas=v("shape",o,e,u.parent,c._jsPlumb,!0),y(c.bgCanvas,o),c.appendDisplayElement(c.bgCanvas,!0),c.attachListeners(c.bgCanvas,c),c.initOpacityNodes(c.bgCanvas,["stroke"])):(e.coordsize=o[2]*g+","+o[3]*g,y(c.bgCanvas,o),m(c.bgCanvas,e)),h(c.bgCanvas,a,c)}null==c.canvas?(e.class=d,e.coordsize=o[2]*g+","+o[3]*g,c.canvas=v("shape",o,e,u.parent,c._jsPlumb,!0),c.appendDisplayElement(c.canvas,!0),c.attachListeners(c.canvas,c),c.initOpacityNodes(c.canvas,["stroke"])):(e.coordsize=o[2]*g+","+o[3]*g,y(c.canvas,o),m(c.canvas,e)),h(c.canvas,t,c,c._jsPlumb)}},this.reattachListeners=function(){c.canvas&&c.reattachListenersForElement(c.canvas,c)}},window.VmlEndpoint=function(t){s.apply(this,arguments);var o=null,i=this;i.canvas=document.createElement("div"),i.canvas.style.position="absolute";var r=i._jsPlumb.endpointClass+(t.cssClass?" "+t.cssClass:"");t._jsPlumb.appendElement(i.canvas,t.parent),this.paint=function(t,n){var e={};jsPlumb.sizeCanvas(i.canvas,i.x,i.y,i.w,i.h),null==o?(e.class=r,o=i.getVml([0,0,i.w,i.h],e,n,i.canvas,i._jsPlumb),i.attachListeners(o,i),i.appendDisplayElement(o,!0),i.appendDisplayElement(i.canvas,!0),i.initOpacityNodes(o,["fill"])):(y(o,[0,0,i.w,i.h]),m(o,e)),h(o,t,i)},this.reattachListeners=function(){o&&i.reattachListenersForElement(o,i)}});jsPlumb.Segments.vml={SegmentRenderer:{getPath:function(t){return{Straight:function(t){var n=t.params;return"m"+b(n.x1)+","+b(n.y1)+" l"+b(n.x2)+","+b(n.y2)+" e"},Bezier:function(t){var n=t.params;return"m"+b(n.x1)+","+b(n.y1)+" c"+b(n.cp1x)+","+b(n.cp1y)+","+b(n.cp2x)+","+b(n.cp2y)+","+b(n.x2)+","+b(n.y2)+" e"},Arc:function(t){var n,e=t.params,o=Math.min(e.x1,e.x2),i=(Math.max(e.x1,e.x2),Math.min(e.y1,e.y2)),r=(Math.max(e.y1,e.y2),t.anticlockwise?1:0);return(t.anticlockwise?"at ":"wa ")+(n=[null,[function(){return[o,i]},function(){return[o-e.r,i-e.r]}],[function(){return[o-e.r,i]},function(){return[o,i-e.r]}],[function(){return[o-e.r,i-e.r]},function(){return[o,i]}],[function(){return[o,i-e.r]},function(){return[o-e.r,i]}]][t.segment][r](),b(n[0])+","+b(n[1])+","+b(n[0]+2*e.r)+","+b(n[1]+2*e.r))+","+b(e.x1)+","+b(e.y1)+","+b(e.x2)+","+b(e.y2)+" e"}}[t.type](t)}}},jsPlumb.Endpoints.vml.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),o.apply(this,arguments),this.getVml=function(t,n,e,o,i){return v("oval",t,n,o,i)}},jsPlumb.Endpoints.vml.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),o.apply(this,arguments),this.getVml=function(t,n,e,o,i){return v("rect",t,n,o,i)}},jsPlumb.Endpoints.vml.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.vml.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.vml.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.vml.Custom=jsPlumb.Overlays.Custom;function i(t,h){t.apply(this,h),s.apply(this,h);var f=this;f.canvas=null,f.isAppendedAtTopLevel=!0,this.paint=function(t,n){var e={},o=t.d,i=t.component;t.strokeStyle&&(e.stroked="true",e.strokecolor=jsPlumbUtil.convertStyle(t.strokeStyle,!0)),t.lineWidth&&(e.strokeweight=t.lineWidth+"px"),t.fillStyle&&(e.filled="true",e.fillcolor=t.fillStyle);var r,s,a,l=Math.min(o.hxy.x,o.tail[0].x,o.tail[1].x,o.cxy.x),u=Math.min(o.hxy.y,o.tail[0].y,o.tail[1].y,o.cxy.y),c=Math.max(o.hxy.x,o.tail[0].x,o.tail[1].x,o.cxy.x),d=Math.max(o.hxy.y,o.tail[0].y,o.tail[1].y,o.cxy.y),p=[l,u,Math.abs(c-l),Math.abs(d-u)];e.path="m "+b((r=o).hxy.x)+","+b(r.hxy.y)+" l "+b(r.tail[0].x)+","+b(r.tail[0].y)+" "+b(r.cxy.x)+","+b(r.cxy.y)+" "+b(r.tail[1].x)+","+b(r.tail[1].y)+" x e",e.coordsize=i.w*g+","+i.h*g,p[0]=i.x,p[1]=i.y,p[2]=i.w,p[3]=i.h,null==f.canvas?(s=i._jsPlumb.overlayClass||"",a=h&&1==h.length&&h[0].cssClass||"",e.class=a+" "+s,f.canvas=v("shape",p,e,i.canvas.parentNode,i._jsPlumb,!0),i.appendDisplayElement(f.canvas,!0),f.attachListeners(f.canvas,i),f.attachListeners(f.canvas,f)):(y(f.canvas,p),m(f.canvas,e))},this.reattachListeners=function(){f.canvas&&f.reattachListenersForElement(f.canvas,f)},this.cleanup=function(){null!=f.canvas&&jsPlumb.CurrentLibrary.removeElement(f.canvas)}}jsPlumb.Overlays.vml.Arrow=function(){i.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumb.Overlays.vml.PlainArrow=function(){i.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumb.Overlays.vml.Diamond=function(){i.apply(this,[jsPlumb.Overlays.Diamond,arguments])}}(),function(){function h(t,n){for(var e in n)t.setAttribute(e,""+n[e])}function f(t,n){var e=document.createElementNS(o,t);return(n=n||{}).version="1.1",n.xmlns=i,h(e,n),e}function u(t){return"position:absolute;left:"+t[0]+"px;top:"+t[1]+"px"}function d(t){for(var n=0;n<t.childNodes.length;n++)t.childNodes[n].tagName!=y&&t.childNodes[n].tagName!=b||t.removeChild(t.childNodes[n])}function m(t,n,e,o,i){var r,s,a;for(var l in e.gradient?function(t,n,e,o){var i,r="jsplumb_gradient_"+o._jsPlumb.idstamp();d(t),i=e.gradient.offset?f(b,{id:r}):f(y,{id:r,gradientUnits:"userSpaceOnUse"}),t.appendChild(i);for(var s=0;s<e.gradient.stops.length;s++){var a=1==o.segment||2==o.segment?s:e.gradient.stops.length-1-s,l=jsPlumbUtil.convertStyle(e.gradient.stops[a][1],!0),u=f("stop",{offset:Math.floor(100*e.gradient.stops[s][0])+"%","stop-color":l});i.appendChild(u)}var c=e.strokeStyle?"stroke":"fill";n.setAttribute("style",c+":url(#"+r+")")}(t,n,e,i):(d(t),n.setAttribute("style","")),n.setAttribute("fill",e.fillStyle?jsPlumbUtil.convertStyle(e.fillStyle,!0):"none"),n.setAttribute("stroke",e.strokeStyle?jsPlumbUtil.convertStyle(e.strokeStyle,!0):"none"),e.lineWidth&&n.setAttribute("stroke-width",e.lineWidth),e[v]&&e.lineWidth&&!e[p]?(r=-1==e[v].indexOf(",")?" ":",",s=e[v].split(r),a="",s.forEach(function(t){a+=Math.floor(t*e.lineWidth)+r}),n.setAttribute(p,a)):e[p]&&n.setAttribute(p,e[p]),c)e[l]&&n.setAttribute(c[l],e[l])}function e(t,n,e){for(var o,i=e.split(" "),r=t.className.baseVal.split(" "),s=0;s<i.length;s++){n?-1==r.indexOf(i[s])&&r.push(i[s]):-1!=(o=r.indexOf(i[s]))&&r.splice(o,1)}t.className.baseVal=r.join(" ")}function g(t,n,e){t.childNodes.length>e?t.insertBefore(n,t.childNodes[e]):t.appendChild(n)}var c={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},p="stroke-dasharray",v="dashstyle",y="linearGradient",b="radialGradient",o="http://www.w3.org/2000/svg",i="http://www.w3.org/1999/xhtml";jsPlumbUtil.svg={addClass:function(t,n){e(t,!0,n)},removeClass:function(t,n){e(t,!1,n)},node:f,attr:h,pos:u};function n(s){var a=this,t=s.pointerEventsSpec||"all",l={};jsPlumb.jsPlumbUIComponent.apply(this,s.originalArgs),a.canvas=null,a.path=null,a.svg=null;var n=s.cssClass+" "+(s.originalArgs[0].cssClass||""),e={style:"",width:0,height:0,"pointer-events":t,position:"absolute"};a.svg=f("svg",e),s.useDivWrapper?(a.canvas=document.createElement("div"),a.canvas.style.position="absolute",jsPlumb.sizeCanvas(a.canvas,0,0,1,1),a.canvas.className=n):(h(a.svg,{class:n}),a.canvas=a.svg),s._jsPlumb.appendElement(a.canvas,s.originalArgs[0].parent),s.useDivWrapper&&a.canvas.appendChild(a.svg);var o=[a.canvas];return this.getDisplayElements=function(){return o},this.appendDisplayElement=function(t){o.push(t)},this.paint=function(t,n,e){var o,i,r;null!=t&&(o=[a.x,a.y],i=[a.w,a.h],null!=e&&(e.xmin<0&&(o[0]+=e.xmin),e.ymin<0&&(o[1]+=e.ymin),i[0]=e.xmax+(e.xmin<0?-e.xmin:0),i[1]=e.ymax+(e.ymin<0?-e.ymin:0)),r=s.useDivWrapper?(jsPlumb.sizeCanvas(a.canvas,o[0],o[1],i[0],i[1]),o[0]=0,o[1]=0,u([0,0])):u([o[0],o[1]]),l.paint.apply(this,arguments),h(a.svg,{style:r,width:i[0],height:i[1]}))},{renderer:l}}jsPlumb.ConnectorRenderers.svg=function(d){var p=this;n.apply(this,[{cssClass:d._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:d._jsPlumb}]).renderer.paint=function(t,n,e){var o=p.getSegments(),i="",r=[0,0];e.xmin<0&&(r[0]=-e.xmin),e.ymin<0&&(r[1]=-e.ymin);for(var s=0;s<o.length;s++)i+=jsPlumb.Segments.svg.SegmentRenderer.getPath(o[s]),i+=" ";var a,l,u={d:i,transform:"translate("+r[0]+","+r[1]+")","pointer-events":d["pointer-events"]||"visibleStroke"},c=null;p.x,p.y,p.w,p.h;t.outlineColor&&(a=t.outlineWidth||1,l=t.lineWidth+2*a,(c=jsPlumb.CurrentLibrary.extend({},t)).strokeStyle=jsPlumbUtil.convertStyle(t.outlineColor),c.lineWidth=l,null==p.bgPath?(p.bgPath=f("path",u),g(p.svg,p.bgPath,0),p.attachListeners(p.bgPath,p)):h(p.bgPath,u),m(p.svg,p.bgPath,c,0,p)),null==p.path?(p.path=f("path",u),g(p.svg,p.path,t.outlineColor?1:0),p.attachListeners(p.path,p)):h(p.path,u),m(p.svg,p.path,t,0,p)},this.reattachListeners=function(){p.bgPath&&p.reattachListenersForElement(p.bgPath,p),p.path&&p.reattachListenersForElement(p.path,p)}};jsPlumb.Segments.svg={SegmentRenderer:{getPath:function(o){return{Straight:function(){var t=o.getCoordinates();return"M "+t.x1+" "+t.y1+" L "+t.x2+" "+t.y2},Bezier:function(){var t=o.params;return"M "+t.x1+" "+t.y1+" C "+t.cp1x+" "+t.cp1y+" "+t.cp2x+" "+t.cp2y+" "+t.x2+" "+t.y2},Arc:function(){var t=o.params,n=o.sweep>Math.PI?1:0,e=o.anticlockwise?0:1;return"M"+o.x1+" "+o.y1+" A "+o.radius+" "+t.r+" 0 "+n+","+e+" "+o.x2+" "+o.y2}}[o.type]()}}};var t=window.SvgEndpoint=function(t){var e=this;n.apply(this,[{cssClass:t._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:t._jsPlumb}]).renderer.paint=function(t){var n=jsPlumb.extend({},t);n.outlineColor&&(n.strokeWidth=n.outlineWidth,n.strokeStyle=jsPlumbUtil.convertStyle(n.outlineColor,!0)),null==e.node?(e.node=e.makeNode(n),e.svg.appendChild(e.node),e.attachListeners(e.node,e)):null!=e.updateNode&&e.updateNode(e.node),m(e.svg,e.node,n,(e.x,e.y,e.w,e.h),e),u(e.node,(e.x,e.y))},this.reattachListeners=function(){e.node&&e.reattachListenersForElement(e.node,e)}};jsPlumb.Endpoints.svg.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),t.apply(this,arguments),this.makeNode=function(t){return f("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(t){h(t,{cx:this.w/2,cy:this.h/2,r:this.radius})}},jsPlumb.Endpoints.svg.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),t.apply(this,arguments),this.makeNode=function(t){return f("rect",{width:this.w,height:this.h})},this.updateNode=function(t){h(t,{width:this.w,height:this.h})}},jsPlumb.Endpoints.svg.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.svg.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.svg.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.svg.Custom=jsPlumb.Overlays.Custom;function r(t,i){t.apply(this,i),jsPlumb.jsPlumbUIComponent.apply(this,i),this.isAppendedAtTopLevel=!1;var r=this,s=null;this.paint=function(t,n){var e,o;t.component.svg&&n&&(null==s&&(s=f("path",{"pointer-events":"all"}),t.component.svg.appendChild(s),r.attachListeners(s,t.component),r.attachListeners(s,r)),e=i&&1==i.length&&i[0].cssClass||"",o=[0,0],n.xmin<0&&(o[0]=-n.xmin),n.ymin<0&&(o[1]=-n.ymin),h(s,{d:a(t.d),class:e,stroke:t.strokeStyle?t.strokeStyle:null,fill:t.fillStyle?t.fillStyle:null,transform:"translate("+o[0]+","+o[1]+")"}))};var a=function(t){return"M"+t.hxy.x+","+t.hxy.y+" L"+t.tail[0].x+","+t.tail[0].y+" L"+t.cxy.x+","+t.cxy.y+" L"+t.tail[1].x+","+t.tail[1].y+" L"+t.hxy.x+","+t.hxy.y};this.reattachListeners=function(){s&&r.reattachListenersForElement(s,r)},this.cleanup=function(){null!=s&&jsPlumb.CurrentLibrary.removeElement(s)}}jsPlumb.Overlays.svg.Arrow=function(){r.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumb.Overlays.svg.PlainArrow=function(){r.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumb.Overlays.svg.Diamond=function(){r.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumb.Overlays.svg.GuideLines=function(){var o,i,r=null,s=this;jsPlumb.Overlays.GuideLines.apply(this,arguments),this.paint=function(t,n){null==r&&(r=f("path"),t.connector.svg.appendChild(r),s.attachListeners(r,t.connector),s.attachListeners(r,s),o=f("path"),t.connector.svg.appendChild(o),s.attachListeners(o,t.connector),s.attachListeners(o,s),i=f("path"),t.connector.svg.appendChild(i),s.attachListeners(i,t.connector),s.attachListeners(i,s));var e=[0,0];n.xmin<0&&(e[0]=-n.xmin),n.ymin<0&&(e[1]=-n.ymin),h(r,{d:a(t.head,t.tail),stroke:"red",fill:null,transform:"translate("+e[0]+","+e[1]+")"}),h(o,{d:a(t.tailLine[0],t.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+e[0]+","+e[1]+")"}),h(i,{d:a(t.headLine[0],t.headLine[1]),stroke:"green",fill:null,transform:"translate("+e[0]+","+e[1]+")"})};var a=function(t,n){return"M "+t.x+","+t.y+" L"+n.x+","+n.y}}}(),function(e){function o(t){return e("string"==typeof t?"#"+t:t)}jsPlumb.CurrentLibrary={addClass:function(t,n){t=o(t);try{t[0].className.constructor==SVGAnimatedString&&jsPlumbUtil.svg.addClass(t[0],n)}catch(t){}try{t.addClass(n)}catch(t){}},animate:function(t,n,e){t.animate(n,e)},appendElement:function(t,n){o(n).append(t)},ajax:function(t){(t=t||{}).type=t.type||"get",e.ajax(t)},bind:function(t,n,e){(t=o(t)).bind(n,e)},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},extend:function(t,n){return e.extend(t,n)},getAttribute:function(t,n){return t.attr(n)},getClientXY:function(t){return[t.clientX,t.clientY]},getDragObject:function(t){return t[1].draggable||t[1].helper},getDragScope:function(t){return t.draggable("option","scope")},getDropEvent:function(t){return t[0]},getDropScope:function(t){return t.droppable("option","scope")},getDOMElement:function(t){return"string"==typeof t?document.getElementById(t):t.context||null!=t.length?t[0]:t},getElementObject:o,getOffset:function(t){return t.offset()},getOriginalEvent:function(t){return t.originalEvent},getPageXY:function(t){return[t.pageX,t.pageY]},getParent:function(t){return o(t).parent()},getScrollLeft:function(t){return t.scrollLeft()},getScrollTop:function(t){return t.scrollTop()},getSelector:function(t,n){return 2==arguments.length?o(t).find(n):e(t)},getSize:function(t){return[t.outerWidth(),t.outerHeight()]},getTagName:function(t){var n=o(t);return 0<n.length?n[0].tagName:null},getUIPosition:function(t,n){var e,o;return n=n||1,1==t.length?ret={left:t[0].pageX,top:t[0].pageY}:(o=(e=t[1]).offset,ret=o||e.absolutePosition,e.position.left/=n,e.position.top/=n),{left:ret.left/n,top:ret.top/n}},hasClass:function(t,n){return t.hasClass(n)},initDraggable:function(t,n,e,o){(n=n||{}).doNotRemoveHelper||(n.helper=null),e&&(n.scope=n.scope||jsPlumb.Defaults.Scope),t.draggable(n)},initDroppable:function(t,n){n.scope=n.scope||jsPlumb.Defaults.Scope,t.droppable(n)},isAlreadyDraggable:function(t){return o(t).hasClass("ui-draggable")},isDragSupported:function(t,n){return t.draggable},isDropSupported:function(t,n){return t.droppable},removeClass:function(t,n){t=o(t);try{if(t[0].className.constructor==SVGAnimatedString)return void jsPlumbUtil.svg.removeClass(t[0],n)}catch(t){}t.removeClass(n)},removeElement:function(t){o(t).remove()},setAttribute:function(t,n,e){t.attr(n,e)},setDragFilter:function(t,n){jsPlumb.CurrentLibrary.isAlreadyDraggable(t)&&t.draggable("option","cancel",n)},setDraggable:function(t,n){t.draggable("option","disabled",!n)},setDragScope:function(t,n){t.draggable("option","scope",n)},setOffset:function(t,n){o(t).offset(n)},trigger:function(t,n,e){jQuery._data(o(t)[0],"handle")(e)},unbind:function(t,n,e){(t=o(t)).unbind(n,e)}},e(document).ready(jsPlumb.init)}(jQuery),function(){void 0===Math.sgn&&(Math.sgn=function(t){return 0==t?0:0<t?1:-1});function o(t,n){for(var e=[],o=n.length-1,i=2*o-1,r=[],s=[],a=[],l=[],u=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],c=0;c<=o;c++)r[c]=p(n[c],t);for(c=0;c<=o-1;c++)s[c]=p(n[c+1],n[c]),s[c]=m(s[c],3);for(c=0;c<=o-1;c++)for(var d=0;d<=o;d++)a[c]||(a[c]=[]),a[c][d]=h(s[c],r[d]);for(c=0;c<=i;c++)l[c]||(l[c]=[]),l[c].y=0,l[c].x=parseFloat(c)/i;for(i=o-1,r=0;r<=o+i;r++)for(c=Math.max(0,r-i),s=Math.min(r,o);c<=s;c++)j=r-c,l[c+j].y+=a[j][c]*u[j][c];for(o=n.length-1,l=v(l,2*o-1,e,0),i=p(t,n[0]),a=f(i),c=u=0;c<l;c++)i=p(t,y(n,o,e[c],null,null)),(i=f(i))<a&&(a=i,u=e[c]);return i=p(t,n[o]),(i=f(i))<a&&(a=i,u=1),{location:u,distance:a}}function a(t,n){var e=t.length-1,o=d[e];if(!o){function i(o){return function(t){for(var n=1,e=0;e<o.length;e++)n*=o[e](t);return n}}var r=function(t){return function(){return t}},s=function(){return function(t){return t}},a=function(){return function(t){return 1-t}};(o=[]).push(new function(){return function(t){return Math.pow(t,e)}});for(var l=1;l<e;l++){for(var u=[new r(e)],c=0;c<e-l;c++)u.push(new s);for(c=0;c<l;c++)u.push(new a);o.push(new i(u))}o.push(new function(){return function(t){return Math.pow(1-t,e)}}),d[e]=o}for(a=s=r=0;a<t.length;a++)r+=t[a].x*o[a](n),s+=t[a].y*o[a](n);return{x:r,y:s}}function l(t,n){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function u(t){return t[0].x==t[1].x&&t[0].y==t[1].y}function i(t,n,e){if(u(t))return{point:t[0],location:n};for(var o=a(t,n),i=0,r=0<e?1:-1,s=null;i<Math.abs(e);)s=a(t,n+=.005*r),i+=l(s,o),o=s;return{point:s,location:n}}function r(t,n){var e=a(t,n),o=a(t.slice(0,t.length-1),n),i=o.y-e.y,e=o.x-e.x;return 0==i?1/0:Math.atan(i/e)}var p=function(t,n){return{x:t.x-n.x,y:t.y-n.y}},h=function(t,n){return t.x*n.x+t.y*n.y},f=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},m=function(t,n){return{x:t.x*n,y:t.y*n}},g=Math.pow(2,-65),v=function(t,n,e,o){var i=[],r=[],s=[],a=[],l=0;d=Math.sgn(t[0].y);for(var u=1;u<=n;u++)(p=Math.sgn(t[u].y))!=d&&l++,d=p;switch(l){case 0:return 0;case 1:if(64<=o)return e[0]=(t[0].x+t[n].x)/2,1;for(var c,l=t[0].y-t[n].y,d=t[n].x-t[0].x,u=t[0].x*t[n].y-t[n].x*t[0].y,p=max_distance_below=0,h=1;h<n;h++)p<(c=l*t[h].x+d*t[h].y+u)?p=c:c<max_distance_below&&(max_distance_below=c);if(p=1/(h=0*(c=d)-l)*(u-p-0*c),l=1/(h=0*(c=d)-l)*((d=u-max_distance_below)-0*c),d=Math.min(p,l),Math.max(p,l)-d<g)return s=t[n].x-t[0].x,a=t[n].y-t[0].y,e[0]=0+(s*t[0].y-a*t[0].x)*(1/(0*s-a)),1}for(y(t,n,.5,i,r),t=v(i,n,s,o+1),n=v(r,n,a,o+1),o=0;o<t;o++)e[o]=s[o];for(o=0;o<n;o++)e[o+t]=a[o];return t+n},y=function(t,n,e,o,i){for(var r=[[]],s=0;s<=n;s++)r[0][s]=t[s];for(t=1;t<=n;t++)for(s=0;s<=n-t;s++)r[t]||(r[t]=[]),r[t][s]||(r[t][s]={}),r[t][s].x=(1-e)*r[t-1][s].x+e*r[t-1][s+1].x,r[t][s].y=(1-e)*r[t-1][s].y+e*r[t-1][s+1].y;if(null!=o)for(s=0;s<=n;s++)o[s]=r[s][0];if(null!=i)for(s=0;s<=n;s++)i[s]=r[n-s][s];return r[n][0]},d={};window.jsBezier={distanceFromCurve:o,gradientAtPoint:r,gradientAtPointAlongCurveFrom:function(t,n,e){return 1<(n=i(t,n,e)).location&&(n.location=1),n.location<0&&(n.location=0),r(t,n.location)},nearestPointOnCurve:function(t,n){var e=o(t,n);return{point:y(n,n.length-1,e.location,null,null),location:e.location}},pointOnCurve:a,pointAlongCurveFrom:function(t,n,e){return i(t,n,e).point},perpendicularToCurveAt:function(t,n,e,o){return n=i(t,n,null==o?0:o),t=r(t,n.location),o=Math.atan(-1/t),t=e/2*Math.sin(o),e=e/2*Math.cos(o),[{x:n.point.x+e,y:n.point.y+t},{x:n.point.x-e,y:n.point.y-t}]},locationAlongCurveFrom:function(t,n,e){return i(t,n,e).location},getLength:function(t){if(u(t))return 0;for(var n=a(t,0),e=0,o=0,i=null;o<1;)i=a(t,o+=.005),e+=l(i,n),n=i;return e}}}();